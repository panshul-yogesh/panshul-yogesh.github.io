{
  "title": "Prepare persistent volumes for Audit service (GCP)",
  "content": "<div class=\"mw-parser-output\"><br/><br/><p class=\"mw-empty-elt\">Audit service installation in Helm mode requires the following Persistent Volumes (PVs). PVs are relevant to Elastic File System (EFS) volumes.</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Component</th>\n<th scope=\"col\">Persistent volume name</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ITOM Audit</td>\n<td><strong>as-vault-volume-&lt;Audit Namespace&gt;</strong></td>\n<td>PV for configuration</td>\n</tr>\n<tr>\n<td>ITOM Audit</td>\n<td><strong>as-log-volume-&lt;Audit Namespace&gt;</strong></td>\n<td>PV for logs</td>\n</tr>\n</tbody>\n</table>\n<p>If you want to create the required PVs from scratch, perform the following tasks:</p>\n<ol>\n<li>\n<p>Go to the audit install directory (<strong>audit-&lt;version&gt;) </strong>that you created when downloading the audit Helm chart. For example:</p>\n<pre>cd &lt;audit_install-dir&gt;/audit-2x.x</pre>\n</li>\n<li>\n<p>To find or verify the FQDN of the EFS server and the EFS directory path, run the following two commands.</p>\n</li>\n<li>\n<p>To find the name of the config volume, run the following command:</p>\n<pre>kubectl get pv | grep 'config'</pre>\n</li>\n<li>To describe the PV, run this command:\n\t<pre>kubectl describe pv &lt;pv name of config volume that you found from the previous step&gt;</pre>\n<p>Part of the output:</p>\n<pre>...\nSource:\n    Type:      NFS (an NFS mount that lasts the lifetime of a pod)\n    Server:    <!--cke_bookmark_739S-->aws-efs.example.net\n    Path:      /var/vols/itom/itsma/config-volume\n    ReadOnly:  false</pre>\n<p><br/>\n\twhere,<br/>\n<em>Server</em>: Gives you the FQDN of the EFS server<br/>\n<em>Path</em>: The path information you will need to give in the <strong>itom-audit</strong><b>-pv.yaml </b>file should start with the same path till the <strong>itom</strong> directory. This is as shown by the <em>Path</em> attribute of the config volume, for example, <strong>/var/vols/itom/itsma/config-volume</strong>.</p>\n<em> </em></li>\n<li>\n<p>Open the <strong>itom-audit</strong><b>-pv.yaml </b>file with a text editor, give the FQDN of the EFS server and the EFS directory path that you provided during the creation of the EFS volumes, and then save the file.</p>\n</li>\n<li>\n<p>Run the following command to create persistent volumes:</p>\n<pre>kubectl create -f itom-audit-pv.yaml\n</pre>\n\tOutput:\n\n\t<pre>persistentvolume/as-vault-volume-auditns created\npersistentvolume/as-log-volume-auditns created</pre>\n</li>\n<li>\n<p>Run the following command to verify the volume creation:</p>\n<pre>kubectl get pv |grep audit</pre>\n\tOutput:\n\n\t<pre>as-log-volume-auditns      5Gi     RWX      Retain     Available           itom-audit-sc     17s\nas-vault-volume-auditns    5Gi     RWX      Retain     Available           itom-audit-sc     17s</pre>\n<em> </em></li>\n</ol>\n</div>",
  "modifiedon": "2025-10-24 08:51:12"
}