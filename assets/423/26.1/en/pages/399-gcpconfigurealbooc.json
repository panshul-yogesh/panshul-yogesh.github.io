{
  "title": "Configure load balancers for OO (GKE)",
  "content": "<div class=\"mw-parser-output\">\n \n\n<h2><a id=\"Configure_external_HTTP_S_Load_Balancer_for_OO\" name=\"Configure_external_HTTP_S_Load_Balancer_for_OO\" title=\"Configure external HTTP(S) Load Balancer for OO\"></a>Configure external HTTP(S) Load Balancer for OO </h2>\n<p>You can access OO from outside the Kubernetes cluster using an HTTP(S) Load Balancer.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">The Integration Load Balancer must be internal; you can access it only from the VPC.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\"><meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\"/>\n<style type=\"text/css\">a {\n    text-decoration: none;\n    color: #464feb;\n}\ntr th, tr td {\n    border: 1px solid #e6e6e6;\n}\ntr th {\n    background-color: #f5f5f5;\n}\n\t</style>\n<div>OO must be deployed behind a dedicated external load balancer. Shared load balancer configurations with SM are not supported.</div>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">The two 'external' Load Balancers used for accessing Service Management and OO can be either internal or internet-facing, based on your preference. \n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">The term 'external' here is to emphasize that these Load Balancers are routing only the traffic that comes from outside the Kubernetes cluster.  </li></ul>\n</li></ol>\n</div></div></div>\n<h3 id=\"Public_prereq\"><a id=\"Prerequisites\" name=\"Prerequisites\" title=\"Prerequisites\"></a>Prerequisites</h3>\n<p>Before creating and configuring the Load Balancer in Google Cloud, ensure the following:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Assign an FQDN for the OO Load Balancer.\n\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">Use Cloud DNS to create an FQDN if you don’t already have one.</li><li style=\"margin-left: 40px; position: relative;\">The FQDN should be a subdomain of the Service Management FQDN.</li><li style=\"margin-left: 40px; position: relative;\">For example, if Service Management FQDN is <code>smax.example.com</code>, then the OO FQDN should be <code>oo.smax.example.com</code>.</li></ul>\n</li><li style=\"margin-left: 28px; position: relative;\">Prepare an SSL certificate for the Load Balancer.\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">You need a valid SSL/TLS certificate for Google Cloud Load Balancer.</li><li style=\"margin-left: 40px; position: relative;\">The certificate's CN (Common Name) must match the FQDN that will be assigned to the Load Balancer.</li></ul>\n</li></ul>\n<p><strong>Options for obtaining an SSL certificate</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><strong>Option 1</strong>: Use a managed SSL certificate\n\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">Google Cloud provides managed SSL certificates that automatically renew. Recommended for simpler setups.</li></ul>\n</li><li style=\"margin-left: 28px; position: relative;\"><strong>Option 2</strong>: Import a custom SSL certificate\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">If you already have a certificate, you can import it into Google Cloud Certificate Manager.</li></ul>\n</li><li style=\"margin-left: 28px; position: relative;\"><strong>Option 3</strong>: Generate a new certificate\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">Use <strong>Let's Encrypt</strong> or another CA (Certificate Authority) to generate a certificate, then import it into GCP.</li></ul>\n</li></ul>\n<h3><a id=\"Request_and_import_an_SSL_certificate_in_GCP\" name=\"Request_and_import_an_SSL_certificate_in_GCP\" title=\"Request and import an SSL certificate in GCP\"></a>Request and import an SSL certificate in GCP</h3>\n<h4><a id=\"Request_a_new_certificate\" name=\"Request_a_new_certificate\" title=\"Request a new certificate\"></a>Request a new certificate</h4>\n<p>If you want to request a new SSL certificate in Google Cloud, follow these steps:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to the Google Cloud Console.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Security</strong> &gt; <strong>Certificate Manager</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">If it’s your first time using Certificate Manager, click <strong>Get Started</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Request a New SSL Certificate</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Create Certificate.</strong></li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter a certificate name.</li><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select <strong>Managed Certificate</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter your domain name.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select <strong>DNS validation</strong> for automated renewal.</li><li style=\"--number-width: 19px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Create</strong>.</li><li style=\"--number-width: 17px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Validate the certificate based on the method you selected.\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">If you selected DNS validation, add the provided DNS records to your domain registrar.</li><li style=\"margin-left: 40px; position: relative;\">If you selected Email validation, follow the instructions sent to the domain's email.</li></ul>\n</li><li style=\"--number-width: 19px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Wait for validation. Google will verify your domain, and, once approved, the certificate status will be <strong>Active</strong>.</li></ol>\n<h4><a id=\"Import_an_existing_certificate\" name=\"Import_an_existing_certificate\" title=\"Import an existing certificate\"></a>Import an existing certificate</h4>\n<p>If you want to use a custom SSL certificate, follow these steps:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to the Google Cloud Console.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Security</strong> &gt; <strong>Certificate Manager</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click<strong> Import Your SSL Certificate</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Create Certificate</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select <strong>Self-managed Certificate</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Upload your <strong>PEM-encoded certificate file</strong>.</li><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Upload your <strong>PEM-encoded private key</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">(Optional) Upload the <strong>certificate chain</strong> if required.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Create</strong>.</li></ol>\n<h3><a id=\"Assign_the_certificate_to_a_Load_Balancer\" name=\"Assign_the_certificate_to_a_Load_Balancer\" title=\"Assign the certificate to a Load Balancer\"></a>Assign the certificate to a Load Balancer</h3>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to <strong>Network Services</strong> &gt; <strong>Load Balancing</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select your <strong>Load Balancer</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Under <strong>Frontend Configuration</strong>, add your newly created certificate.</li></ol>\n<h3 id=\"public_ingress\"><a id=\"Create_an_Ingress_for_OO\" name=\"Create_an_Ingress_for_OO\" title=\"Create an Ingress for OO\"></a>Create an Ingress for OO</h3>\n<p>You need to create an Ingress for OO with port 443:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">On the bastion node, save the content below as <code>oo-ingress.yaml</code>:</li></ol>\n<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  annotations:\n    kubernetes.io/ingress.regional-static-ip-name: \"&lt;LOAD_BALANCER_NAME&gt;\"\n    kubernetes.io/ingress.allow-http: \"false\"\n    kubernetes.io/ingress.class: gce-internal\n    kubernetes.io/ingress.internal-load-balancer: \"true\"\n    networking.gke.io/load-balancer-type: Internal\n    ingress.kubernetes.io/health-check-path: \"/oo\"\n    ingress.kubernetes.io/health-check-interval: \"30\"\n    ingress.kubernetes.io/health-check-timeout: \"10\"\n    ingress.kubernetes.io/health-check-unhealthy-threshold: \"2\"\n    ingress.kubernetes.io/health-check-healthy-threshold: \"2\"\n    ingress.kubernetes.io/app-protocols: '{\"&lt;OO_SERVICE_NAME&gt;\": \"HTTPS\"}'\n  labels:\n    app: oo-integration-ingress\n  name: oo-integration-ingress\n  namespace: &lt;OO_NAMESPACE&gt;\nspec:\n  defaultBackend:\n    service:\n      name: &lt;OO_SERVICE_NAME&gt;\n      port:\n        number: 443\n  rules:\n  - host: \"&lt;FQDN&gt;\"\n    http:\n      paths:\n      - path: \"/*\"\n        pathType: ImplementationSpecific\n        backend:\n          service:\n            name: &lt;OO_SERVICE_NAME&gt;\n            port:\n              number: 443\n  tls:\n  - secretName: \"&lt;TLS_SECRET&gt;\"</code></pre>\n<p>To configure the Ingress for OO in GCP, ensure you set the following parameters correctly:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><code>&lt;OO_NAMESPACE&gt;</code>: The Kubernetes namespace where OO is installed. For example, <code>oo</code>.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;LOAD_BALANCER_TYPE&gt;</code>: Determines whether the load balancer is <strong>internal</strong> or <strong>external</strong>:\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\"><strong>Internal</strong>: Restricts access to the private VPC network.</li><li style=\"margin-left: 40px; position: relative;\"><strong>External</strong>: Allows public access to OO with appropriate firewall rules.</li></ul>\n</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;LOAD_BALANCER_NAME&gt;</code>: A name for the load balancer, using lowercase alphanumeric characters, <code>-</code>, or <code>.</code>, starting and ending with an alphanumeric character. For example, <code>int-oo</code>.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;FQDN&gt;</code>: The fully qualified domain name (FQDN) assigned to the Load Balancer. For example, <code>oo.int.lxhelm.com</code>.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;TLS_SECRET&gt;</code>: The Kubernetes secret storing the TLS certificate for the Load Balancer. For example, <code>nginx-default-secret</code>.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;OO_SERVICE_NAME&gt;</code>: The Kubernetes service handling requests for OO. For example, <code>itom-ingress-controller-svc-internal</code>. You can obtain it by running the following command on the bastion host:</li></ul>\n<pre><code>kubectl get svc -n &lt;oo_namespace&gt; | grep -i itom-ingress | awk '{print$1}'</code></pre>\n<ol start=\"2\" style=\"padding-left: 0px;\"><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the following command to apply the saved YAML file:</li></ol>\n<pre><code>kubectl create -f oo-ingress.yaml</code></pre>\n<h3><a id=\"Bind_an_FQDN_with_OO_HTTP_S_Load_Balancer\" name=\"Bind_an_FQDN_with_OO_HTTP_S_Load_Balancer\" title=\"Bind an FQDN with OO HTTP(S) Load Balancer\"></a>Bind an FQDN with OO HTTP(S) Load Balancer</h3>\n<p>After you create and configure the Load Balancer for OO, bind the FQDN you assigned for OO with this HTTP(S) Load Balancer. </p>\n<h2><a id=\"Configure_integration_Load_Balancer\" name=\"Configure_integration_Load_Balancer\" title=\"Configure integration Load Balancer\"></a>Configure integration Load Balancer</h2>\n<p>To enable Service Management and OO Containerized to work together in GCP, configure an internal Load Balancer between the Ingress service of Service Management and the Ingress service of OO. </p>\n<h3>Prerequisites</h3>\n<p>Before creating and configuring an Integration Load Balancer, ensure the following:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"> Assign an FQDN for the integration Load Balancer. You can configure this in Google Cloud DNS.</li><li style=\"margin-left: 28px; position: relative;\"> Install the GKE Ingress Controller to manage ingress traffic in GKE.</li></ul>\n<p> Use an SSL/TLS certificate for the Load Balancer. You can either generate a Google-managed certificate or import a self-managed certificate.</p>\n<h4>Request a new certificate </h4>\n<p>If you need to request a new SSL certificate in Google Cloud, follow these steps:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to Google Cloud Console.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Security</strong> &gt; <strong>Certificate Manager</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Create Certificate</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Request a New Managed Certificate</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter a certificate name.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select <strong>Managed Certificate</strong>.</li><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter your domain name.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Choose <strong>DNS validation</strong> (recommended for automated renewal).</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Create</strong>.</li><li style=\"--number-width: 19px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Validate the certificate.</li></ol>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">If you selected <strong>DNS validation</strong>, add the provided DNS records to your domain registrar.</li><li style=\"margin-left: 28px; position: relative;\">If you selected <strong>Email validation</strong>, follow the instructions sent to the domain's email.</li></ul>\n<ol start=\"11\" style=\"padding-left: 0px;\"><li style=\"--number-width: 17px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Wait for validation. Google will verify your domain, and, once approved, the certificate status will be <strong>Active</strong>.</li></ol>\n<h4>Import an existing certificate</h4>\n<p>If you want to use a custom SSL certificate, follow these steps:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to Google Cloud Console.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Security </strong>&gt; <strong>Certificate Manager</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Create Certificate</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Import Your SSL Certificate</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select <strong>Self-managed Certificate</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Upload your <strong>PEM-encoded certificate file</strong>.</li><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Upload your <strong>PEM-encoded private key</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">(Optional) Upload the <strong>certificate chain</strong> if required.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Create</strong>.</li></ol>\n<h3><a id=\"Create_an_Ingress_for_integration_between_OO_and_Service_Management_in_GCP\" name=\"Create_an_Ingress_for_integration_between_OO_and_Service_Management_in_GCP\" title=\"Create an Ingress for integration between OO and Service Management in GCP\"></a>Create an Ingress for integration between OO and Service Management in GCP</h3>\n<p>Use Google Cloud HTTP(S) Load Balancer to allow end users to access OO and Service Management from web browsers. Configure an Internal Load Balancer (ILB) for integration and define listeners for OO and Service Management.</p>\n<h4><a id=\"Step_1_Create_an_Ingress_for_OO_integration\" name=\"Step_1_Create_an_Ingress_for_OO_integration\" title=\"Step 1: Create an Ingress for OO integration\"></a>Step 1: Create an Ingress for OO integration</h4>\n<p>To create an Ingress for OO integration, follow these steps:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Save the content below as <code>oo-internal-ingress.yaml</code>:</li></ol>\n<pre>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: \"oo-internal-ingress\"\n  namespace: &lt;OO_NAMESPACE&gt;\n  annotations:\n    kubernetes.io/ingress.class: \"gce-internal\"\n    networking.gke.io/load-balancer-type: \"Internal\"\n    kubernetes.io/ingress.regional-static-ip-name: \"&lt;integration_LB_name&gt;\"\n    kubernetes.io/ingress.allow-http: \"false\"\n    networking.gke.io/managed-certificates: \"&lt;certificate_name&gt;\"\n    ingress.kubernetes.io/health-check-path: \"/healthz\"\n    ingress.kubernetes.io/health-check-interval: \"30\"\n    ingress.kubernetes.io/health-check-timeout: \"10\"\n    ingress.kubernetes.io/health-check-unhealthy-threshold: \"2\"\n    ingress.kubernetes.io/health-check-healthy-threshold: \"2\"\n  labels:\n    app: oo-internal-ingress\nspec:\n  tls:\n  - hosts:\n    - &lt;INTEGRATION_LB_HOST&gt;\n    secretName: &lt;tls_secret_name&gt;\n  rules:\n    - host: &lt;INTEGRATION_LB_HOST&gt;\n      http:\n        paths:\n          - path: /*\n            pathType: ImplementationSpecific\n            backend:\n              service:\n                name: &lt;OO_NGINX_CONTROLLER_SVC&gt;\n                port:\n                  number: 443</pre>\n<p>Replace the following with actual values:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><code>&lt;OO_NAMESPACE&gt;</code>: The namespace where you installed OO. For example, <code>oo</code>.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;integration_LB_name&gt;</code>: A name for this internal Load Balancer. For example, <code>oo-int-lb</code>.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;certificate_name&gt;</code>: The name of the Google-managed SSL certificate for the Load Balancer.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;INTEGRATION_LB_HOST&gt;</code>: The FQDN assigned to the Load Balancer.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;tls_secret_name&gt;</code>: The TLS secret name if using a manually managed certificate.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;OO_NGINX_CONTROLLER_SVC&gt;</code>: The Kubernetes service name of the OO deployed Nginx ingress controller. Retrieve it using:</li></ul>\n<pre itemid=\"codeBlockEditor-2f45af1d-7a1a-47e5-b6ea-b204e087d2cc\"><code>kubectl get svc -n &lt;OO_NAMESPACE&gt; | grep -i itom-ingress | awk '{print$1}'</code></pre>\n<ol start=\"2\" style=\"padding-left: 0px;\"><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the following command to apply the saved YAML file:</li></ol>\n<pre>kubectl create -f /path/to/oo-internal-ingress.yaml</pre>\n<h4><a id=\"Step_2_Create_an_Ingress_for_Service_Management_integration\" name=\"Step_2_Create_an_Ingress_for_Service_Management_integration\" title=\"Step 2: Create an Ingress for Service Management integration\"></a><span>Step 2: Create an Ingress for Service Management integration</span></h4>\n<p>To create an Ingress for Service Management integration, follow these steps:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Save the content below as <code>smax-integration-ingress.yaml</code>:</li></ol>\n<pre>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: \"sma-ingress\"\n  namespace: &lt;ITSMA_NAMESPACE&gt;\n  annotations:\n    kubernetes.io/ingress.class: \"gce-internal\"\n    networking.gke.io/load-balancer-type: \"Internal\"\n    kubernetes.io/ingress.regional-static-ip-name: \"&lt;integration_LB_name&gt;\"\n    kubernetes.io/ingress.allow-http: \"false\"\n    networking.gke.io/managed-certificates: \"&lt;certificate_name&gt;\"\n    ingress.kubernetes.io/health-check-path: \"/healthz\"\n    ingress.kubernetes.io/health-check-interval: \"30\"\n    ingress.kubernetes.io/health-check-timeout: \"10\"\n    ingress.kubernetes.io/health-check-unhealthy-threshold: \"2\"\n    ingress.kubernetes.io/health-check-healthy-threshold: \"2\"\n  labels:\n    app: sma-integration-ingress\nspec:\n  tls:\n  - hosts:\n    - &lt;INTEGRATION_LB_HOST&gt;\n    secretName: &lt;tls_secret_name&gt;\n  rules:\n    - host: &lt;INTEGRATION_LB_HOST&gt;\n      http:\n        paths:\n          - path: /*\n            pathType: ImplementationSpecific\n            backend:\n              service:\n                name: \"itom-ingress-controller-svc\"\n                port:\n                  number: 443</pre>\n<p>Replace the following with actual values:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><code>&lt;ITSMA_NAMESPACE&gt;</code>: The namespace of the Service Management deployment. For example, <code>itsma</code>.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;integration_LB_name&gt;</code>: A name for this internal Load Balancer. For example, <code>sma-int-lb</code>.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;certificate_name&gt;</code>: The name of the Google-managed SSL certificate for the Load Balancer.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;INTEGRATION_LB_HOST&gt;</code>: The FQDN assigned to the Load Balancer.</li><li style=\"margin-left: 28px; position: relative;\"><code>&lt;tls_secret_name&gt;</code>: The TLS secret name if using a manually managed certificate. Apply the Ingress configuration:</li></ul>\n<pre><code>kubectl get svc -n &lt;oo_namespace&gt; | grep -i itom-ingress | awk '{print$1}'</code></pre>\n<ol start=\"2\" style=\"padding-left: 0px;\"><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the following command to apply the saved YAML file:</li></ol>\n<pre>kubectl create -f smax-integration-ingress.yaml</pre>\n<h3><a id=\"Bind_an_FQDN_with_the_integration_Load_Balancer\" name=\"Bind_an_FQDN_with_the_integration_Load_Balancer\" title=\"Bind an FQDN with the integration Load Balancer\"></a>Bind an FQDN with the integration Load Balancer</h3>\n<p>After creating and configuring the integration Load Balancer, update your DNS settings to bind the assigned FQDN with the Load Balancer’s IP address.</p>\n<p>This configuration sets up an internal Load Balancer in Google Cloud (GKE) instead of AWS ALB, ensuring secure HTTPS traffic, a Google-managed certificate, and internal routing for Service Management and OO integration.</p>\n<h2><a id=\"Update_OO_deployment\" name=\"Update_OO_deployment\" title=\"Update OO deployment\"></a>Update OO deployment</h2>\n<p>After creating Load Balancers, update the OO deployment with the certificate(s) you used. </p>\n<p>Copy the certificates on the Bastion host, and run the following commands in the Bastion host to update the OO installation:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Get the name of the OO Helm installation.\n\t<pre>[user@ip-10-0-0-1 ~]# helm list -n oo-helm\nNAME            NAMESPACE       REVISION        UPDATED                                 STATUS          CHART                   APP VERSION\noo              oo-helm         18              2024-11-05 13:15:20.156866707 +0000 UTC deployed        oo-1.x.x+26.x.x         25.2\n[root@ip-10-0-0-1 ~]#\n</pre>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Reconfigure OO installation.\n\t<pre>helm upgrade oo -n oo-helm --reuse-values --set-file \"caCertificates.oo_lb\\.crt\"=/path/to/oo_external_load_balancer_certificate.crt --set-file \"caCertificates.integration_lb\\.crt\"=/path/to/integration_load_balancer_certificate.crt</pre>\n<p>This command takes about 2 minutes to complete. </p>\n</li></ol>\n</div>",
  "modifiedon": "2025-12-15 12:20:41"
}