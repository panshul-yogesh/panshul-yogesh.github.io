{
  "title": "Subscribe NFS Filestore",
  "content": "<div class=\"mw-parser-output\"><br/><br/><div> </div>\n<table>\n<tbody>\n<tr>\n<th>Role</th>\n<th>Location</th>\n</tr>\n<tr>\n<td>Storage administrator</td>\n<td>GCP Console</td>\n</tr>\n</tbody>\n</table>\n<p>This topic describes how to use Filestore and Persistent Disk storage services from Google to store the OMT and suite data on GCP. </p>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"> </div>\n<div class=\"admonition-content admonition-note-content\">For information about storage sizing and management, see <a href=\"/doc/423/26.1/managestoragesuite\" title=\"Manage persistent storage for the suite\">Manage persistent storage for the suite</a>.</div>\n</div>\n<p>This release supports Filestore and Persistent Disk storage services on GCP. FileStore stores data attachments, certificates, and logs used by containerized applications in Kubernetes. It serves as the backend storage for data-volume, config-volume, and logging-volume. Persistent Disk offers high-performance and highly durable block storage for search engines and RabbitMQ. It serves as the backend storage for other volumes. </p>\n<p>We provide static and dynamic solutions for volumes that use FileStore. For volumes that use Persistent Disks, we only provide dynamic solutions. To take advantage of the benefits such as ease of use and reliability, we recommend using the dynamic solution.</p>\n<h2>Plan the storage solution</h2>\n<p>See the following options to combine and use the Filestore and Persistent Disk storage services in your deployment. Each option lists the tasks involved in setting up the services:</p>\n<ul>\n<li><strong>Filestore dynamic provision and Persistent Disk dynamic provision (Recommended)</strong>\n<ul>\n<li>Enable Filestore and Persistent Disks APIs</li>\n</ul>\n</li>\n<li><strong>Filestore static provision and Persistent Disk dynamic provision</strong>\n<ul>\n<li>Enable Filestore and Persistent Disks APIs</li>\n<li>Subscribe to Filestore service\n\t\t<ul>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>The instructions for setting up each option are provided in the following sections.</p>\n<h3>Enabled Filestore and Persistent Disk APIs</h3>\n<p>To use either the Filestore or Persistent Disk storage services, you must first enable the APIs for them. For information on enabling the Filestore and Persistent Disk APIs, refer to Google's official documentation on <a href=\"https://cloud.google.com/endpoints/docs/openapi/enable-api#enabling_an_api\" title=\"Enabling an API\">Enabling an API</a>.</p>\n<h2><span style=\"font-size: clamp(1.3125rem, 15.4737px + 1.15132vw, 1.75rem);\">Subscribe to Filestore service</span></h2>\n<p>The following sections are applicable if you choose the Filestore static provision along with Persistent Disk dynamic provision as the storage solution.</p>\n<h4>Create Filestore instance</h4>\n<p>Complete the following steps to create a Filestore instance:</p>\n<ol>\n<li>Log in to the Google Cloud Platform Console at <a class=\"external free\" href=\"https://console.cloud.google.com/\" rel=\"nofollow\" target=\"1\" title=\"https://console.cloud.google.com/\">https://console.cloud.google.com/</a>.</li>\n<li>Click <b>Filestore</b> &gt; <strong>Instances</strong> &gt; <b>CREATE INSTANCE</b>.</li>\n<li>Under <b>Name your instance</b>, give a name to the instance.</li>\n<li>Under <b>Configure service tier</b>, select an <b>Instance type</b> and a <b>Storage type.</b></li>\n<li>Under <b>Allocate capacity</b>, enter the minimum capacity available in the selected <strong>Instance </strong>type. </li>\n<li>Under <b>Choose where to store your data</b>, select the same region as the prepared VPC.</li>\n<li>Under <b>Set up connections</b> &gt; <b>VPC network</b>, select the prepared VPC.</li>\n<li>Under <b>Configure your file share</b>, give a name to this file share. You will need it in the command when accessing NFS data.</li>\n<li>Leave the remaining settings as is and click <b>CREATE</b>.</li>\n</ol>\n<p>After the Filestore instance is successfully created, you can find an IP address assigned to your instance in the Filestore list. Test its connectivity from the bastion node by running the commands below:</p>\n<pre><code>sudo yum install -y nfs-utils\nshowmount -e &lt;filestore_ip_address&gt;</code></pre>\n<h4 class=\"mw-headline\" id=\"Configure_NFS_volumes\">Configure NFS volumes</h4>\n<table>\n<tbody>\n<tr>\n<th>Role</th>\n<th>Location</th>\n</tr>\n<tr>\n<td>Storage administrator</td>\n<td>Bastion node</td>\n</tr>\n</tbody>\n</table>\n<p>Once the Filestore instance is ready, log on to the bastion and set up NFS volumes to store global data, Smart Analytics data, and database data of the suite. To set up the NFS volumes, follow these steps:</p>\n<ol>\n<li>Run the <strong>rpm -qa|grep nfs-utils</strong> command to check if the <strong>nfs-utils</strong> package is already installed. Run the following command to install it if necessary:\n\n\t<pre><code>sudo yum install -y nfs-utils</code></pre>\n</li>\n<li>Copy the following script content and save it as <b>createFileStore.sh </b>file:\n\t<pre><code>#!/bin/bash\n\nif [ $# -lt 1 ]; then\n echo \"Usage: $0 &lt;NFS-server-FQDN&gt; &lt;Root-folder&gt; &lt;SUITE_USER_UID&gt; &lt;SUITE_USER_GID&gt; [&lt;NFS-version&gt;]\"\n exit 1\nfi\n\nMOUNT_POINT=\"/mnt/nfs\"\nNFS_SERVER=$1\nROOT_FOLDER=${2:-\"\"}\nSUITE_USER_UID=$3\nSUITE_USER_GID=$4\nNFS_VERSION=${5:-\"3\"}\nNFS_PARENT=\"var/vols/itom\"\n\nif [ ! -d $MOUNT_POINT ]; then\n mkdir -p $MOUNT_POINT\nfi\n\ndeclare -a arr=(\n\"itsma/config-volume\"\n\"itsma/logging-volume\"\n\"itsma/data-volume\"\n)\n\nmountNFS() {\n mount -t nfs -o nfsvers=${NFS_VERSION} ${NFS_SERVER}:/${ROOT_FOLDER} ${MOUNT_POINT}\n if [ $? -eq 0 ] || [ $? -eq 32 ]; then\n echo \"Successfully mount NFS\"\n sed -i '$a\\'\"$NFS_SERVER:/$ROOT_FOLDER $MOUNT_POINT nfs nfsvers=${NFS_VERSION} 0 0\" /etc/fstab\n else\n echo \"Could not mount NFS\"\n exit 1\n fi\n}\n\nmake_volume() {\n local VOLUME=$1\n pushd $(pwd)\n cd ${MOUNT_POINT}\n local MOUNTED_PV=${MOUNT_POINT}/${NFS_PARENT}/${VOLUME}\n if [ ! -d ${MOUNTED_PV} ]; then\n mkdir -p ${MOUNTED_PV}\n fi\n chown -R ${SUITE_USER_UID}:${SUITE_USER_GID} ${MOUNTED_PV}\n chmod g+w ${MOUNTED_PV}\n chmod g+s ${MOUNTED_PV}\n popd\n}\n\nmountNFS\n\nfor i in \"${arr[@]}\"; do\n make_volume ${i}\ndone</code></pre>\n</li>\n<li>Run the following commands to configure Filestore volumes:\n\t<pre><code>chmod 755 createFileStore.sh\nsudo ./createFileStore.sh &lt;filestore_ip_address&gt; &lt;fileshare_name&gt; &lt;system_user_id&gt; &lt;system_group_id&gt;</code></pre>\n\tWhere:\n\n\t<ul>\n<li><code>&lt;filestore_ip_address&gt;</code><strong> </strong>and<strong> </strong><code>&lt;fileshare_name&gt;</code><strong> </strong>are the IP address and name of the Filestore. You can find it on the Filestore list page.</li>\n<li><code>&lt;system_user_id&gt;</code><strong> </strong>and<strong> </strong><code>&lt;system_group_id&gt;</code><strong> </strong>are the operating system user ID and group ID respectively that are used to run the process in the container. Both values must be 1999 or a number between 100000 and 2000000000 (for example, UID=100001 and GID=100002).</li>\n</ul>\n</li>\n</ol>\n<h2 class=\"mw-headline\" id=\"Related_topics\">External references</h2>\n<ul>\n<li>For details on Filestore, see <a class=\"external text\" href=\"https://cloud.google.com/filestore/docs\" rel=\"nofollow\" target=\"1\" title=\"Cloud Filestore\">Filestore</a>.</li>\n<li>For details on Persistent Disk, see <a href=\"https://cloud.google.com/persistent-disk/#documentation\" title=\"Persistent Disk\">Persistent Disk</a>.</li>\n</ul>\n<div> </div>\n<div> </div>\n</div>",
  "modifiedon": "2025-10-24 08:51:12"
}