{
  "title": "Prepare persistent volumes and claims for OO (GKE)",
  "content": "<div class=\"mw-parser-output\">\n \n\n<p>OO Containerized installation requires below Persistent Volumes (PVs) and Persistent Volume Claims (PVCs). PVs are pieces of storage relevant to Google Cloud Filestore volumes, and PVCs are requests for a piece of storage on a volume.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>OO operates independently from SM at both the database and storage layers. Persistent Volume (PV) and Persistent Volume Claim (PVC) separation is mandatory.</div></div></div>\n<p>Currently, OO uses persistent storage by providing the names of the required PVCs at OO install time via Helm parameters. This means that you must create both PVs and PVCs upfront.</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Component</th>\n<th scope=\"col\">Google Cloud Filestore volume name</th>\n<th scope=\"col\">Description</th>\n<th scope=\"col\">Example Directory path</th>\n<th scope=\"col\">Size</th>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-config-vol</code></td>\n<td>Stores OO configuration files.</td>\n<td><code>/var/vols/itom/oo/oo_config_vol</code></td>\n<td>~ 1 GB</td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-data-vol</code></td>\n<td>Stores OO, OO deployed AutoPass, and OO deployed Vault-generated data.</td>\n<td><code>/var/vols/itom/oo/oo_data_vol</code></td>\n<td>~ 1 GB</td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-logs-vol</code></td>\n<td>Stores logs generated by the OO components, except RAS logs which are stored in a different volume.</td>\n<td><code>/var/vols/itom/oo/oo_logs_vol</code></td>\n<td>1-5 GB</td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-data-export-vol</code></td>\n<td>\n<p>OO runs a Kubernetes <strong>cron job</strong> for purging OO database with a retention period set to 375 days (default value). </p>\n<p>All the database data that's marked for purge gets exported first and exposed in this volume before purging. </p>\n</td>\n<td><code>/var/vols/itom/oo/oo_data_export_vol</code></td>\n<td>50-90 GB<br/>\n<br/>\n<em>See notes below</em></td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-ras-logs-vol</code></td>\n<td>Stores OO RAS logs. </td>\n<td><code>/var/vols/itom/oo/oo_ras_logs_vol</code></td>\n<td>1-5 GB</td>\n</tr>\n</thead>\n</table>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>\n<p>The \"OO Database Maintenance and Export\" Kubernetes <strong>cron job</strong> uses the <em>oo-data-export-vol </em>volume. You can find more information about this job <a href=\"/doc/423/26.1/399-gcpooccreateyml#Database_maintenance_parameters\" title=\"here\">here</a>.</p>\n<p>Two factors directly influence the size of the <em>oo-data-export-vol </em>volume:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">The complexity of the flows that OO runs.<br/>\n\tOO flows that work with &gt; 1 GB worth of data per flow context, are considered \"heavy\" flows and this data will end up in the Google Cloud Filestore. Adjust the volumes depending on the number of flows that you run.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">The number of tenants.<br/>\n\tMore tenants means more data in the database. This data gets exported in this Google Cloud Filestore volume. (more tenants means bigger <em>oo-data-export-vol </em>volume size)</li></ol>\n</div></div></div>\n<h2><a id=\"Create_persistent_volumes\" name=\"Create_persistent_volumes\" title=\"Create persistent volumes\"></a>Create persistent volumes</h2>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Navigate to the OO chart package directory. For example:</p>\n<pre><code>cd oo-helm-charts-1.x.x+26.x.x/oo-1.x.x+26.x.x/oo-helm-charts/samples/persistent_storage/gke/</code></pre>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p><strong>To enable encrypted data in transit</strong> follow the below steps.</p>\n<ol start=\"1\" style=\"padding-left: 0px;\"><li style=\"--number-width: 21px; --number-spacing: 25px; margin-left: 49px; position: relative;\">\n<p>Open the <strong>volumes-encrypted.yaml</strong><b> </b>file with a text editor, specify the below information in each volume template then save the file:</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>Set the sizes for each persistent volume in this file according to the table provided in the first section of this page.</div></div></div>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 52px; position: relative;\">\n<p>Inside <strong>volumes-encrypted.yaml</strong>, replace all <code>&lt;file_system_id&gt;</code> occurrences with the actual<b> </b>Filestore instance name from GCP.</p>\n</li><li style=\"margin-left: 52px; position: relative;\">\n<p>Inside <strong>volumes-encrypted.yaml</strong>, replace all <code>&lt;NFS_directory_path&gt;</code> values with the actual Filestore mount directory path mapped to each volume.</p>\n</li><li style=\"margin-left: 52px; position: relative;\">\n<p>The storage class Name that needs to be used with the OO volumes.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>\n<p>By default, the <code>storageClassName</code> attribute of the PVs is empty.</p>\n<p>If you have a storageClass(es) that you want the OO volumes to use, then specify the storage class Name(s) for each volume.</p>\n<p>You can use a different Storage Class name for each volume, or the same storage class Name for all volumes.</p>\n</div></div></div>\n</li></ul>\n</li></ol>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p><strong>To continue without encrypting data</strong> in transit follow the below steps.</p>\n<ol start=\"1\" style=\"padding-left: 0px;\"><li style=\"--number-width: 21px; --number-spacing: 25px; margin-left: 49px; position: relative;\">\n<p>Open the <strong>volumes.yaml</strong><b> </b>file with a text editor, specify the below information in each volume template then save the file:</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>Set the sizes for each persistent volume in this file according to the table provided in the first section of this page.</div></div></div>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 52px; position: relative;\">\n<p>Inside <strong>volumes.yaml</strong>, replace all <code>&lt;NFS_FQDN&gt; </code>values with the actual IP address or FQDN of the Filestore instance.</p>\n</li><li style=\"margin-left: 52px; position: relative;\">\n<p>Inside <strong>volumes.yaml</strong>, replace all <code>&lt;NFS_directory_path&gt;</code> values with the actual Filestore mount directory paths mapped to each volume.</p>\n</li><li style=\"margin-left: 52px; position: relative;\">\n<p>The storage class Name that needs to be used with the OO volumes.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>\n<p>By default, the <code>storageClassName</code> attribute of the PVs is empty.</p>\n<p>If you have a storageClass(es) that you want the OO volumes to use, then specify the storage class Name(s) for each volume.</p>\n<p>You can use a different Storage Class name for each volume, or the same storage class Name for all volumes.</p>\n</div></div></div>\n</li></ul>\n</li></ol>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Run the following command to create persistent volumes:</p>\n<pre><code>kubectl create -f oo-helm-charts-1.x.x+26.x.x/oo-1.x.x+26.x.x/oo-helm-charts/samples/persistent_storage/gke/volumes.yaml</code></pre>\n</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Run the following command to verify the volume creation:</p>\n<pre><code>kubectl get pv | grep oo</code></pre>\n</li></ol>\n<h2><a id=\"Create_persistent_volume_claims\" name=\"Create_persistent_volume_claims\" title=\"Create persistent volume claims\"></a>Create persistent volume claims</h2>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Navigate to the OO chart package directory. For example:</p>\n<pre><code>cd oo-helm-charts-1.x.x+26.x.x/oo-1.x.x+26.x.x/oo-helm-charts/samples/persistent_storage/gke/</code></pre>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Open the <strong>claims.yaml</strong><b> </b>file with a text editor, specify the below information in each volume claim template then save the file:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">\n<p>The namespace where you deploy OO. You specified this namespace as part of the <a href=\"/doc/423/26.1/399-gcpcreateoocdeployment\" title=\"Create a new deployment for OO on GKE\">Create a new deployment for OO on GKE</a> step.</p>\n</li><li style=\"margin-left: 40px; position: relative;\">\n<p>The volume name that the persistent volume claims (PVC) are bound to.</p>\n</li><li style=\"margin-left: 40px; position: relative;\">\n<p>If you have used a storage class name during the creation of the OO volumes, then specify the name(s) of the storage class for each PVC to bind it to the corresponding volume.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>\n<p>The relationship between the OO volume claims and OO volumes is the following:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 52px; position: relative;\"><code>oo-config-pvc</code> -&gt; <code>oo-config-vol</code></li><li style=\"margin-left: 52px; position: relative;\"><code>oo-data-pvc</code> -&gt; <code>oo-data-vol</code></li><li style=\"margin-left: 52px; position: relative;\"><code>oo-logs-pvc</code> -&gt; <code>oo-logs-vol</code></li><li style=\"margin-left: 52px; position: relative;\"><code>oo-data-export-pvc</code> -&gt; <code>oo-data-export-vol</code></li><li style=\"margin-left: 52px; position: relative;\"><code>oo-ras-logs-pvc</code> -&gt; <code>oo-ras-logs-vol</code></li></ul>\n</div></div></div>\n</li></ul>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the following command to create persistent volume claims:\n\t<pre><code>kubectl create -f oo-helm-charts-1.x.x+26.x.x/oo-1.x.x+26.x.x/oo-helm-charts/samples/persistent_storage/gke/claims.yaml</code></pre>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Run the following command to verify the volume creation:</p>\n<pre><code>kubectl get pvc -n &lt;oo_namespace&gt; | grep oo</code></pre>\n</li></ol>\n</div>",
  "modifiedon": "2025-12-15 12:36:41"
}