{
  "title": "Configure the Vertica database and enable TLS",
  "content": "<div class=\"mw-parser-output\">\n<p>This topic gives you the steps to configure Vertica database and enable TLS using the <code>dbinit.sh</code> command. Run all the steps in this topic as a root (or sudo root) user on the Vertica node where you installed the OPTIC Data Lake UDX plug-in, and where you ran <code>dbinit.sh</code> with the genconfig option to create the <code>dbinit_conf.yaml</code> file.</p>\n<h2><a id=\"Check_the_variables_file\" name=\"Check_the_variables_file\" title=\"Check the variables file\"></a>Check the variables file</h2>\n<p>Before you begin database initialization, ensure that the variables file (<code>dbinit_conf.yaml</code>) is available in the required location.</p>\n<ol>\n<li>Log on to a Vertica node as <code>root</code> user.</li>\n<li>Check the <strong>conf</strong> directory for the variables file \n\t<pre><code>ls /usr/local/itom-di-pulsarudx/conf/dbinit_conf.yaml</code></pre>\n\tIf the file is not created, follow the steps described in <a href=\"/doc/423/26.1/402-variablesfilegenconfig\" target=\"_blank\" title=\"CreatetheVariable\">Create the variables file</a> topic.</li>\n</ol>\n<h2><a id=\"Example_to_run_dbinit.sh_command_with_no_TLS\" name=\"Example_to_run_dbinit.sh_command_with_no_TLS\" title=\"Example to run dbinit.sh command with no TLS\"></a>Example to run dbinit.sh command with no TLS</h2>\n<p>The <code>dbinit.sh</code> command allows different options as required for different TLS configuration types. Running <code>dbinit.sh</code> with no options, is a way to configure vertica without enabling TLS.</p>\n<p>To run dbinit.sh with no TLS:</p>\n<pre><code>/usr/local/itom-di-pulsarudx/bin/dbinit.sh </code></pre>\n<h2><a id=\"Examples_to_enable_TLS_for_Vertica\" name=\"Examples_to_enable_TLS_for_Vertica\" title=\"Examples to enable TLS for Vertica\"></a>Examples to enable TLS for Vertica </h2>\n<p>To enable TLS for Vertica connections, you must first create certificate files specific to your environment. The server-signed certificate must include the FQDN of all current and future Vertica nodes in the Subject Alternative Name (SAN) field. For any set of certificates, you will have the following:</p>\n<ul>\n<li>A private key file</li>\n<li>A certificate authority (CA) file</li>\n<li>Optionally, intermediate CA certificates</li>\n<li>The server-signed certificate file</li>\n</ul>\n<p>You can name these files as you want and store them in any directory on the Vertica node. The paths and filenames provided in the examples are only for reference.</p>\n<h3><a id=\"Example_1\" name=\"Example_1\" title=\"Example 1\"></a>Example 1</h3>\n<p>The following example shows a command string where you have three certificate files for TLS, placed in the <code>/home/dbadmin</code> directory on the Vertica node where you installed the OPTIC Data Lake UDX plug-in, <code>/usr/local/itom-di-pulsarudx/bin</code>.</p>\n<pre><code>/usr/local/itom-di-pulsarudx/bin/dbinit.sh --tlsenforce true --tlscacrt /home/dbadmin/cdf_ca.crt --tlscrt /home/dbadmin/server.crt --tlskey /home/dbadmin/server.key\n</code></pre>\n<p>This creates the users and passwords for commonly used deployment scenarios and enables TLS. </p>\n<h3><a id=\"Example_2\" name=\"Example_2\" title=\"Example 2\"></a>Example 2</h3>\n<p>The following example shows a command where a total of six certificate files are used. The example assumes that your company's CA-signed certificate includes a chain with three intermediate CAs.</p>\n<pre><code>./dbinit.sh --tlsenforce true --tlscacrt /home/dbadmin/cdf_ca.crt --tlsintercrt /home/dbadmin/intermediate_ca1.crt,/home/dbadmin/intermediate_ca2.crt,/home/dbadmin/intermediate_ca3.crt --tlscrt /home/dbadmin/vertica_server.crt --tlskey /home/dbadmin/vertica.key</code></pre>\n<p>The first comma separated value in the <code>tlsintercrt</code> list is the intermediate certificate closest to the top-level CA root and the last in the list is the intermediate certificate closest to your server-signed certificate. While passing the certificates in the command line, the order should be root CA, intermediate certificates with no space between filenames, then the server cert, and server key. </p>\n<p>You must type the database administrator password when prompted. Also, for users created by the <code>dbinit.sh</code>, the command prompts for passwords unless you use the <code>--silent</code> option. Ensure that you note the passwords and keep them safe for future use.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-tip-icon\"></div><div class=\"admonition-content admonition-tip-content\"><div>To update only the <strong>TLS configurations</strong>, you can run the commands by adding <code>--tlsonly</code> option. This ensures that the other settings in Vertica are not changed.</div></div></div>\n<p>The other advanced options for running the <code>dbinit.sh</code> command are discussed in the section, <em>Running dbinit.sh with advanced options</em>.</p>\n<h2><a id=\"Running_dbinit.sh_with_advanced_options\" name=\"Running_dbinit.sh_with_advanced_options\" title=\"Running dbinit.sh with advanced options\"></a>Running dbinit.sh with advanced options</h2>\n<div>You can use the following advanced options when running the <code>dbinit.sh</code> command.</div>\n<pre><code>/usr/local/itom-di-pulsarudx/bin/dbinit.sh [-x] [-h|-?|--help] [-c|--tlscrt] [-k|--tlskey] [-r|--tlscacrt ]  [-i|--tlsintercrt] [-e|--tlsenforce] [-t|--tlsonly] [-s|--silent|--suppress] [-v|--verbose] [-n|--nochange]</code></pre>\n<p>The following table provides a description of the options:</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Option</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>-x</code></td>\n<td>Use this option to restrict access to Vertica system tables for users.</td>\n</tr>\n<tr>\n<td>\n<p><code>-h</code>, <code>-?</code>, <code>--help</code></p>\n</td>\n<td>\n<p>Display the script usage or help.</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-s</code>, <code>--silent</code>, <code>--suppress</code></p>\n</td>\n<td>\n<p>Option to run the script without prompting for variable input. The passwords are pulled from environment variables: <code>VERTICA_DBA_PASS, VERTICA_RW_PASSWD, VERTICA_RO_PASSWD, VERTICA_MON_PASSWD</code>.</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-c</code>, <code>--tlscrt</code></p>\n</td>\n<td>\n<p>The absolute path of the file that contains the Vertica server certificate. Update this value if you want to enable TLS or update the existing TLS configuration. If you don't give this option, the Vertica TLS remains configured as earlier.</p>\n<p>You must use this option with <code>--tlskey</code>, to enable the TLS communication with Vertica.</p>\n</td>\n</tr>\n<tr>\n<td><code>-r,--tlscacrt</code></td>\n<td>\n<p>The path of the file that contains base64 encoded CA certificate along with the certificate file name.  Update this value if you want to enable TLS or update the existing TLS configuration. If you don't give this option, the Vertica TLS remains configured as earlier.</p>\n<p>You must use this option with <code>--tlscrt,</code> <code>--tlscacrt</code> and <code>--tlskey</code> to enable the TLS communication with Vertica.</p>\n</td>\n</tr>\n<tr>\n<td><code>-i,--tlsintercrt</code></td>\n<td>\n<p>The path of the file that contains base64 encoded intermediate certificates along with the certificate file name.  If you have more than one intermediate certificate, you can pass the certificates separated by comma. Update this value if you want to enable TLS or update the existing TLS configuration. If you don't give this option, the Vertica TLS remains configured as earlier.<br/>\n\t\t\tThe first comma separated value is considered as the first intermediate certificate. While passing the certificates in the command line, the order should be <code>root CA</code> , <code>intermediate CA1</code>, <code>intermediate CA2</code>, <code>intermediate</code> <code>CA3</code>, <code>intermediate CA&lt;n&gt;</code> <code>server cert</code>  <code>server key</code>. </p>\n<p>You must use this option with <code>--tlscrt</code>, <code>--tlsintercrt</code>, and <code>--tlskey</code>, to enable the TLS communication with Vertica.</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-k</code>, <code>--tlskey</code></p>\n</td>\n<td>\n<p>The path of the file that contains base64 encoded server key certificate along with the key file name. Update this value if you want to enable TLS or update the existing TLS configuration.</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-e</code>, <code>--tlsenforce</code></p>\n</td>\n<td>\n<p>Option to enforce TLS. Default value is <code>true</code>. When <code>true</code>, Vertica rejects non TLS communication by any application that uses Vertica. When <code>false</code>, Vertica accepts non TLS communication. </p>\n<p>You can set this option only if you have configured TLS for Vertica. To configure TLS for Vertica, use the <code>tlscrt</code> and <code>tlskey</code> options or see the Vertica documentation.</p>\n<p>You can choose not to set this option, however, it's recommended to set the <code>tlsenforce</code> to <code>true</code>.</p>\n<p>You can use this option without the <code>--tlscrt</code> and <code>--tlskey</code> options to disable or enable TLS enforcement.</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-t</code>, <code>--tlsonly</code></p>\n</td>\n<td>\n<p>Option to apply the changes that you made to TLS to Vertica. You must use <code>--tlscrt</code> and <code>--tlskey</code> or <code>--tlsenforce</code> options along with this option.</p>\n<p>When you use this option, the script performs only the TLS configurations. The other settings in Vertica are not changed. </p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-v,--verbose</code></p>\n</td>\n<td>\n<p>Option to view the detailed output on the console that includes all the SQL queries invoked.</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-n,--nochange</code></p>\n</td>\n<td>Option to view the SQL queries that are invoked when the script runs. This option doesn't change Vertica. It displays only the queries. </td>\n</tr>\n</tbody>\n</table>\n<h2><a id=\"View_the_configuration_file_history\" name=\"View_the_configuration_file_history\" title=\"View the configuration file history\"></a>View the configuration file history</h2>\n<p>The database configuration tool stores its history in the database. You can use the <code>dbinit history</code> command to retrieve the history or save the content of the last <code>dbinit_conf.yaml</code> file used.</p>\n<p><code>./dbinit.sh history &lt;options&gt;</code></p>\n<p><strong>Options usage</strong>: <code>dbinit.sh history [-h|-?|--help] [-c|--config] [--p &lt;path to prefix&gt;|--prefix=&lt;path to prefix&gt;] [-s|--sql] [-n &lt;number&gt;|--number &lt;number&gt;] [-z|--zip]</code></p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Option</th>\n<th scope=\"col\">Description</th>\n</tr>\n<tr>\n<td>\n<p><code>-h</code>, <code>-?</code>, <code>--help</code></p>\n</td>\n<td>\n<p>Displays the script usage or help.</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-c</code>, <code>--config</code></p>\n</td>\n<td>\n<p>Displays the last configuration used on the screen.<br/>\n<strong>Usage:</strong> <code>dbinit.sh history --config &gt; /tmp/my_conf.yaml</code></p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-p &lt;path to prefix&gt;</code>, <code>--prefix=&lt;path to prefix&gt;</code></p>\n</td>\n<td>\n<p>Option to specify the path to save history. The history file(s) will use that prefix with<code> _&lt;n&gt;.yaml</code> appended to it. <br/>\n<strong>Usage:</strong> <code>dbinit.sh history -p /tmp/my_history</code><br/>\n<code>dbinit.sh history --prefix=/tmp/my_history</code></p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-s</code>, <code>--sql</code></p>\n</td>\n<td>\n<p>Option to include the SQL commands in the dump. The <code>dbinit</code> script saves all the SQL commands used to modify the database. If you want to include these SQL commands to the history dumps, you can use this option.<br/>\n<strong>Usage:</strong> <code>dbinit.sh history -s</code><br/>\n<code>dbinit.sh history --sql</code></p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-n &lt;number&gt;</code>, <code>--number &lt;number&gt;</code></p>\n</td>\n<td>\n<p>Option to specify how many history items you want to save. By default, the last script run is updated in history. You can use this option to include more history.<br/>\n<strong>Usage:</strong> to save the history for the last three runs of <code>dbinit.sh</code>: <code>dbinit.sh history -n 3</code><br/>\n\t\t\tto save the entire history: <code>dbinit.sh history -n 0</code></p>\n</td>\n</tr>\n<tr>\n<td>\n<p><code>-z</code>, <code>--zip</code></p>\n</td>\n<td>\n<p>Option to zip all the history files into one file <code>&lt;prefix&gt;.zip</code>. By default, the <code>dbinit.sh</code> script saves history items into separate files.<br/>\n<strong>Usage:</strong> <code>dbinit.sh history -n 2 -p /tmp/my_history -z</code></p>\n<p>This zips the last two history items <code>/tmp/my_history_1.zip</code> and <code>/tmp/my_history_2.zip</code> into <code>/tmp/my_history.zip</code>.</p>\n</td>\n</tr>\n</thead>\n</table>\n</div>",
  "modifiedon": "2026-01-30 13:44:08"
}