{
  "title": "Download the images and then upload them to an image registry",
  "content": "<div class=\"mw-parser-output\">\n<p><!--cke_bookmark_1928S--><!--cke_bookmark_1928E-->Before you deploy Operations Platform, download the installation images from the Docker Hub, and upload them to an image registry. The image registry is an external registry or a local registry on your cluster nodes, such as your enterprise repository.</p>\n<p>To download the images from the Docker Hub, and upload them to an image registry, perform the following steps:</p>\n<ul style=\"padding-left: 0px;\">\n<li style=\"margin-left: 28px; position: relative;\">Generate an image download bundle </li>\n<li style=\"margin-left: 28px; position: relative;\">Run the download script to download the images</li>\n<li style=\"margin-left: 28px; position: relative;\">Upload the images to the image registry</li>\n</ul>\n<h2><a id=\"Generate-an-image-download-bundle\" name=\"Generate-an-image-download-bundle\" title=\"Generate an image download bundle\"></a>Generate an image download bundle </h2>\n<ol style=\"padding-left: 0px;\">\n<li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log on to the bastion or first control plane node, and then navigate to the <code>/tools/generate-download</code> directory in the OMT installation package.</li>\n<li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the <code>generate_download_bundle.sh</code> command together with the options required by your deployment. For the full list of command options, run the command with the <code>-h</code> option. \n\t<pre><code>generate_download_bundle.sh --chart &lt;chart file&gt; [-H &lt;values.yaml file&gt; -d &lt;output directory&gt;]</code></pre>\n\tThis command contains the following placeholders.\n\n\t<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\">\n<thead>\n<tr>\n<th scope=\"col\">Placeholder</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>&lt;chart file&gt;</code></td>\n<td>The absolute path to the downloaded chart package.</td>\n</tr>\n<tr>\n<td><code>&lt;values.yaml file&gt;</code></td>\n<td>\n<p>The absolute path to the <code>values.yaml</code> file that you prepared to configure Operations Platform, while following the documentation.</p>\n<p>Using the -H option ensures that the script downloads only the images that you need based on the values YAML file that you have configured.</p>\n</td>\n</tr>\n<tr>\n<td><code>&lt;output directory&gt;</code> </td>\n<td>The directory where the script saves the <code>offline-download.zip</code> file. If you don't specify a value, the script saves the file to the default directory, which is the current working directory. </td>\n</tr>\n</tbody>\n</table>\n\tFor example, you run the following command:\n\n\t<pre><code>./generate_download_bundle.sh --chart /var/tmp/op-&lt;version&gt;.tgz -H /var/tmp/op-values.yaml -d /var/tmp</code>\n</pre>\n</li>\n<li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>You receive messages indicating that you have successfully generated the <code>offline-download.zip</code> file:</p>\n<pre>[INFO] 2021-07-31 17:58:46 : ** Generating the offline image download bundle ...\n[INFO] 2021-07-31 17:58:50 : Completed generation of offline-download.zip in /var/tmp\n</pre>\n\tThe generated file contains the image download bundle. This bundle downloads the images required for installation.</li>\n</ol>\n<h2 id=\"Download_the_required_installation_images\"><a id=\"Run-the-download-script-to-download-the-images\" name=\"Run-the-download-script-to-download-the-images\" title=\"Run the download script to download the images\"></a>Run the download script to download the images</h2>\n<ol style=\"padding-left: 0px;\">\n<li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">If the bastion or first control plane node can't access Docker Hub, transfer the <code>offline-download.zip</code> file to a download machine that can access Docker Hub. Then, extract the .zip package to a directory. You will later download the images to this download machine.</li>\n<li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Set up the HTTP/HTTPS proxy if you can't access the image registry. For example, you can run the following commands to set the HTTP/HTTPS proxy:\n\t<pre><code>export http_proxy=\"&lt;http://PROXY_SERVER:PORT&gt;\"\nexport https_proxy=\"&lt;https://PROXY_SERVER:PORT&gt;\"</code></pre>\n</li>\n<li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to the directory into which you extracted the <code>offline-download.zip</code> package.</li>\n<li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the following command:\n\t<pre><code>./downloadimages.sh [options]</code></pre>\n<br/>\n\tFor example, run the following command. All options in this example are optional.\n\t<pre><code>./downloadimages.sh [-o &lt;organization name&gt;] [-r &lt;image registry URL&gt;] [-u &lt;username&gt;] [-d &lt;custom image path&gt;] </code></pre>\n\tThis example command contains the following placeholders.\n\n\t<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\">\n<thead>\n<tr>\n<th scope=\"col\">Placeholder</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>&lt;organization name&gt;</code></td>\n<td>The name of the namespace or organization where you can find the images. The default value is <code>hpeswitom</code>.</td>\n</tr>\n<tr>\n<td><code>&lt;image registry URL&gt;</code></td>\n<td>An image registry, if you don't want to download images from Docker Hub.</td>\n</tr>\n<tr>\n<td><code>&lt;username&gt;</code></td>\n<td>The image registry username. Typically, this is the Docker hub credentials. If you don't specify the credentials here, the <code>./downloadimages.sh</code> script prompts you to enter them when you run the command.</td>\n</tr>\n<tr>\n<td><code>&lt;custom image path&gt;</code></td>\n<td>A custom image path if you don't want to download the images to the default directory on the download machine. The default value of the <code>&lt;custom image path&gt;</code> placeholder is <code>/var/opt/cdf/offline</code>.</td>\n</tr>\n</tbody>\n</table>\n<p>To see the full list of options for the <code>downloadimages.sh</code> command, run the command with the <code>-h</code> option.</p>\n</li>\n<li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Wait until the images finish downloading.</li>\n</ol>\n<h3 id=\"Transfer_the_images_to_the_control_plane_node\"><a id=\"Transfer-the-images-to-the-bastion-or-control-plane-node\" name=\"Transfer-the-images-to-the-bastion-or-control-plane-node\" title=\"Transfer the images to the bastion or control plane node\"></a>Transfer the images to the bastion or control plane node</h3>\n<p>If you downloaded the images to a download machine, transfer the images to a specified image directory on the bastion or first control plane node. The default image directory is <code>/var/opt/cdf/offline</code>. The directory must have free space more than twice the size of the images.  </p>\n<h2><a id=\"Upload-the-images-to-the-image-registry\" name=\"Upload-the-images-to-the-image-registry\" title=\"Upload the images to the image registry\"></a>Upload the images to the image registry</h2>\n<p>Navigate to the <code>$CDF_HOME/scripts/</code> directory on the bastion or control plane node where you downloaded or copied the images.</p>\n<p>Run the appropriate following command to upload the images to the image registry.<br/>\n<br/>\n<strong>External Kubernetes with an external registry:</strong></p>\n<pre><code>./uploadimages.sh -d &lt;downloaded_image_directory&gt; -r &lt;external_repository_URL&gt; -u &lt;registry-user&gt;  [or -f &lt;key_file&gt;]</code></pre>\n<p><span id=\"cke_bm_1413S\" style=\"display: none;\"> </span>For example:</p>\n<pre><code>./uploadimages.sh -r xxxxxxxx.dkr.ecr.us-east-1.amazonaws.com -u user</code></pre>\n<p><br/>\nThe command contains the following placeholders.</p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\">\n<thead>\n<tr>\n<th scope=\"col\">Placeholder</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>&lt;downloaded_image_directory&gt; </code></td>\n<td>Mandatory.<br/>\n\t\t\tThe directory in which you saved the images that you downloaded. You need to specify this option only if you didn't save the images to the default location (<code>/var/opt/cdf/offline</code>). You can use the <code>-d</code> option multiple times when the images are in different directories. The images can be the images downloaded by the <code>downloadimages.sh</code> script. Make sure the image file type matches the file extension. </td>\n</tr>\n<tr>\n<td><code>&lt;external_repository_URL&gt;</code></td>\n<td>Mandatory.<br/>\n\t\t\tThe URL of the external image repository.</td>\n</tr>\n<tr>\n<td><code>&lt;registry-user&gt;</code></td>\n<td>Mandatory.<br/>\n\t\t\tThe registry user who has the permission to upload images. If you are using a local registry, the value is <code>registry-admin</code>. You don't need to specify the <code>-u</code> option if the external registry supports anonymous upload. The script might prompt you to enter a password if needed.</td>\n</tr>\n<tr>\n<td><code>&lt;key_file&gt;</code></td>\n<td>Optional.<br/>\n\t\t\tThe key file for the external registry.</td>\n</tr>\n</tbody>\n</table>\n<p>You can also set the <code>--cleanup</code> option to delete the image source folder to save disk space. It only works when all images are successfully uploaded.</p>\n<h2><a id=\"Unset-the-proxy\" name=\"Unset-the-proxy\" title=\"Unset the proxy\"></a>Unset the proxy</h2>\n<div>Unset the proxy, after you have completed the download and upload operation:</div>\n<div>\n<pre><code>unset http_proxy\nunset https_proxy</code></pre>\n</div>\n</div>",
  "modifiedon": "2026-01-30 13:52:30"
}