{
  "title": "Uninstall Operations Platform",
  "content": "<div class=\"mw-parser-output\"><div style=\"text-align:start\">You can uninstall the following:​​​​​​</div>\n<div style=\"text-align:start\">\n<ul>\n<li><strong>Uninstall only Operations Platform:</strong> If you want to retain the cluster setup along with OPTIC Management Toolkit (OMT) and uninstall only the platform, you can follow the steps mentioned in the following sections:\n\n\t<ul>\n<li>Uninstall Operations Platform</li>\n<li>Delete the application's external Databases</li>\n</ul>\n</li>\n<li><strong>Uninstall everything:</strong> You may want to uninstall the application and OMT (along with local storage provisioner) and remove the complete cluster. You can follow the steps mentioned in the following sections:\n\t<ul>\n<li>Uninstall Operations Platform</li>\n<li>Delete the application's external Databases</li>\n<li>Uninstall Local storage provisioner, follow the steps mentioned in <a href=\"/doc/423/26.1/402-oplpvuninstall\" target=\"_blank\" title=\"Uninstall local storage provisioner\">Uninstall local storage provisioner</a>.</li>\n<li>Uninstall OMT after you uninstall the application. To uninstall OMT, see <a href=\"/doc/406/25.4/home\" target=\"_blank\" title=\"OMT documentation\">OMT documentation</a>. </li>\n</ul>\n</li>\n</ul>\n<h2><span style=\"font-size: clamp(1.59375rem, 18.7895px + 1.39803vw, 2.125rem);\">Uninstall Operations Platform</span></h2>\n<div>You can uninstall the platform while retaining the OMT install.</div>\n<div>\n<section begin=\"ClearNFSvols\"></section>\n<ol>\n<li>Run the following commands to look up a helm deployment name. <br style=\"box-sizing:border-box\"/>\n\tFor example:\n\t<pre><code># helm list -n &lt;namespace&gt;\nNAME                    NAMESPACE       REVISION        UPDATED                                 STATUS          CHART                               APP VERSION\ndeployment01            opsplatform       2             2025-03-10 18:22:15.28736276 -0700 PDT  deployed        op-chart-1.2.0+25.2.0-71            25.2.0-71</code></pre>\n</li>\n<li><font face=\"Inter, OpenText Sans\">Uninstall the application using the following command:</font>\n<pre><code>helm uninstall &lt;deployment name&gt; -n &lt;namespace&gt; --no-hooks </code></pre>\n<br style=\"box-sizing:border-box\"/>\n<font face=\"Inter, OpenText Sans\">This command uninstalls all Kubernetes resources of the application. For example, secrets, persistent volume claims, and config maps</font><font face=\"Inter, OpenText Sans\">.</font><br/>\n<font face=\"Inter, OpenText Sans\">For example, to</font> <font face=\"Inter, OpenText Sans\">uninstall or delete a deployment  </font><font face=\"monospace\"><font style='font-family:Inter, \"OpenText Sans\"'><font style=\"box-sizing:border-box\">deployment01:</font></font></font>\n<pre><code>helm uninstall deployment01 -n opsplatform --no-hooks</code></pre>\n</li>\n<li> Run the following command to delete the PVCs:\n\t<pre><code>kubectl delete pvc -n &lt;namespace&gt; --all</code></pre>\n</li>\n<li>Run the following command to delete the application Persistent Volumes:\n\t<pre><code>kubectl delete pv &lt;application pv names&gt;</code></pre>\n<p class=\"Admonition_Tip\" style=\"padding:0px\"><span style=\"font-size:14px\"><span style=\"box-sizing:border-box\"><span style=\"line-height:1.375rem\"><span style=\"font-weight:400\"><span style=\"color:currentcolor\"><span style=\"overflow-wrap:break-word\"><span style=\"display:block\"><span style=\"margin-block:1em\"><span style=\"margin-inline:0px\">If the PV deletion fails to complete and is in \"<code style='box-sizing:border-box; font-family:Consolas, Menlo, \"DejaVu Sans Mono\", \"Liberation Mono\", monospace; font-size:0.875rem; background-color:#e1e8f6; color:#333333; font-weight:400; padding:0.1em 0.2em; overflow-wrap:break-word; white-space:pre-wrap; border-radius:3px'>terminating</code>\" state, execute the following command:</span></span></span></span></span></span></span></span></span></p>\n<pre><code>kubectl patch pv &lt;persistent-volume-name&gt; -p '{\"metadata\":{\"finalizers\":null}}' -n &lt;namespace&gt;</code></pre>\n<p style=\"padding:0px\"><span style=\"font-size:14px\"><span style=\"box-sizing:border-box\"><span style=\"line-height:1.375rem\"><span style=\"font-weight:400\"><span style=\"color:currentcolor\"><span style=\"overflow-wrap:break-word\"><span style=\"display:block\"><span style=\"margin-block:1em\"><span style=\"margin-inline:0px\">Again try deleting PVs.</span></span></span></span></span></span></span></span></span></p>\n</li>\n<li>Run the following command to delete the namespace:\n\t<pre><code>kubectl delete ns &lt;namespace&gt;</code></pre>\n</li>\n<li>Log on to the NFS server host as root and delete the content in the application NFS volume directory: <br style=\"box-sizing:border-box\"/>\n<code>&lt;NFS&gt;/&lt;application pv name&gt;/*</code><br/>\n<br style=\"box-sizing:border-box\"/>\n\tFor example:\n\t<pre><code>rm -rf /var/vols/itom/&lt;application pv names&gt;/*</code></pre>\n\tFor AWS, run the following commands on the bastion node:\n\n\t<pre><code>rm -rf /mnt/efs/var/vols/itom/&lt;application pv name&gt;/*</code></pre>\n<code>rm -rf</code> command will remove all the data and configuration files in that specified folder without prompting for confirmation.  If required, take a backup before executing this command.<br style=\"box-sizing:border-box\"/>\n<i style=\"box-sizing:border-box\">In the case of manually set up AWS infrastructure</i>, you must delete the <strong style=\"box-sizing:border-box; font-weight:600; font-family:Inter !important\">EFS</strong> and the bastion stack manually.</li>\n</ol>\n<h2>​<span style=\"color: rgb(22, 22, 22); font-size: clamp(1.59375rem, 18.7895px + 1.39803vw, 2.125rem);\">Delete the application external Databases</span></h2>\n</div>\n<p>Clear the external databases. RemoveSQL.sql script doesn't remove the OMT database <code>cdfidmdb</code>. It will remove application specific databases: idm, autopass, and bvd.  OMT database <code>cdfidmdb</code> is removed as part of uninstalling OMT.  For more information, see Uninstall OMT in OMT documentation.</p>\n<h3><strong>Delete the application user and databases for PostgreSQL</strong></h3>\n<p>To delete the databases, use one of the following:</p>\n<div><strong>The <code>RemoveSQL.sql</code> command:</strong></div>\n<ul>\n<li>Copy the <code>RemoveSQL.sql</code> to the database server. \n\n\t<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">For AWS or Azure deployments, the <code>RemoveSQL.sql</code> script is available in the same directory where you had run the  <code>./DBSQLGenerator.sh</code> script while deploying the application. You must run the script from the same directory.</div>\n</div>\n</li>\n<li>Run the following command if you want to remove the users and databases created by the script:<br/>\n<code>psql -f RemoveSQL.sql</code>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">Run the following commands on AWS and Azure environments:<br/>\n<br/>\n\tFor AWS: <code>psql -h &lt;DB_HOSTNAME&gt; -U &lt;db admin&gt; -d &lt;database name&gt; -f RemoveSQL.sql</code><br/>\n<br/>\n\tFor Azure: <code>psql -h &lt;DB_HOSTNAME&gt; -U &lt;db admin&gt;@&lt;DB_HOSTNAME&gt; -d &lt;database name&gt; -f RemoveSQL.sql</code></div>\n</div>\n</li>\n</ul>\n<p><strong>Or, run the following SQL statements manually:</strong></p>\n<ul>\n<li>Log in to a server that can run the command and run the following command to connect to the external database.  \n\t<pre><code>psql -h &lt;external postgresql host or ip&gt; -U &lt;pg_admin_username&gt; -W</code></pre>\n<div>where:<br/>\n\t&lt;external postgresql host or ip&gt; is the FQDN or IPv4 address of the external PostgreSQL database server.<br/>\n\t&lt;pg_admin_username&gt; is the database administrator.<br/>\n\t </div>\n</li>\n<li>\n<div>Delete the databases:\n\t<pre><code>DROP DATABASE idm;\nDROP DATABASE autopass;\nDROP DATABASE bvd;\n</code></pre>\n</div>\n</li>\n</ul>\n<h3><strong style=\"color: rgb(22, 22, 22); font-size: clamp(1.3125rem, 15.4737px + 1.15132vw, 1.75rem);\">Clear the Vertica database</strong></h3>\n<div>It is recommended to run the delete tenants command using the op-tms-cli tool, as this cleans up your Vertica database by deleting the tenant specific read-only/read-write users, resource pools, and drops the <code>pulsar udx</code> library.</div>\n<p><span style=\"font-size:inherit !important\"><span style=\"font-weight:400\"><span style=\"font-style:normal\"><span style=\"line-height:inherit !important\"><span style=\"letter-spacing:0.2px\">To clean up the Vertica database and uninstall the OPTIC DL Vertica Plugin:</span></span></span></span></span></p>\n<ol start=\"1\">\n<li>On the Vertica system, log in as a database administrator user.</li>\n<li>Run the following queries to clean up the schemas:\n\t<pre style=\"border:1px solid #eaecf0; text-align:left; padding:1em; border-radius:unset\"><span style=\"font-size:14px !important\"><span style=\"background:#f8f9fa\"><span style='font-family:Monaco, Consolas, \"Andale Mono\", \"Ubuntu Mono\", monospace'><span style=\"white-space:pre\"><span style=\"word-spacing:normal\"><span style=\"word-break:normal\"><span style=\"overflow-wrap:normal\"><span style=\"line-height:1.5\"><span style=\"tab-size:4\"><span style=\"hyphens:none\"><span style=\"overflow:auto\"><span style=\"position:relative\"><span style=\"counter-reset:linenumber 0\"><span style=\"min-height:24px\"><span style=\"color:#000000\">DROP SCHEMA IF EXISTS </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>itom_di_dbinit_provider_default<span style=\"font-size:14px !important\"><span style=\"background:#f8f9fa\"><span style='font-family:Monaco, Consolas, \"Andale Mono\", \"Ubuntu Mono\", monospace'><span style=\"white-space:pre\"><span style=\"word-spacing:normal\"><span style=\"word-break:normal\"><span style=\"overflow-wrap:normal\"><span style=\"line-height:1.5\"><span style=\"tab-size:4\"><span style=\"hyphens:none\"><span style=\"overflow:auto\"><span style=\"position:relative\"><span style=\"counter-reset:linenumber 0\"><span style=\"min-height:24px\"><span style=\"color:#000000\"> CASCADE;\nDROP SCHEMA IF EXISTS </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>itom_di_tenant_management_difarm_default<span style=\"font-size:14px !important\"><span style=\"background:#f8f9fa\"><span style='font-family:Monaco, Consolas, \"Andale Mono\", \"Ubuntu Mono\", monospace'><span style=\"white-space:pre\"><span style=\"word-spacing:normal\"><span style=\"word-break:normal\"><span style=\"overflow-wrap:normal\"><span style=\"line-height:1.5\"><span style=\"tab-size:4\"><span style=\"hyphens:none\"><span style=\"overflow:auto\"><span style=\"position:relative\"><span style=\"counter-reset:linenumber 0\"><span style=\"min-height:24px\"><span style=\"color:#000000\"> CASCADE;\n</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</li>\n<li>You can <strong>delete a tenant</strong> using <code>dbinit.sh</code> script:\n\t<div class=\"admonition\">\n<p class=\"admonition-content admonition-important-content\">If you delete tenants it will drop read-only/read-write users, resource pools and drop the <code>pulsar udx</code> library, you can then skip the next steps 4, 5, and 6. </p>\n</div>\n<pre><code>cd /usr/local/itom-di-pulsarudx/bin\n./dbinit.sh delete</code></pre>\n</li>\n<li>Run the following queries to drop read-only/read-write users:\n\t<pre style=\"border:1px solid #eaecf0; text-align:left; padding:1em; border-radius:unset\"><span style=\"font-size:14px !important\"><span style=\"background:#f8f9fa\"><span style='font-family:Monaco, Consolas, \"Andale Mono\", \"Ubuntu Mono\", monospace'><span style=\"white-space:pre\"><span style=\"word-spacing:normal\"><span style=\"word-break:normal\"><span style=\"overflow-wrap:normal\"><span style=\"line-height:1.5\"><span style=\"tab-size:4\"><span style=\"hyphens:none\"><span style=\"overflow:auto\"><span style=\"position:relative\"><span style=\"counter-reset:linenumber 0\"><span style=\"min-height:24px\"><span style=\"color:#000000\">DROP USER IF EXISTS &lt;rw_user&gt; CASCADE;\nDROP USER IF EXISTS &lt;ro_user&gt; CASCADE;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</li>\n<li>Run the following queries to drop the resource pool:\n\t<pre><code>DROP RESOURCE POOL itom_di_postload_respool_provider_default;\nDROP RESOURCE POOL itom_di_rouser_respool_provider_default;\nDROP RESOURCE POOL itom_di_stream_respool_provider_default;\nDROP RESOURCE POOL itom_di_aecbackground_respool_provider_default;\nDROP RESOURCE POOL itom_di_monitoring_respool_provider_default;</code></pre>\n</li>\n<li>Run the following command to drop the <code>pulsar udx</code> library:\n\t<pre style=\"border:1px solid #eaecf0; text-align:left; padding:1em; border-radius:unset\"><span style=\"font-size:14px !important\"><span style=\"background:#f8f9fa\"><span style='font-family:Monaco, Consolas, \"Andale Mono\", \"Ubuntu Mono\", monospace'><span style=\"white-space:pre\"><span style=\"word-spacing:normal\"><span style=\"word-break:normal\"><span style=\"overflow-wrap:normal\"><span style=\"line-height:1.5\"><span style=\"tab-size:4\"><span style=\"hyphens:none\"><span style=\"overflow:auto\"><span style=\"position:relative\"><span style=\"counter-reset:linenumber 0\"><span style=\"min-height:24px\"><span style=\"color:#000000\">/opt/vertica/bin/vsql -U &lt;dbadmin user&gt; -f /usr/local/itom-di-pulsarudx/sql/uninstall.sql</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</li>\n<li>Run the following command as the root user to uninstall the OPTIC DL Vertica Plugin RPM<font face=\"monospace\">:</font>\n<pre style=\"border:1px solid #eaecf0; text-align:left; padding:1em; border-radius:unset\"><span style=\"font-size:14px !important\"><span style=\"background:#f8f9fa\"><span style='font-family:Monaco, Consolas, \"Andale Mono\", \"Ubuntu Mono\", monospace'><span style=\"white-space:pre\"><span style=\"word-spacing:normal\"><span style=\"word-break:normal\"><span style=\"overflow-wrap:normal\"><span style=\"line-height:1.5\"><span style=\"tab-size:4\"><span style=\"hyphens:none\"><span style=\"overflow:auto\"><span style=\"position:relative\"><span style=\"counter-reset:linenumber 0\"><span style=\"min-height:24px\"><span style=\"color:#000000\">rpm -e itom-di-pulsarudx-&lt;version&gt;.x86_64</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>\n</li>\n<li>Restart the database from the Vertica <code>admintools</code>. </li>\n</ol>\n<div>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">Embedded Vertica database is cleared when you uninstall Operations Platform. </div>\n</div>\n</div>\n</div>\n</div>",
  "modifiedon": "2026-01-30 14:51:17"
}