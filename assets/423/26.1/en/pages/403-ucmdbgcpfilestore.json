{
  "title": "Subscribe Cloud Filestore",
  "content": "<div class=\"mw-parser-output\"><br/><table>\n<tbody>\n<tr>\n<th>Role</th>\n<th>Location</th>\n</tr>\n<tr>\n<td>Storage administrator</td>\n<td>GCP Console</td>\n</tr>\n</tbody>\n</table>\n<p>This topic describes how to use Google's Filestore storage service to store the OMT and UD/UCMDB data on GCP. </p>\n<p>Filestore stores data attachments, certificates, and logs used by containerized applications in Kubernetes. It serves as the backend storage for <code>data-volume</code>,<code>config-volume</code>, and <code>logging-volume</code>. </p>\n<h2>Configure NFS volumes</h2>\n<table>\n<tbody>\n<tr>\n<th>Role</th>\n<th>Location</th>\n</tr>\n<tr>\n<td>Storage administrator</td>\n<td>Bastion node</td>\n</tr>\n</tbody>\n</table>\n<p>Once the Filestore instance is ready, log on to the bastion and set up the NFS volumes to store global data, Smart Analytics data, and database data of the UD/UCMDB. To set up the NFS volumes, follow these steps:</p>\n<ol>\n<li>Copy the following script content and save it as <code>configureFilestore.sh</code>:\n\n\t<pre><code>#!/bin/bash\nif [ $# -lt 1 ]; then\n    echo \"Usage: $0 \"\n    exit 1\nfi\nCURRENTDIR=$(cd \"$(dirname \"$0\")\";pwd)\nfs_server=$1\nfile_share_name=$2\nsuite_user_uid=$3\nsuite_user_gid=$4\nmount_point=/mnt/uducmdb\nif [ ! -d $mount_point ]; then\n    sudo mkdir -p $mount_point\nfi\nexport TIMEOUT_FOR_SERVICES=120\nmountFS() {\n    local n=0\n    while :; do\n        n=$(($n + 1))\n        if [[ $n -ge $TIMEOUT_FOR_SERVICES ]]; then\n            echo \"check timeout for mount Filestore\"\n            exit 1\n        fi\n        returnCode=`sudo mount -t nfs -o vers=3 $fs_server:/$file_share_name $mount_point`\n        if [[ $returnCode -eq 0 ]] || [[ $returnCode -eq 32 ]]; then\n            echo \"Successfully mount Filestore\"\n            sudo sed -i '$a\\'\"$fs_server:/$file_share_name $mount_point nfs -o vers=3 0 0 \" /etc/fstab\n            break\n        fi\n        sleep 15\n    done\n}\nmake_volume() {\n    local volume=$1\n    cd $mount_point\n    local mounted_pv=${mount_point}${volume}\n    if [ ! -d $mounted_pv ]; then\n        sudo mkdir -p $mounted_pv\n    fi\n    chown -R $suite_user_uid:$suite_user_gid $mounted_pv\n    chmod g+w $mounted_pv\n    chmod g+s $mounted_pv\n    echo \"Successfully make volume: ${volume}\"\n}\nmountFS\nmake_volume /var/vols/itom/ucmdb/data_volume \nmake_volume /var/vols/itom/ucmdb/conf_volume \nmake_volume /var/vols/itom/ucmdb/log_volume\necho \"Finish making all volumes Successfully.\"\ncd ${CURRENTDIR}</code></pre>\n</li>\n<li>Run the following command to configure the Filestore volumes:\n\t<pre>sudo ./configureFilestore.sh &lt;<em>filestore_ip_address</em>&gt; &lt;<em>fileshare_name</em>&gt; &lt;<em>system_user_id</em>&gt; &lt;<em>system_group_id</em>&gt;\n</pre>\n\tFor example,\n\n\t<pre>sudo ./configureFilestore.sh 10.180.97.66 uducmdb 1999 1999</pre>\n\tWhere:\n\n\t<ul>\n<li>&lt;<code><em>filestore_ip_address</em>&gt;</code><strong> </strong>and <code>&lt;<em>fileshare_name</em>&gt;</code><strong> </strong>are the IP address and name of the Filestore. You can find it on the Filestore list page.</li>\n<li><code>&lt;<em>system_user_id</em>&gt;</code><strong> </strong>and<strong> </strong><code>&lt;<em>system_group_id</em>&gt;</code><strong> </strong>are the operating system user ID and group ID that are used to run the process in the container. Both values must be 1999 or a number between 100000 and 2000000000 (for example, UID=100001 and GID=100002).</li>\n</ul>\n</li>\n</ol>\n<h2>External references</h2>\n<p>For details on Filestore, see <a class=\"external text\" href=\"https://cloud.google.com/filestore/docs\" rel=\"nofollow\" target=\"1\" title=\"Cloud Filestore\">Filestore</a>.</p>\n</div>",
  "modifiedon": "2025-10-24 08:51:12"
}