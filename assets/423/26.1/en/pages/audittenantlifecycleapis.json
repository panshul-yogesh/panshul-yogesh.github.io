{
  "title": "Audit tenant lifecycle APIs",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>This section describes how Suite Administration can use the Audit APIs to create and delete tenants in the Audit service.</p>\n<h2>Audit tenant lifecycle APIs</h2>\n<p>Suite Administration helps to create and manage tenants. During tenant management, Suite Administration makes the following Audit API calls to create a tenant and a tenant schema in Audit service and to delete a tenant and its schema from the Audit service:</p>\n<ul>\n<li>Create tenant in Audit</li>\n<li>Delete tenant in Audit</li>\n</ul>\n<p>To generate the X-Auth-Token for the aforementioned API calls, make the following POST call: </p>\n<table resolved=\"\">\n<tbody>\n<tr>\n<td>\n<p><strong>URI</strong></p>\n</td>\n<td><code>https://{{IdmHost}}:{{IdmPort}}/idm-service/v3.0/tokens</code></td>\n</tr>\n<tr>\n<td>\n<p><strong>HTTP Method</strong></p>\n</td>\n<td>\n<p>POST</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><strong>Request Body</strong></p>\n</td>\n<td>\n<pre>{\n\n\"tenantName\" : \"sysbo\", \n\n\"passwordCredentials\" : {\"username\" : \"suite-admin\", \"password\" : \"password\"}\n\n}\n</pre>\n</td>\n</tr>\n<tr>\n<td><strong>Response</strong></td>\n<td>\n<pre>  {\n\n    \"passwordExpiredDate\": 1667918387772,\n\n    \"passwordComplianceCheckCode\": \"PASSWORD_COMPLIANT\",\n\n    \"token\": {\n\n        \"id\": \"eyJ0eXAiOiJKV1MiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIyYzkwODE5NjgyODgzMjNiMDE4Mjg4MzI4MjY1MDFmZiIsInBhdCI6bnVsbCwiaXNzIjoiSWRNIDEuMzYuMC1idWlsZC4xODYiLCJjb20uaHBlLmlkbTp0cnVzdG9yIjpudWxsLCJleHAiOjE2NjE4NDU4NDQsImNvbS5ocC5jbG91ZDp0ZW5hbnQiOnsiaWQiOiIyYzkwODE5NjgyODgzMjNiMDE4Mjg4MzI3NWYyMDEzZSIsIm5hbWUiOiJzeXNibyIsImVuYWJsZWQiOnRydWV9LCJwcm4iOiJzdWl0ZS1hZG1pbiIsImlhdCI6MTY2MTg0MjI0NCwianRpIjoiMmQ2Y2NiZDgtNzQyZC00ZGRiLWJhYjctMWVlNzM2YjZmOTc2In0.vRNeyuSjH49-AcB24o2QE1CshYFn5Tto6jTps7vtg-c\",\n\n        \"issued_at\": \"2022-08-30T06:50:44.214Z\",\n\n        \"expires\": \"2022-08-30T07:50:44.000Z\",\n\n        \"tenant\": {\n\n            \"id\": \"2c9081968288323b0182883275f2013e\",\n\n            \"name\": \"sysbo\",\n\n            \"enabled\": true\n\n        }\n\n    }...\n    </pre>\n</td>\n</tr>\n</tbody>\n</table>\n<h2>Create tenant in Audit</h2>\n<table resolved=\"\">\n<tbody>\n<tr>\n<td>\n<p><strong>API Name</strong></p>\n</td>\n<td>Create tenant in Audit</td>\n</tr>\n<tr>\n<td>\n<p><strong>Description</strong></p>\n</td>\n<td>\n<p>Suite Administration makes this Audit API call to create a new tenant and a tenant schema in Audit service. You need to make this API call before enabling audit for exisiting tenants.</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><strong>URI</strong></p>\n</td>\n<td><code>https://&lt;audit service host&gt;:&lt;audit service port&gt;/audit-service-engine/v1/tenants</code></td>\n</tr>\n<tr>\n<td>\n<p><strong>URI Parameters</strong></p>\n</td>\n<td>NA</td>\n</tr>\n<tr>\n<td>\n<p><strong>HTTP Method</strong></p>\n</td>\n<td>\n<p>POST</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><strong>Request Headers</strong></p>\n</td>\n<td>\n<p><code>X-Auth-Token: &lt;X-Auth-Token&gt; </code>Generate the <code>X-Auth-Token</code> for a user who has SUPER_IDM_ADMIN and CREATE_AUDIT permissions.<br/>\n<code>Content-Type: application/json</code></p>\n</td>\n</tr>\n<tr>\n<td>\n<p><strong>Request Body format</strong></p>\n</td>\n<td><code>Accept: application/json</code></td>\n</tr>\n<tr>\n<td>\n<p><strong>Request body data</strong></p>\n</td>\n<td>\n<pre>{\n\n                           \"id\": \"&lt;TENANT_ID&gt;\", ID of the tenant that you want to create in Audit.\n\n                           \"tenantId\": \"&lt;TENANT_ID&gt;\", ID of the tenant that you want to create in Audit. \n\n                           \"idmOrgName\": \"&lt;IDM_ORG_NAME&gt;\", same as tenantId, as tenant ID is equal to the org name in IdM.\n\n                           \"tenantName\": \"&lt;TENANT_NAME&gt;\", ID of the tenant that you want to create in Audit.\n\n                           \"tenantAdmin\": \"&lt;TENANT_Admin&gt;\", Admin for the tenant that gets created.\n\n}</pre>\n</td>\n</tr>\n<tr>\n<td><strong>Request example</strong></td>\n<td>\n<pre>{\n\n                           \"id\": \"34567834\",\n\n                           \"tenantId\": \"34567834\",\n\n                           \"idmOrgName\": \"34567834\",\n\n                           \"tenantName\": \"34567834\",\n\n                           \"tenantAdmin\": \"34567834tenantAdmin\" Admin for the tenant that gets created\n\n}</pre>\n</td>\n</tr>\n<tr>\n<td>\n<p><strong>Response format</strong></p>\n</td>\n<td>\n<p>application/json</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><strong>HTTP return codes</strong></p>\n</td>\n<td>\n<p>200 - OK (Tenant creation is successful)<br/>\n\t\t\t401 - Unauthorized (Authorization failed)<br/>\n\t\t\t409 - Tenant already exists<br/>\n\t\t\t500 - Internal server error</p>\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">The Audit service installation creates the schemas for out-of-the-box tenants and IdM when you install the Audit service for the first time. For Service Management, the Audit service considers '\"SYSBO\" and some internal tenants as the out-of-the-box tenants. For IdM, Audit service considers \"PROVIDER\" as the out-of-the-box tenant.</div>\n</div>\n<h2>Delete tenant in Audit</h2>\n<table resolved=\"\">\n<tbody>\n<tr>\n<td>\n<p><strong>API Name</strong></p>\n</td>\n<td>Delete tenant in Audit</td>\n</tr>\n<tr>\n<td>\n<p><strong>Description</strong></p>\n</td>\n<td>\n<p>Deletes a tenant in Audit</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><strong>URI</strong></p>\n</td>\n<td><code>https://&lt;audit service host&gt;:&lt;audit service port&gt;/audit-service-engine/v1/tenants/&lt;tenant id&gt;</code></td>\n</tr>\n<tr>\n<td>\n<p><strong>URI Parameters</strong></p>\n</td>\n<td>NA</td>\n</tr>\n<tr>\n<td>\n<p><strong>HTTP Method</strong></p>\n</td>\n<td>\n<p>DELETE</p>\n</td>\n</tr>\n<tr>\n<td>\n<p><strong>Request Headers</strong></p>\n</td>\n<td>\n<p><code>X-Auth-Token: &lt;X-Auth-Token&gt;</code> Generate the <code>X-Auth-Token</code> for a user who has SUPER_IDM_ADMIN and DELETE_AUDIT permissions.<br/>\n<code>Content-Type: application/json<br/>\n\t\t\tAccept: application/json</code></p>\n</td>\n</tr>\n<tr>\n<td>\n<p><strong>HTTP return codes</strong></p>\n</td>\n<td>\n<p>200 - OK (Tenant deletion is successful)<br/>\n\t\t\t401 - Unauthorized (Authorization failed)<br/>\n\t\t\t404 - Tenant not found<br/>\n\t\t\t500 - Internal server error</p>\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">If you make the <strong>Delete tenant in audit</strong> API call, it takes 5 days for the removal of the tenant data from the Audit database (DB). During this time, if you try to create a tenant with the same tenant ID, you will see a message \"Tenant already exists\". </div>\n</div>\n<h3>Delete tenant scenario</h3>\n<p>If you make the <strong>Delete tenant in audit</strong> API call to delete a tenant but later want to undo the tenant deletion, in the Audit DB, remove the tenant entry from the <strong>audit_tenant_meta</strong> table using the following command. This will stop the tenant deletion:</p>\n<pre>DELETE FROM audit_tenant_meta WHERE tenant_id=&lt;Tenant_Id&gt; and audit_tenant_status='DELETE'</pre>\n<h2>Related topic</h2>\n<p>For Audit tenant lifecycle API failure scenarios, see <a href=\"/doc/423/26.1/audittenantcreationfail\" title=\"Create Tenant in Audit API fails\">Troubleshoot</a>.</p>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}