{
  "title": "Use the BI integration API to create reports (deprecated)",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><h2>Use case</h2>\n<p>Your organization wants a report in Excel format that lists all the users and all of the groups they belong to.</p>\n<p>The data you need to include in the BI sync, to report on groups and group memberships, is:</p>\n<ul>\n<li><b>Person</b> - ID, Name, Group members</li>\n<li><b>Group</b> - ID, Name</li>\n</ul>\n<p>You need to take the following steps:</p>\n<h3 id=\"If_not_already_done,_enable_BI_sync_on_the_tenant\"><span class=\"mw-headline\" id=\"If_not_already_done.2C_enable_BI_sync_on_the_tenant\">If not already done, enable BI sync on the tenant</span></h3>\n<p>From the <span class=\"SAW_VariablesMain_menu_Starter\">Main menu</span>, select <b>Administration &gt; Utilities &gt; Integration</b>, and then select <b>BI Integration</b>.</p>\n<h3 class=\"mw-headline\" id=\"Add_the_required_record_types_and_fields\">Add the required record types and fields</h3>\n<p>In BI integration:</p>\n<ol>\n<li>Select the following record types:\n\t<ul>\n<li>Group</li>\n<li>Person</li>\n</ul>\n</li>\n<li>For the record type <b>Group</b>, add the following fields:\n\t<ul>\n<li>ID</li>\n<li>Name</li>\n</ul>\n</li>\n<li>For the record type <b>Person</b>, add the following fields:\n\t<ul>\n<li>ID</li>\n<li>Name</li>\n<li>Group members (from the <b>Person many to many relationships</b> section)</li>\n</ul>\n</li>\n<li>Save your changes.</li>\n</ol>\n<h3 class=\"mw-headline\" id=\"Execute_the_REST_call\">Run the REST call</h3>\n<p>While logged in to Service Management Automation:</p>\n<ol>\n<li>\n<p>Launch a REST client such as Postman.</p>\n</li>\n<li>\n<p>Run the REST call to run the BI sync job.</p>\n<p><a class=\"image\" href=\"/file/images/8/85/2018.08_Helpcenter/Resources/Images/Platform/bi-sync-1.png\" title=\"/file/images/8/85/2018.08_Helpcenter/Resources/Images/Platform/bi-sync-1.png\"> <img alt=\"Execution of the REST call to run the BI sync job\" data-file-height=\"746\" data-file-width=\"1009\" height=\"746\" src=\"../../../images/bi-sync-1_0a65a126.png\" width=\"1009\"/> </a></p>\n</li>\n<li>\n<p>Using the <b>SyncId</b> from the call, run the REST call to retrieve the status and file names created by the BI sync job.</p>\n<p><a class=\"image\" href=\"/file/images/a/aa/2018.08_Helpcenter/Resources/Images/Platform/bi-sync-2.png\" title=\"/file/images/a/aa/2018.08_Helpcenter/Resources/Images/Platform/bi-sync-2.png\"> <img alt=\"Execution of the REST call to retrieve the status and file names\" data-file-height=\"825\" data-file-width=\"991\" height=\"825\" src=\"../../../images/bi-sync-2_9d473134.png\" width=\"991\"/> </a></p>\n</li>\n<li>\n<p>There will be several files. Record the names of all the files.</p>\n</li>\n<li>\n<p>Open another tab in the browser.</p>\n</li>\n<li>\n<p>For each file, enter the following URL:</p>\n<pre>&lt;your Service Management Automation domain&gt;/rest/&lt;TenantID&gt;/frs/file-list/&lt;FileId&gt;</pre>\n<p>A file download starts. The file name format is <b>&lt;record_type&gt;.zip</b>.</p>\n</li>\n<li>\n<p>Repeat for each of the <b>FileId</b> values obtained in the status REST call.</p>\n</li>\n</ol>\n<h3 class=\"mw-headline\" id=\"Load_the_data_into_Excel\">Load the data into Excel</h3>\n<p>Navigate to where the downloaded files are, and unzip them. On completion of the preceding steps, there are the following files:</p>\n<p><a class=\"image\" href=\"/file/images/3/3d/2018.08_Helpcenter/Resources/Images/Platform/bi-sync-4.png\" title=\"/file/images/3/3d/2018.08_Helpcenter/Resources/Images/Platform/bi-sync-4.png\"> <img alt=\"Downloaded files\" data-file-height=\"311\" data-file-width=\"642\" height=\"311\" src=\"../../../images/bi-sync-4_828a09a1.png\" width=\"642\"/> </a></p>\n<ol>\n<li>\n<p>Open each of the files and save them as Excel files.</p>\n</li>\n<li>\n<p>Open the file PersonToGroup. This file stores the relationships between people and groups.</p>\n</li>\n<li>\n<p>After the <b>SecondEntity_PersonGroup</b> column, add these new columns:</p>\n<ul>\n<li>\n<p>Group Name</p>\n</li>\n<li>\n<p>Person Name</p>\n</li>\n</ul>\n</li>\n<li>\n<p>In the <b>Group Name</b> field paste the following formula:</p>\n<pre> =VLOOKUP(D2,PersonGroup_0!C$2:D$800,2,FALSE) </pre>\n<p>When you save the formula a file selector opens. Select the <b>Person_group_0.xlsx</b> file created above.</p>\n</li>\n<li>\n<p>In the <b>Person Name</b> field paste the following formula:</p>\n<pre> =VLOOKUP(C2, Person_0!C$2:D$800,2,FALSE)</pre>\n<p>When the file selector window opens, select the <b>Person_0.xlsx</b> file created above.</p>\n<div class=\"Admonition_Note\">\n<p><span class=\"autonumber\">Note</span> You should replace the <b>800</b> in the formulas above with the total number of rows in the referenced spreadsheet.</p>\n</div>\n<p>In excel it should look like the following:</p>\n<p><a class=\"image\" href=\"/file/images/1/1b/2018.08_Helpcenter/Resources/Images/Platform/bi-sync-5.png\" title=\"/file/images/1/1b/2018.08_Helpcenter/Resources/Images/Platform/bi-sync-5.png\"> <img alt=\"Downloaded data\" data-file-height=\"317\" data-file-width=\"992\" height=\"317\" src=\"../../../images/bi-sync-5_516953d2.png\" width=\"992\"/> </a></p>\n</li>\n<li>\n<p>Copy the formula for columns E and F for all entries, and add a filter to the top row.</p>\n<p>It's now possible to filter on group or person and see all of the associated values.</p>\n</li>\n</ol>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}