{
  "title": "Can't change the encryption key for LWSSO tokens",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>Unable to change the encryption key for the Lightweight SSO token.</p>\n<h2>Cause</h2>\n<p>IdM doesn't have write permission for Suite Administration.</p>\n<h2>Solution</h2>\n<p>Add the missing write permission as follows:</p>\n<ol>\n<li>\n<p>Log in to a control plane node of the suite, and then run the following command:</p>\n<pre>kubectl get namespace | grep itsma</pre>\n</li>\n<li>\n<p>Take note of the returned namespace.</p>\n</li>\n<li>\n<p>Open a REST client such as Postman.</p>\n</li>\n<li>\n<p>Send the following <strong>POST</strong> request to get the <code>X-AUTH-TOKEN</code>.</p>\n<ul>\n<li>\n<p>URL</p>\n<pre>https://&lt;FQDN&gt;:5443/suiteInstaller/urest/v1.1/tokens</pre>\n</li>\n<li>\n<p>Header</p>\n<pre>Content-Type: application/json</pre>\n</li>\n<li>\n<p>Body (replace with the password for the <code>admin</code> user below)</p>\n<pre><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"passwordCredentials\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"username\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"password\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"password_for_admin,\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"tenantName\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"provider\"</span>\n<span class=\"token punctuation\">}</span></code></pre>\n</li>\n</ul>\n</li>\n<li>\n<p>Take note of the <code>token</code> value in the response body.</p>\n</li>\n<li>\n<p>Send the following <strong>GET</strong> request to get the <code>X-CSRF-TOKEN</code>.</p>\n<ul>\n<li>\n<p>URL</p>\n<pre>https://&lt;FQDN&gt;:5443/suiteInstaller/urest/v1.1/csrf-token</pre>\n</li>\n<li>\n<p>Header</p>\n<pre>X-AUTH-TOKEN: &lt;the token obtained from step 5&gt;</pre>\n</li>\n</ul>\n</li>\n<li>Take note of the <code>csrfToken</code> value in the response body.</li>\n<li>\n<p>Send the following <strong>GET</strong> request to get the <code>deploymentUuid</code>.</p>\n<ul>\n<li>\n<p>URL</p>\n<pre>https://&lt;FQDN&gt;:5443/suiteInstaller/urest/v1.1/deployment?deploymentStatus=INSTALL_FINISHED</pre>\n</li>\n<li>\n<p>Header</p>\n<pre>X-AUTH-TOKEN: &lt;the token obtained from step 5&gt;</pre>\n</li>\n</ul>\n</li>\n<li>\n<p>Take note of the <code>deploymentUuid</code> value in the response body.</p>\n</li>\n<li>\n<p>Send the following <strong>POST</strong> request to add the missing write permission.</p>\n<ul>\n<li>\n<p>URL (replace <code>deploymentUuid</code> in curly braces with the value obtained from step 9)</p>\n<pre>https://&lt;FQDN&gt;:5443/suiteInstaller/urest/v1.1/deployment/{deploymentUuid}/vault/extendapproles</pre>\n</li>\n<li>\n<p>Header</p>\n<pre>Content-Type: application/json\n</pre>\n<pre>X-AUTH-TOKEN: &lt;the token obtained from step 5&gt;\n</pre>\n<pre>X-CSRF-TOKEN: &lt;the token obtained from step 7&gt;\n</pre>\n</li>\n<li>\n<p>Body (replace the value for <code>vaultNamespace</code> with the value obtained from step 2)</p>\n<pre><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"vaultNamespace\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Replace_value\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"appRoleExtendList\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"appRole\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"itom-idm\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"readOnlyRoles\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"itom-cgro,itom-dnd-platform,itom-cmp,itom-itsma-config,itom-xruntime-infra,itom-xruntime,itom-pgha,itom-autopass,itom-smartanalytics,itom-itsma-certificate\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"readWriteRoles\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"itom-bo\"</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>    \n<span class=\"token punctuation\">}</span></code></pre>\n</li>\n</ul>\n<p>If you get a response with status code <code>201</code> and you can find <code>\"appRoleStatus\": \"SUCCESS\"</code> in the response body, then the permission is successfully added.</p>\n</li>\n</ol>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}