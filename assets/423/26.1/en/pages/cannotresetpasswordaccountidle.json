{
  "title": "Admin user can't log in to the Management Portal after resetting an expired password",
  "content": "<div class=\"mw-parser-output\"><span class=\"snippet-start\" data-sname=\"423-25.4-423-25.3-CannotResetPasswordAccountIdle||N\"></span><p class=\"mw-empty-elt\">\n</p><p>After the OMT IdM admin user resets an expired password by using the password reset link on the login page, they still can't log in. The following error message is displayed:</p>\n<pre><code>Invalid user name/password or user account is locked or expired</code></pre>\n<h2>Cause</h2>\n<p>The issue occurs when the OMT IdM admin user's password has expired for a longer time than the idle period (the number of days that a user may not log in before their account is disabled). In this situation, the admin user can no longer reset their password by using the password reset link on the login page. </p>\n<p>The default idle period in IdM is 90 days.</p>\n<h2>Solution</h2>\n<p>As the admin user, log in to one of the control plane nodes and follow one of these solutions.</p>\n<h3>Solution 1</h3>\n<ol>\n<li>Run the following command to enter the IdM pod:\n\t<pre><code>kubectl exec -it $(kubectl get pod -n $CDF_NAMESPACE -ocustom-columns=NAME:.metadata.name |grep idm|head -1) -n $CDF_NAMESPACE -c idm sh</code></pre>\n</li>\n<li>Run the following command to enable the user account. Replace the <code>&lt;username&gt;</code> placeholder with the username of the user with the expired password.\n\t<pre><code>sh /idmtools/idm-installer-tools/idm.sh databaseUser unlockUser -org Provider -name &lt;username&gt;</code></pre>\n</li>\n<li>Run the following command to reset the password. Replace the <code>&lt;new_tmp_password&gt;</code> placeholder with a new temporary password.\n\t<pre><code>sh /idmtools/idm-installer-tools/idm.sh databaseUser resetPassword -org Provider -name \"admin\" -plainPwd \"&lt;new_tmp_password&gt;\"</code></pre>\n</li>\n<li>Log in to the Management Portal with the new temporary password. Reset the password on the password reset page.</li>\n<li>Log in to the Management Portal with the new password.</li>\n</ol>\n<h3>Solution 2</h3>\n<ol>\n<li>Run the following command to get the name of the IdM database:\n\t<pre><code>kubectl exec $(kubectl get pod -n &lt;namespace&gt; -ocustom-columns=NAME:.metadata.name |grep idm|head -1) -n &lt;namespace&gt; -c idm -- cat /opt/apache-tomcat/webapps/idm-service/WEB-INF/spring/applicationContext.properties  | grep 'idm.persistence.connection.url'</code></pre>\n<p>You can identify the database name basing on the following connection string from the output of the command:</p>\n<pre><code>idm.persistence.connection.url = jdbc:postgresql://itom-postgresql:5432/cdfidmdb?ssl=true&amp;sslmode=verify-full&amp;sslfactory=com.hp.ccue.identity.database.postgresql.PostgresFactory&amp;sslrootcert=/tmp/dbCerts.crt</code></pre>\n</li>\n<li>Connect to the IdM database, and then run the following database command. Replace the <code>&lt;username&gt;</code> placeholder with the username of the user with the expired password.\n\t<pre><code>update database_user set locked_date=null, locked=false, failed_login_counter=0,auto_unlocked_counter=0, enabled=true, password_expired_date=null where name='&lt;username&gt;';</code></pre>\n</li>\n</ol>\n<p><br/>\n</p>\n<p class=\"mw-empty-elt\"></p><span class=\"snippet-end\" data-sname=\"423-25.4-423-25.3-CannotResetPasswordAccountIdle||N\"></span></div>",
  "modifiedon": "2025-10-24 08:51:12"
}