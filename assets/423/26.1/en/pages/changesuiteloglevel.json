{
  "title": "Change log levels for suite services",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>You can change the log level for some suite services. </p>\n<h2>Common services logs</h2>\n<p>You can change the log level for the following common services logs.</p>\n<h3>Autopass logs</h3>\n<p>For helm deployment, Autopas logs are under &lt;<span style=\"font-size:10.0pt\"><span style=\"font-family:Arial\"><span style=\"color:#707070\"><span style=\"background:white\">logging-volume</span></span></span></span>&gt;/autopass/:</p>\n<ul>\n<li>autopassls.log</li>\n<li>idmclient.log</li>\n<li>startup.log</li>\n<li>autopasslspurge.log</li>\n<li>autopasslsaudit.xml</li>\n</ul>\n<p>To change their log level, modify log4j.properties (you need to wait about 30 seconds for the change to take effect):</p>\n<ol>\n<li>Run the command below on a control plane node:\n\t<pre>kubectl  exec -it autopass-lm-v2-578f9f6f85-nd2vl -n  &lt;suite namespace&gt; -c autopass-lm bash</pre>\n</li>\n<li>Run the command below:\n\t<pre>cd /opt/autopass/apls/apls/webapps/autopass/WEB-INF/classes/com</pre>\n</li>\n<li>Run the command below:\n\t<pre>sed -i  's/log4j.logger.com.hp.autopassj=INFO,APJ/log4j.logger.com.hp.autopassj=TRACE,APJ/g'  log4j.properties</pre>\n</li>\n<li>Verify that the log level has been changed:\n\t<pre>cat log4j.properties</pre>\n</li>\n</ol>\n<h3>IdM logs</h3>\n<p>For helm deployment, IdM logs are under &lt;<span style=\"font-size:10.0pt\"><span style=\"font-family:Arial\"><span style=\"color:#707070\"><span style=\"background:white\">logging-volume</span></span></span></span>&gt;/idm/&lt;xxxxxxxxxx&gt;-&lt;yyyy-mm-dd-hh-mm&gt;:</p>\n<ul>\n<li>idm-loader.log</li>\n<li>idm-service.log</li>\n</ul>\n<p>To change their log level, use the IdM tool:</p>\n<ol>\n<li>Run the command below (using DEBUG as the log level for example):  \n\t<pre>kubectl exec -it idm-xxxxxxxxxx -n &lt;suite namespace&gt; -c idm bash /idmtools/idm-installer-tools/idm.sh log level DEBUG</pre>\n</li>\n<li>Wait about 30 seconds for the change to take effect.</li>\n</ol>\n<h3>Nginx/ingress error.log</h3>\n<p>For Helm deployment, use the following steps to change the  log level for nginx/ingress:</p>\n<ol>\n<li>[Optional] If you don't remember the path of your custom <strong>my-values.yaml</strong> file, run the following command to get your yaml file.\n\n\t<pre>helm get values &lt;ESM_RELEASE_NAME&gt; -n &lt;ESM_NAMESPACE&gt; &gt; my-values.yaml</pre>\n<p>Where:</p>\n<ul>\n<li><code>&lt;ESM_RELEASE_NAME&gt;</code> is the release name, which you can obtain by using the following command:\n\n\t\t<pre>helm list -n &lt;ESM_NAMESPACE&gt; | awk '{print $1}'</pre>\n\t\t </li>\n<li><code>&lt;ESM_NAMESPACE&gt;</code> is the unique namespace of the ESM Helm chart deployment.</li>\n</ul>\n</li>\n<li>\n<p>Save the content below as an external values yaml <code>nginx-values.yaml </code> for changing the log level.  (this example changes the log level to TRACE)</p>\n<pre>nginx:\n  logLevel: TRACE</pre>\n</li>\n<li>Run the following command to clean up unused jobs before applying the changes. \n\t<pre><span style=\"font-size:11.0pt\"><span style=\"font-family:Calibri\">kubectl get job -n </span></span>&lt;ESM_NAMESPACE&gt;<span style=\"font-size:11.0pt\"><span style=\"font-family:Calibri\">|grep -v NAME | awk '{print $1}'|xargs kubectl delete job -n </span></span>&lt;ESM_NAMESPACE&gt;</pre>\n<p>Where <code>&lt;ESM_NAMESPACE&gt;</code> is the unique namespace of the ESM Helm chart deployment.</p>\n</li>\n<li>Run the following command to apply the changes:\n\t<pre>helm upgrade &lt;ESM_RELEASE_NAME&gt; -n &lt;ESM_NAMESPACE&gt; &lt;ESM_HELM_CHART_PATH&gt; -f ./my-values.yaml  -f ./nginx-values.yaml</pre>\n<p>Where:</p>\n<p>Example:</p>\n<pre>helm upgrade sma -n itsma ESM_Helm_Chart-2x.x.x/charts/esm-1.0.0+2x.x-xxx.tgz -f ./my-values.yaml -f ./nginx-values.yaml</pre>\n<ul>\n<li><code>&lt;ESM_RELEASE_NAME&gt;</code> is the release name, which you can obtain by using the following command:\n\n\t\t<pre>helm list -n &lt;ESM_NAMESPACE&gt; | awk '{print $1}'</pre>\n</li>\n<li><code>&lt;ESM_HELM_CHART_PATH&gt;</code>:  The absolute path of the ESM Helm chart package.</li>\n</ul>\n</li>\n</ol>\n<h2>Smart Analytics logs</h2>\n<p>You can change the log level for some pod logs and log files stored on the file storage.</p>\n<p>For Helm deployment, use the following steps to change the log level.</p>\n<ol>\n<li>[Optional] If you don't remember the path of your custom <strong>my-values.yaml</strong> file, run the following command to get your yaml file.\n\n\t<pre>helm get values &lt;ESM_RELEASE_NAME&gt; -n &lt;ESM_NAMESPACE&gt; &gt; my-values.yaml</pre>\n<p>Where:</p>\n<ul>\n<li><code>&lt;ESM_RELEASE_NAME&gt;</code> is the release name, which you can obtain by using the following command:\n\n\t\t<pre>helm list -n &lt;ESM_NAMESPACE&gt; | awk '{print $1}'</pre>\n\t\t </li>\n<li><code>&lt;ESM_NAMESPACE&gt;</code> is the unique namespace of the ESM Helm chart deployment.</li>\n</ul>\n</li>\n<li>Save the below content as an external values yaml  <code>smarta-values.yaml </code> for changing the log level. \n\t<pre>smarta:\n  configmap:\n    smarta:\n      smarta_loglevel: INFO\n</pre>\n</li>\n<li>Run the following command to clean up unused jobs before applying the changes. \n\t<pre><span style=\"font-size:11.0pt\"><span style=\"font-family:Calibri\">kubectl get job -n </span></span>&lt;ESM_NAMESPACE&gt;<span style=\"font-size:11.0pt\"><span style=\"font-family:Calibri\">|grep -v NAME | awk '{print $1}'|xargs kubectl delete job -n </span></span>&lt;ESM_NAMESPACE&gt;</pre>\n</li>\n<li>Run the following command to apply the changes:\n\t<pre>helm upgrade &lt;ESM_RELEASE_NAME&gt; -n &lt;ESM_NAMESPACE&gt;  &lt;ESM_HELM_CHART_PATH&gt; -f ./my-values.yaml -f ./smarta-values.yaml</pre>\n<p>Where:</p>\n<ul>\n<li><code>&lt;ESM_NAMESPACE&gt;</code> is the unique namespace of the ESM Helm chart deployment.</li>\n<li><code>&lt;ESM_RELEASE_NAME&gt;</code> is the release name, which you can obtain by using the following command:\n\t\t<pre>helm list -n &lt;ESM_NAMESPACE&gt; | awk '{print $1}'</pre>\n</li>\n<li><code><em>&lt;ESM_HELM_CHART_PATH&gt;</em></code>  is the absolute path of the ESM Helm chart package.</li>\n</ul>\n<p>Example:</p>\n<pre>helm upgrade sma -n itsma-xxx ESM_Helm_Chart-2x.x.x/charts/esm-1.0.0+2x.x-xxx.tgz -f ./my-values.yaml -f ./smarta-values.yaml</pre>\n</li>\n</ol>\n<h2 id=\"SM_gateway_logs\">SM gateway logs</h2>\n<p>Supported Log Levels: info, debug, trace, warn, and error.</p>\n<h3>Classic deployment</h3>\n<p>To change their log level, Run the following command:</p>\n<p><code>kubectl patch deployment sm-gateway -n <b>&lt;namespaces&gt;</b> -p '{\"spec\":{\"template\":{\"spec\":{\"containers\":[{\"name\":\"sm-gateway\",\"env\":[{\"name\": \"GATEWAY_LOG_LEVEL\",\"value\": \"<b>debug</b>\"}]}]}}}}'</code></p>\n<h3>Helm deployment</h3>\n<p>For Helm deployment, use the following steps to change the log level.</p>\n<ol>\n<li>[Optional] If you don't remember the path of your custom <strong>my-values.yaml</strong> file, run the following command to get your yaml file.\n\n\t<pre>helm get values &lt;ESM_RELEASE_NAME&gt; -n &lt;ESM_NAMESPACE&gt; &gt; my-values.yaml</pre>\n<p>Where:</p>\n<ul>\n<li><code>&lt;ESM_RELEASE_NAME&gt;</code> is the release name, which you can obtain by using the following command:\n\n\t\t<pre>helm list -n &lt;ESM_NAMESPACE&gt; | awk '{print $1}'</pre>\n\t\t </li>\n<li><code>&lt;ESM_NAMESPACE&gt;</code> is the unique namespace of the ESM Helm chart deployment.</li>\n</ul>\n</li>\n<li>Save the below content as an external values.yaml <code>sm-gateway-values.yaml </code> for changing the log level (using debug for example): \n\t<pre>smGateway：\n  logLevel：\n    gateway：debug\n    gatewayPerf：debug\n</pre>\n</li>\n<li>Run the following command to clean up unused jobs before applying the changes. \n\t<pre><span style=\"font-size:11.0pt\"><span style=\"font-family:Calibri\">kubectl get job -n </span></span>&lt;ESM_NAMESPACE&gt;<span style=\"font-size:11.0pt\"><span style=\"font-family:Calibri\">|grep -v NAME | awk '{print $1}'|xargs kubectl delete job -n </span></span>&lt;ESM_NAMESPACE&gt;</pre>\n</li>\n<li>Run the following command to apply the changes:\n\t<pre>helm upgrade &lt;ESM_RELEASE_NAME&gt; -n &lt;ESM_NAMESPACE&gt;  &lt;ESM_HELM_CHART_PATH&gt; -f ./my-values.yaml -f ./<code>sm-gateway-</code>values.yaml</pre>\n<p>Where:</p>\n<ul>\n<li><code>&lt;ESM_NAMESPACE&gt;</code> is the unique namespace of the ESM Helm chart deployment.</li>\n<li><code>&lt;ESM_RELEASE_NAME&gt;</code> is the release name, which you can obtain by using the following command:\n\t\t<pre>helm list -n &lt;ESM_NAMESPACE&gt; | awk '{print $1}'</pre>\n</li>\n<li><code><em>&lt;ESM_HELM_CHART_PATH&gt;</em></code>  is the absolute path of the ESM Helm chart package.</li>\n</ul>\n<p>Example:</p>\n<pre>helm upgrade sma -n itsma-xxx ESM_Helm_Chart-2x.x.x/charts/esm-1.0.0+2x.x-xxx.tgz -f ./my-values.yaml -f ./sm-gateway-values.yaml</pre>\n</li>\n</ol>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}