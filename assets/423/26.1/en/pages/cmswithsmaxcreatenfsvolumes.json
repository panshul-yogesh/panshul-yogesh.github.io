{
  "title": "Configure NFS volumes for UD/UCMDB",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><span class=\"snippet-start\" data-sname=\"423-25.4-423-25.3-CmsPrepareCreateNFS|CreateNFSVolumes|N\"></span><p>To save information such as configuration files, the information must be stored in a persistent volume provided by a Network File System (NFS). To install UD/UCMDB, you need to export NFS volumes to store the application data.</p>\n<p>The storage technology that provides NFS implementation must support the Kubernetes persistent mount option of ReadWriteMany. That means a storage volume can be mounted to multiple nodes in read/write mode in parallel.</p>\n<p>Each NFS exported volume must have the following settings:</p>\n<ul type=\"disc\">\n<li>rw</li>\n<li>sync</li>\n<li>\n<p>Be configured in the <strong>/etc/exports</strong> file with the following text:</p>\n<pre>/&lt;path to the shared folder on the NFS server&gt; (rw,sync,anonuid=&lt;user&gt;,anongid=&lt;fsGroup&gt;,root_squash)</pre>\n<p>Where the <code>&lt;user&gt;</code> and <code>&lt;fsGroup&gt;</code> need to be of the same values as those of the <strong>global.securityContext.user</strong> and <strong>global.securityContext.fsGroup</strong> parameters specified in the custom <strong>my-values.yaml</strong> file. For details, see the \"Create a custom values.yaml file\" topic in the \"Related topics\" section.</p>\n</li>\n<li>\n<p>Be configured with the following permissions:</p>\n<pre>chmod -R 755 &lt;path to the exported volume&gt;\nchown &lt;user&gt;:&lt;fsGroup&gt; &lt;path to the exported volume&gt;</pre>\n</li>\n</ul>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">\n<ul>\n<li>\n<p>The <code>&lt;user&gt;</code> and <code>&lt;fsGroup&gt;</code> are configured in the custom <b>my-</b><strong>values.yaml</strong> file. Both of which can be set to a value which is 1999 (default),  or between 100000 and 2000000000.</p>\n</li>\n<li>\n<p>The NFS server must support NFSv3 or NFSv4.</p>\n</li>\n</ul>\n</div>\n</div>\n<div>\n<h2>Volumes required for UD/UCMDB</h2>\n<p>The following NFS volumes are required for the UD/UCMDB deployment. Make sure the exported NFS volumes are empty and have no data.</p>\n</div>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Component</th>\n<th scope=\"col\">NFS volume name</th>\n<th scope=\"col\">Description</th>\n<th scope=\"col\">Example Directory path</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>UD/UCMDB</td>\n<td>ucmdb-data-volume</td>\n<td>Stores data that is generated by UD/UCMDB.</td>\n<td>/var/vols/itom/ucmdb/data_volume</td>\n</tr>\n<tr>\n<td>UD/UCMDB</td>\n<td>ucmdb-config-volume</td>\n<td>Stores UD/UCMDB configuration files.</td>\n<td>/var/vols/itom/ucmdb/conf_volume</td>\n</tr>\n<tr>\n<td>UD/UCMDB</td>\n<td>ucmdb-log-volume</td>\n<td>Stores logs generated by UD/UCMDB.</td>\n<td>/var/vols/itom/ucmdb/log_volume</td>\n</tr>\n</tbody>\n</table>\n<h2>Set up self-hosted NFS shared volumes</h2>\n<p>You can set up an NFS server and NFS shared volumes on any NFS server. We recommend that you use a dedicated NFS server for the UD/UCMDB NFS volumes. As an example, the following steps assume that you use a dedicated NFS server and will use the external databases for UD/UCMDB.</p>\n<ol>\n<li>\n<p>Log on to the NFS server as a root or sudo user.</p>\n</li>\n<li>\n<p>Copy the OMT installation package to a temporary directory on the NFS server.</p>\n</li>\n<li>\n<p>Run the following command to unzip the OMT installation package:</p>\n<pre>unzip &lt;ITOM_Platform_Foundation_Standard_xxx.zip&gt;</pre>\n</li>\n<li>\n<p>Navigate to the ITOM_Platform_Foundation_Standard_xxx/cdf/scripts directory, and then run the following command:</p>\n<pre>./setupNFS.sh &lt;shared volume&gt; true &lt;user&gt; &lt;fsGroup&gt;</pre>\n<p>For example:</p>\n<pre>./setupNFS.sh /var/vols/itom/ucmdb/data_volume true 100001 200001\n./setupNFS.sh /var/vols/itom/ucmdb/conf_volume true 100001 200001\n./setupNFS.sh /var/vols/itom/ucmdb/log_volume true 100001 200001</pre>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-important-icon\"></div>\n<div class=\"admonition-content admonition-important-content\">The values of <code>&lt;user&gt;</code> and <code>&lt;fsGroup&gt;</code> configured here must be the same as the values for the <strong>global.securityContext.user</strong> and<b> global.securityContext.fsGroup</b> parameters when you create your custom <strong>my-values.yaml</strong> file for the UD/UCMDB deployment in the later step.  That is, if you use the values in this example (<strong>100001 </strong>for &lt;user&gt; and <strong>200001 </strong>for &lt;fsGroup&gt;) instead of the default value <strong>1999</strong>, you must also change the values for <strong>global.securityContext.user</strong> and<b> global.securityContext.fsGroup </b>to <b>100001 </b>and <b>200001 </b>in your custom <strong>my-values.yaml</strong> file.</div>\n</div>\n</li>\n<li>\n<p>The permission of each folder must be set to 755. If it is not, run the following command to change the permissions:</p>\n<pre>chmod -R 755 &lt;path to shared folder&gt;</pre>\n<p>For example, run the following commands:</p>\n<pre>chmod -R 755 /var/vols/itom/ucmdb/data_volume\nchmod -R 755 /var/vols/itom/ucmdb/conf_volume\nchmod -R 755 /var/vols/itom/ucmdb/log_volume</pre>\n</li>\n</ol><span class=\"snippet-end\" data-sname=\"423-25.4-423-25.3-CmsPrepareCreateNFS|CreateNFSVolumes|N\"></span><h2>Related topics</h2><ul><li><a href=\"/doc/423/26.1/cmswithsmaxcreateyaml\">Create a custom values.yaml file</a></li></ul></div><p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}