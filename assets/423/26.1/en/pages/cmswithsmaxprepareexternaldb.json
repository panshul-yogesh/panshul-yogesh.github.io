{
  "title": "Prepare external databases for UD/UCMDB",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>For this release, you must use separate PostgreSQL databases instances for Service Management and the containerized UD/UCMDB for these reasons:</p>\n<ul>\n<li value=\"1\">Because of the different dimensions of Service Management and UD/UCMDB database sizing, if Service Management and UD/UCMDB share the same PostgreSQL database, the PostgreSQL instance size will be much larger than the size of separate ones.</li>\n<li>There are unknown issues and risks if Service Management and UD/UCMDB share the same PostgreSQL database.</li>\n</ul>\n<p>To prepare PostgreSQL for UD/UCMDB, perform the following tasks.</p>\n<h2>Install PostgreSQL</h2>\n<p>Follow the official PostgreSQL documentation for installation instructions to create a separate PostgreSQL database server for UD/UCMDB.</p>\n<div class=\"Admonition_Note\"><span class=\"autonumber\">Note </span>\n<ul>\n<li>\n<p>It is strongly recommended to host the database server on a <b>physical machine</b>, and it should be an independent server without other applications running on it.</p>\n<p>Also, if the database server machine is a virtual machine, the resource MUST be dedicated to the database server.</p>\n</li>\n<li>\n<p>Database servers must be set to the same time zone, daylight savings settings and time as the Universal CMDB servers.</p>\n</li>\n<li>\n<p>The UCMDB server should be located in the same LAN as the database servers (without a proxy and firewalls between them). Otherwise, your system's performance may be impacted.</p>\n</li>\n</ul>\n</div>\n<h2>Configure database server</h2>\n<ol>\n<li>\n<p>Optionally, enable TLS connections for the PostgreSQL database server. See <a href=\"/doc/423/26.1/enabletlsexternalpostgresqlcms\">Enable TLS connections to external PostgreSQL</a>.</p>\n\tBoth SSL modes (verify-full and verify-ca) are supported. For details, see the PostgreSQL documentation.</li>\n<li>\n<p>Configure the <b>postgresql.conf</b> file</p>\n<p>In the <b>postgresql.conf</b> file, configure the following parameters depending on your UD/UCMDB deployment size (Small, Medium, or Large).</p>\n<p>Note that the default value of the <code>listen_addresses</code> parameter is \"<code>localhost</code>\", which means only localhost can connect to the PostgreSQL instance. You need to set <code>listen_addresses = '*'</code> to allow remote connections.</p>\n<p>The following table provides example database settings for your reference.</p>\n<div>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Parameter</th>\n<th scope=\"col\">Small</th>\n<th scope=\"col\">Medium</th>\n<th scope=\"col\">Large</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>effective_cache_size</td>\n<td>32 GB</td>\n<td>48 GB</td>\n<td>48 GB</td>\n</tr>\n<tr>\n<td>maintenance_work_mem</td>\n<td>200 MB</td>\n<td>500 MB</td>\n<td>1 GB</td>\n</tr>\n<tr>\n<td>max_connections</td>\n<td>150</td>\n<td>150</td>\n<td>150</td>\n</tr>\n<tr>\n<td>shared_buffers</td>\n<td>16 GB</td>\n<td>32 GB</td>\n<td>50 GB</td>\n</tr>\n<tr>\n<td>work_mem</td>\n<td>100 MB</td>\n<td>200 MB</td>\n<td>300 MB</td>\n</tr>\n<tr>\n<td>listen_addresses</td>\n<td>'*'</td>\n<td>'*'</td>\n<td>'*'</td>\n</tr>\n</tbody>\n</table>\n</div>\n</li>\n<li>\n<p>Configure encoding and locale. Make sure that the PostgreSQL instance uses the following encoding and locale settings:</p>\n<pre>Encoding: UTF8\nLC_COLLATE: en_US.UTF-8\nLC_CTYPE: en_US.UTF-8</pre>\n</li>\n</ol>\n<h2>Create database users and databases for UD/UCMDB</h2>\n<p>In UD/UCMDB, the following components require databases:</p>\n<ul>\n<li>UCMDB Server</li>\n<li>AutoPass License Service (APLS)</li>\n<li>Data Flow Probe</li>\n</ul>\n<div class=\"Admonition_Note\"><span class=\"autonumber\">Note </span>The Data Flow Probe database is not required if you plan to deploy UD/UCMDB without containerized Data Flow Probe.</div>\n<p>In the production environment, you must use the external databases for UD/UCMDB. The database user and database name information is required when you install UD/UCMDB. The database schema information is required for UCMDB Server, and Data Flow Probe; but optional for AutoPass. A default schema name will be used if there is no new schema name assigned. </p>\n<p>The databases must be empty so that UD/UCMDB will initialize them during installation. The table below shows example database information prepared for the following components.</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Service</th>\n<th scope=\"col\">DB User</th>\n<th scope=\"col\">DB Name</th>\n<th scope=\"col\">Schema </th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>UCMDB Server</td>\n<td>ucmdb</td>\n<td>ucmdb_db</td>\n<td>ucmdb_schema</td>\n</tr>\n<tr>\n<td>APLS</td>\n<td>ucmdb_autopass</td>\n<td>ucmdb_autopass_db</td>\n<td>ucmdb_autopass_schema</td>\n</tr>\n<tr>\n<td>Data Flow Probe </td>\n<td>ucmdb_probe</td>\n<td>ucmdb_probe_db</td>\n<td>ucmdb_probe_schema</td>\n</tr>\n</tbody>\n</table>\n<p>Below are sample SQL commands for creating a user and a database for a service:</p>\n<ol>\n<li>\n<p>Log in to your PostgreSQL database server with the administrator credentials.</p>\n<pre>psql -h &lt;host&gt; -p &lt;port&gt; -U &lt;PostgreSQL admin&gt;</pre>\n</li>\n<li>\n<p>Run the following commands to create the databases and the users used by UCMDB Server, AutoPass, and Data Flow Probe:</p>\n<pre>CREATE USER &lt;USERNAME&gt; PASSWORD '&lt;PASSWORD&gt;';\nCREATE DATABASE &lt;DBNAME&gt; OWNER &lt;USERNAME&gt;;</pre>\n<div class=\"Admonition_Note\"><span class=\"autonumber\">Note </span> <code>&lt;PASSWORD&gt;</code> for the database user must meet the following complexity requirements defined by the Vault secret utility:\n\n\t<ul>\n<li>Length: at least 8 characters</li>\n<li>Alphanumeric characters</li>\n<li>At least 1 lower case letter</li>\n<li>At least 1 upper case letter</li>\n<li>At least 1 digit</li>\n</ul>\n</div>\n<p>For example:</p>\n<b># For UCMDB</b>\n<pre>CREATE USER ucmdb PASSWORD '&lt;PASSWORD&gt;';\nCREATE DATABASE ucmdb_db OWNER ucmdb;</pre>\n<br/>\n<b># </b><b>For APLS </b>\n<pre>CREATE USER ucmdb_autopass PASSWORD '&lt;PASSWORD&gt;';\nCREATE DATABASE ucmdb_autopass_db OWNER ucmdb_autopass;</pre>\n<br/>\n<br/>\n<b># For Data Flow Probe</b>\n<pre>CREATE USER ucmdb_probe PASSWORD '&lt;PASSWORD&gt;';\nCREATE DATABASE ucmdb_probe_db OWNER ucmdb_probe;</pre>\n\t </li>\n<li>\n<p>Run the following commands to create the schemas used by UCMDB Server, and Data Flow Probe: </p>\n<pre>\\c &lt;DBNAME&gt;\nCREATE SCHEMA &lt;DBSCHEMA&gt; AUTHORIZATION &lt;USERNAME&gt;;\nALTER USER &lt;USERNAME&gt; SET search_path TO &lt;DBSCHEMA&gt;;</pre>\n<p>For example:</p>\n<b># For UCMDB</b>\n<pre>\\c ucmdb_db\nCREATE SCHEMA ucmdb_schema AUTHORIZATION ucmdb;\nALTER USER ucmdb SET search_path TO ucmdb_schema;</pre>\n<br/>\n<b># For APLS</b>\n<pre>\\c ucmdb_autopass_db\nCREATE SCHEMA ucmdb_autopass_schema AUTHORIZATION ucmdb_autopass;\nALTER USER ucmdb_autopass SET search_path TO ucmdb_autopass_schema;</pre>\n<br/>\n<b># For Data Flow Probe</b>\n<pre>\\c ucmdb_probe_db\nCREATE SCHEMA ucmdb_probe_schema AUTHORIZATION ucmdb_probe;\nALTER USER ucmdb_probe SET search_path TO ucmdb_probe_schema;</pre>\n</li>\n</ol>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}