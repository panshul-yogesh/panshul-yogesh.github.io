{
  "title": "Configure load balancer for Audit service",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>To access the Audit service, you need to create an Application Load Balancer (ALB) and configure the listener for the Audit service on this ALB. The diagram below depicts how the integration ALB sets up the connection between Service Management and Audit.</p>\n<div><a class=\"image\" href=\"/file/images/3/35/Audit_EKS_Deployment.png\" title=\"/file/images/3/35/Audit_EKS_Deployment.png\"> <img alt=\"Integration ALB\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/3/35/Audit_EKS_Deployment.png\" height=\"437\" hspace=\"0\" src=\"../../../images/Audit_EKS_Deployment_f0469d41.png\" style=\"width:800px;height:437px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\" width=\"800\"/> </a></div>\n<h2>Prerequisites</h2>\n<p>Before creating and configuring an ALB, assign an FQDN for Audit service (for example, via <a href=\"https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-creating.html\" rel=\"nofollow\" target=\"1\" title=\"AWS route 53 services\">AWS route 53 services</a>) if you don't have one. You also need to prepare a new certificate using one of the following methods or else unexpected errors might occur at later steps.</p>\n<h3 id=\"Request_a_certificate\">Request a certificate</h3>\n<p>If you want to request a new certificate, follow these steps:</p>\n<ol>\n<li>Log in to the AWS Management Console in your target region.</li>\n<li>Navigate to <b>All services</b> &gt; <strong>Security, Identity, &amp; Compliance</strong> &gt; <b>Certificate Manager</b></li>\n<li>If you see the <strong>firstrun</strong> page, click <b>Get Started</b>.</li>\n<li>Click <b>Request a certificate</b>.</li>\n<li>Select <b>Request a public certificate</b> and click <b>Request a certificate</b>.</li>\n<li>Specify your target domain name. Use an asterisk (*) to request a wildcard certificate to protect several sites in the same domain. For example, <b>*.testaudit-ng.org.</b></li>\n<li>Click <b>Next</b>.</li>\n<li>Select <b>DNS validation</b> or <b>Email validation</b> according to your permission.</li>\n<li>Click <b>Review</b> and then click <b>Confirm and request</b>.</li>\n<li>Click <b>Continue</b>.</li>\n<li>Finish the certificate validation based on the method you just selected. For more information, see <a href=\"https://docs.aws.amazon.com/console/acm/validation\" rel=\"nofollow\" target=\"1\" title=\"https://docs.aws.amazon.com/console/acm/validation\">https://docs.aws.amazon.com/console/acm/validation</a>.</li>\n<li>Save the Amazon Resource Name (ARN) of the certificate as you will use it while creating the Audit ingress YAML.</li>\n</ol>\n<h3 id=\"Import_a_certificate\">Import a certificate</h3>\n<p>If you want to use a customized certificate, follow these steps:</p>\n<ol>\n<li>Log in to the AWS Management Console in your target region.</li>\n<li>Navigate to <b>All services</b> &gt; <strong>Security, Identity, &amp; Compliance</strong> &gt; <b>Certificate Manager</b></li>\n<li>If you see the <strong>firstrun</strong> page, click <b>Get Started</b>.</li>\n<li>Click <b>Import a certificate</b>.</li>\n<li>For <b>Certificate body</b>, paste the Privacy Enhanced Mail (PEM) encoded certificate to import.</li>\n<li>For <b>Certificate private key</b>, paste the PEM encoded, unencrypted private key that matches the certificate's public key.\n\t<div class=\"admonition\">\n<div class=\"admonition-icon admonition-important-icon\"></div>\n<div class=\"admonition-content admonition-important-content\">Currently, services integrated with AWS Certificate Manager support only the <code>RSA_1024</code> and <code>RSA_2048</code> algorithms.</div>\n</div>\n</li>\n<li>(Optional) For <b>Certificate chain</b>, paste the PEM encoded certificate chain.</li>\n<li>Click <b>Next </b>&gt;<b> Review and import </b>&gt;<b> Import.</b></li>\n</ol>\n<h2 id=\"Target_groups\">External ALB for Audit </h2>\n<p>You can configure ALB for Audit in two ways by either updating the existing external ALB or creating an external ALB.</p>\n<h3>Update existing external ALB</h3>\n<p>Add a rule to the existing ALB, where the ingress controller port is the port number to reach the Audit service. Refer to <code>audit-itom-ingress-controller-svc</code> in the diagram.</p>\n<h3>Create an external ALB for Audit</h3>\n<p>Follow these steps to create an external ALB for Audit:</p>\n<ol>\n<li>Save the content below as <strong>audit-service-public-ingress.yaml</strong> in the install directory (<strong>audit-20xx.xx</strong>):\n\n\t<pre>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: \"<code>audit-service-public-ingress</code>\"\n  namespace: &lt;audit_namespace&gt;\n  annotations:\n    alb.ingress.kubernetes.io/scheme: internet-facing\n    alb.ingress.kubernetes.io/group.name: &lt;application_loadbalancer_name&gt;\n    alb.ingress.kubernetes.io/listen-ports: '[{\"HTTPS\": 443}]'\n    alb.ingress.kubernetes.io/backend-protocol: HTTPS\n    alb.ingress.kubernetes.io/healthcheck-protocol: HTTPS\n    alb.ingress.kubernetes.io/healthcheck-port: traffic-port\n    alb.ingress.kubernetes.io/healthcheck-path: /healthz\n    alb.ingress.kubernetes.io/success-codes: 200-399\n    alb.ingress.kubernetes.io/target-type: instance\n    alb.ingress.kubernetes.io/load-balancer-attributes: idle_timeout.timeout_seconds=180\n    alb.ingress.kubernetes.io/certificate-arn: &lt;certificate_arn&gt;\n    alb.ingress.kubernetes.io/security-groups: &lt;security_groups&gt;\n    kubernetes.io/ingress.class: alb\n  labels:\n    app: audit-ingress\nspec:\n  ingressClassName: alb\n  tls:\n  - hosts:\n    - &lt;external_access_host&gt;\n  rules:\n    - host:\n      http:\n        paths:\n          - backend:\n              service:\n                name: \"audit-itom-ingress-controller-svc\"\n                port: \n                  number: &lt;ingress_controller_port&gt;\n            path: /*\n            pathType: ImplementationSpecific\n</pre>\n<p>Replace the following with the actual values:</p>\n<p><em>&lt;audit_namespace&gt;</em>: The unique namespace of the Audit deployment. For example, <strong>auditns</strong>.<br/>\n<em>&lt;application_loadbalancer_name&gt;</em>: Specify the name of the ALB you want to create. The name must consist of <strong>lower case</strong> alphanumeric characters, '-', or '.', and must start and end with an alphanumeric character. <br/>\n<em>&lt;certificate_arn&gt;</em>: The<a href=\"https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html\" title=\"resource name\"> resource name</a> of the prepared certificate. For example, <strong>arn:aws:acm:region:123456789012:certificate/12345678-1234-1234-1234-123456789012</strong>. See details in the<i> Prerequisites </i>section.<br/>\n<em>&lt;external_access_host&gt;</em>: The FQDN you've allocated for Audit Service. For example, <em>audit.com </em>as shown in the diagram. Go to AWS Route 53 service and create a separate FQDN by creating a new record under the domain used for suite installation.<br/>\n<em>&lt;security_groups&gt;</em>: The security groups that this ALB belongs to (if you haven't configured security groups, delete this parameter from the YAML). Separated by commas. For example, <em>sg-xxxx1, sg-xxx2.</em><br/>\n<em>&lt;ingress_controller_port&gt;</em>: The port number of the ingress controller of the Audit service (<code>audit-itom-ingress-controller-svc</code>). For example, <b>31051</b>.</p>\n</li>\n<li>Run the following command to apply the saved YAML file:\n\t<pre>kubectl create -f <code>audit-service-public-ingress</code>.yaml\n</pre>\n</li>\n</ol>\n<p><span style=\"color: rgb(0, 115, 231); font-family: Roboto, sans-serif; font-size: 24px;\">Bind an FQDN with Audit ALB</span></p>\n<p>After you create the ALB for Audit Service, bind the FQDN that you have allocated for Audit Service with this ALB in AWS Route 53. Refer to the AWS documentation.</p>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}