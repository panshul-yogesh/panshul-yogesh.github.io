{
  "title": "Configure EFS for Audit service",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><div>This section describes how to create and configure Amazon Elastic File System (EFS) to store Audit data on AWS, as well as how to configure EFS volumes for Audit service. Audit will be using the same EFS as Service Management.</div>\n<h2 id=\"Prepare_EFS_template_for_CMS\">Prepare EFS template for Audit</h2>\n<p>The following section gives the steps to prepare an EFS template for Audit. You may come across a \"Permission denied\" message if you have insufficient permissions while executing the following commands. Run the following commands again by adding sudo at the beginning of the commands:</p>\n<ol>\n<li>Create an EFS directory for Audit by running the following command:\n\t<pre>mkdir -p &lt;mount path&gt;/var/vols/itom/audit/&lt;Audit Namespace&gt;/vault\nmkdir -p &lt;mount path&gt;/var/vols/itom/audit/&lt;Audit Namespace&gt;/log</pre>\n\tFor example,\n\n\t<pre>mkdir -p /efs/var/vols/itom/audit/auditns/vault\nmkdir -p /efs/var/vols/itom/audit/auditns/log</pre>\n</li>\n<li>Change the permission for the directory that you have created by running the following command:\n\t<pre>chmod g+ws &lt;mount path&gt;/var/vols/itom/audit/&lt;Audit Namespace&gt;/vault\nchmod g+ws &lt;mount path&gt;/var/vols/itom/audit/&lt;Audit Namespace&gt;/log\n</pre>\n\tFor example,\n\n\t<pre>chmod g+ws /efs/var/vols/itom/audit/auditns/vault\nchmod g+ws /efs/var/vols/itom/audit/auditns/log\n</pre>\n</li>\n<li>Change the owner of the directory you have created by running the following command:\n\t<pre>chown <strong>&lt;user&gt;</strong>:<strong>&lt;fsGroup&gt;</strong><b> </b>&lt;mount path&gt;/var/vols/itom/audit/&lt;Audit Namespace&gt;/vault\nchown <strong>&lt;user&gt;</strong>:<strong>&lt;fsGroup&gt;</strong><b> </b>&lt;mount path&gt;/var/vols/itom/audit/&lt;Audit Namespace&gt;/log</pre>\n\tThe values of <code>&lt;user&gt;</code> and <code>&lt;fsGroup&gt;</code> configured here must be the same as the values for the <strong>global.securityContext.user</strong> and<b> global.securityContext.fsGroup</b> parameters when you create your custom <strong>my-values.yaml</strong> file for the Audit service deployment in the later step. That is, if you use the values in this example (<strong>100001 </strong>for &lt;user&gt; and <strong>200001 </strong>for &lt;fsGroup&gt;) instead of the default value <strong>1999</strong>, you must also change the values for <strong>global.securityContext.user</strong> and<b> global.securityContext.fsGroup </b>to <b>100001 </b>and <b>200001 </b>in your custom <strong>my-values.yaml</strong> file.<br/>\n\tExample 1 (using their default value 1999): \n\t<pre><code>chown 1999:1999 /efs/var/vols/itom/audit/auditns/vault\nchown 1999:1999 /efs/var/vols/itom/audit/auditns/log</code></pre>\n\tExample 2 (using 100001 for <strong>global.securityContext.user </strong>and 200001 for <b>global.securityContext.fsGroup)</b><strong>:</strong>\n<pre>chown 100001:200001 /efs/var/vols/itom/audit/auditns/vault\nchown 100001:200001 /efs/var/vols/itom/audit/auditns/log</pre>\n</li>\n</ol>\n<h2 id=\"Volumes_required_for_CMS\">Volumes required for Audit</h2>\n<p>You require the following EFS volumes for the Audit deployment. Make sure the exported EFS volumes are empty and have no data.</p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 500px;\">\n<thead>\n<tr>\n<th scope=\"col\">Component</th>\n<th scope=\"col\">EFS volume name</th>\n<th scope=\"col\">Description</th>\n<th scope=\"col\">Example directory path</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Audit</td>\n<td><strong>as-vault-volume-&lt;Audit Namespace&gt;</strong></td>\n<td>Stores Audit configuration files.</td>\n<td>/var/vols/itom/audit/auditns/vault</td>\n</tr>\n<tr>\n<td>Audit</td>\n<td><strong>as-log-volume-&lt;Audit Namespace&gt;</strong></td>\n<td>Stores logs generated by Audit service.</td>\n<td>/var/vols/itom/audit/auditns/log</td>\n</tr>\n</tbody>\n</table>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}