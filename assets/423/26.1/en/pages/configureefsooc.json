{
  "title": "Configure Amazon Elastic File System for OO",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>OO shares the same Amazon Elastic File System with the OpenText Service Management suite.</p>\n<p>This section describes how to prepare the OO directory structure in the suite Amazon Elastic File System mount. These directories will be later referenced in the OO Persistent Volume templates. </p>\n<h2 id=\"Prepare_EFS_template_for_CMS\">Volumes required for OO</h2>\n<p>The following volumes are required by OO: </p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Component</th>\n<th scope=\"col\">Amazon Elastic File System volume name</th>\n<th scope=\"col\">Description</th>\n<th scope=\"col\">Example Directory path</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>OO</td>\n<td><code>oo-config-vol</code></td>\n<td>Stores OO configuration files.</td>\n<td><code>/var/vols/itom/oo/oo_config_vol</code></td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-data-vol</code></td>\n<td>Stores OO, OO deployed AutoPass, and OO deployed Vault generated data.</td>\n<td><code>/var/vols/itom/oo/oo_data_vol</code></td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-logs-vol</code></td>\n<td>Stores logs generated by the OO components, except RAS logs which are stored in a different volume.</td>\n<td><code>/var/vols/itom/oo/oo_logs_vol</code></td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-data-export-vol</code></td>\n<td>\n<p>OO runs a <b>cron-job</b> for purging OO database with a retention period set to 375 days (default value). </p>\n<p>All the database data that's marked for purge gets exported first and exposed in this volume before purging. </p>\n</td>\n<td><code>/var/vols/itom/oo/oo_data_export_vol</code></td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-ras-logs-vol</code></td>\n<td>Stores OO RAS logs. </td>\n<td><code>/var/vols/itom/oo/oo_ras_logs_vol</code></td>\n</tr>\n</tbody>\n</table>\n<h2>Configure Amazon Elastic File System volumes for OO</h2>\n<ol>\n<li>\n<p>Log in to the bastion with the following command:</p>\n<pre>ssh -i &lt;private_key_pem_file&gt; centos@&lt;bastion_ip&gt;</pre>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">The <code>private_key_pem_file</code> and <code>bastion_ip</code> are created during the Service Management installation.</div>\n</div>\n</li>\n<li>\n<p>Copy and save the following script as<b> configureOOEFS.sh</b>:</p>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">Take the <strong>Example directory path</strong> as the directory path of Amazon Elastic File System volumes required for OO.</div>\n</div>\n<pre><code>#!/bin/bash\nif [ $# -lt 1 ]; then\n    echo \"Usage: $0 &lt;efs server fqdn&gt;\"\n    exit 1\nfi\n\nCURRENTDIR=$(cd \"$(dirname \"$0\")\";pwd)\nsuite_user_uid=$2\nsuite_user_gid=$3\nmount_point=/mnt/oo\nefs_server=$1\n\nif [ ! -d $mount_point ]; then\n    sudo mkdir -p $mount_point\nfi\n\nexport TIMEOUT_FOR_SERVICES=120\n\nmountEFS() {\n    local n=0\n    while :; do\n        n=$(($n + 1))\n        if [[ $n -ge $TIMEOUT_FOR_SERVICES ]]; then\n            echo \"Check timeout for mount EFS\"\n            exit 1\n        fi\n        sudo mount -t nfs4 -o nfsvers=4.1,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2 $efs_server:/ $mount_point\n        if [ $? -eq 0 ] || [ $? -eq 32 ]; then\n            echo \"Successfully mount EFS\"\n            sudo sed -i '$a\\'\"$efs_server:/ $mount_point nfs4 nfsvers=4.1,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,_netdev 0 0\" /etc/fstab\n            break\n        fi\n        sleep 15\n    done\n}\n\nmake_volume() {\n    local volume=$1\n    cd $mount_point\n    local mounted_pv=${mount_point}${volume}\n    if [ ! -d $mounted_pv ]; then\n        sudo mkdir -p $mounted_pv\n    fi\n    chown -R $suite_user_uid:$suite_user_gid $mounted_pv\n    chmod g+w $mounted_pv\n    chmod g+s $mounted_pv\n    chmod o+x $mounted_pv\n    chmod o+r $mounted_pv\n    echo \"Successfully created volume: ${volume}\"\n}\n\nmountEFS\nmake_volume /var/vols/itom/oo/oo_config_vol\nmake_volume /var/vols/itom/oo/oo_data_vol\nmake_volume /var/vols/itom/oo/oo_logs_vol\nmake_volume /var/vols/itom/oo/oo_data_export_vol\nmake_volume /var/vols/itom/oo/oo_ras_logs_vol\necho \"Finished creating required volumes\"\ncd ${CURRENTDIR}</code></pre>\n</li>\n<li>\n<p>Run the following commands to configure the Amazon Elastic File System volumes for OO:</p>\n<pre>chmod 755 configureOOEFS.sh\nsudo ./configureOOEFS.sh &lt;EFS_DNS_NAME&gt; &lt;SYSTEM_USER_ID&gt; &lt;SYSTEM_GROUP_ID&gt;</pre>\n<p>Where:</p>\n<ul>\n<li><code>&lt;EFS_DNS_NAME&gt;</code> = the DNS name of the suite Amazon Elastic File System server\n\n\t\t<ul>\n<li>You can obtain this information in two ways from the EC2 console:\n\t\t\t<ol>\n<li>Log in to the EC2 console.</li>\n<li>Access the Amazon Elastic File System service.</li>\n<li>From the file system list, click the one that's used by the suite.</li>\n<li>Obtain the DNS name from the bottom right side of the General panel.<br/>\n<a class=\"image\" href=\"/file/images/6/6d/suite_efs_obtain_dns_name.PNG\" title=\"/file/images/6/6d/suite_efs_obtain_dns_name.PNG\"> <img alt=\"suite_efs_obtain_dns_name\" border=\"0\" file=\"/mediawiki/images/6/6d/suite_efs_obtain_dns_name.PNG\" height=\"212\" hspace=\"0\" src=\"../../../images/suite_efs_obtain_dns_name_e2ab55b5.png\" style=\"width: 800px; height: 212px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/> </a></li>\n</ol>\n</li>\n</ul>\n</li>\n<li><code>&lt;SYSTEM_USER_ID&gt;</code> and <code>&lt;SYSTEM_GROUP_ID&gt;</code> = user and group ID respectively, of the user that has read and write access in the Amazon Elastic File System server\n\t\t<ul>\n<li>The user specified here will be the user that runs the container processes and read/write into the mounted volumes</li>\n<li>Unless otherwise specified when was the suite installed, the defaults for <strong>UID</strong> and <strong>GID</strong> are: 1999. </li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}