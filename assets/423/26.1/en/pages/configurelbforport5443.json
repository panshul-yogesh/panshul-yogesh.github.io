{
  "title": "Configure a load balancer for port 5443",
  "content": "<div class=\"mw-parser-output\">\n \n\n<p>This topic describes how to configure an external load balancer (LB) for the Suite and expose the LB's port 5443 to allow clients to access the Suite administration interface.</p>\n<h2>Expose port 5443 on external LB (NodePort service)</h2>\n<p>The following instructions are for exposing port 5443 on nginx. For other LBs, refer to the application's official documentation.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>If you have installed OMT, we recommend that you use the same nginx as the OMT to set up LB for the suite and expose the port 5443. </div></div></div>\n<p>After the suite installation, you need to get the actual node port of the frontend ingress, and then add traffic map rules to the load balancer. The port map points from port 5443 to the actual node ports on all worker nodes. </p>\n<p>Complete the following steps to expose port 5443 on nginx.</p>\n<ol>\n<li>Get the node port of ingress service which is to be exposed:\n\t<pre><code>kubectl get svc -n core portal-ingress-controller-svc</code></pre>\n</li>\n<li>Configure the nginx configuration file <strong>nginx.conf</strong> for the application load balancer or the network load balancer.\n\t<ul>\n<li><strong>For the application load balancer:</strong><br/>\n\t\tMake sure the nginx configuration file <strong>nginx.conf</strong> contains the following settings.\n\t\t<pre><code>http {\n    upstream ingressrouter5443 {    #upstream for port 5443\n        least_conn;\n        keepalive 32;\n        server &lt;control plane node 1&gt;:&lt;node port&gt; max_fails=0 fail_timeout=0;     #control plane node 1\n        server &lt;control plane node 2&gt;:&lt;node port&gt; max_fails=0 fail_timeout=0;     #control plane node 2\n        server &lt;control plane node 3&gt;:&lt;node port&gt; max_fails=0 fail_timeout=0;     #control plane node 3\n    } \n    server {\n        listen 5443  ssl http2;\n        ssl_certificate                         /root/server.crt;       #certificate generated by customers\n        ssl_certificate_key                  /root/server.key;      #key generated by customers \n        location ^~ / {\n            proxy_set_header Host            \"&lt;external load balancer&gt;:5443\";\n            proxy_pass                              https://ingressrouter5443;\n        }\n    } \n  \n}</code></pre>\n</li>\n<li><strong>For the network load balancer</strong>: <br/>\n\t\tAdd the following lines to <strong>nginx.conf</strong>, and replace <strong>&lt;node port&gt;</strong> with the value you have obtained from step 1:\n\t\t<pre><code>stream {\n    upstream ingressrouter5443 { #upstream for 5443\n         least_conn;\n         server &lt;control plane node 1 IP address&gt;:&lt;node port&gt; max_fails=0 fail_timeout=0; #control plane node 1\n         server &lt;control plane node 2 IP address&gt;:&lt;node port&gt; max_fails=0 fail_timeout=0; #control plane node 2\n         server &lt;control plane node 3 IP address&gt;:&lt;node port&gt; max_fails=0 fail_timeout=0; #control plane node 3\n    }\n\n    server {\n         listen 5443;\n         proxy_pass ingressrouter5443;\n     }\n }</code></pre>\n</li>\n</ul>\n</li>\n<li>Restart nginx.</li>\n<li>Log in to OMT Management portal, for example, <strong><em>https://&lt;external access host name&gt;:5443</em>, </strong>as <strong>admin </strong>user and verify the configuration.</li>\n</ol>\n</div>",
  "modifiedon": "2025-10-24 08:51:12"
}