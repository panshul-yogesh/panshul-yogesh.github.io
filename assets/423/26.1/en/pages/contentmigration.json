{
  "title": "Handle dynamic values in option properties of service designs",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>Starting with this release, the following aren't supported:</p>\n<ul>\n<li>The use of <strong>.jsp</strong> scripts to set dynamic values in option properties: In the previous releases, you could use <strong>.jsp</strong> scripts to dynamically fetch the options in the configuration options of service designs or user operations. You will need to convert the existing <strong>.jsp</strong> scripts to their equivalent <strong>.js</strong> to continue using these functionalities. After upgrading, all the <strong>.jsp</strong> file name's will be renamed to <strong>&lt;jsp-filename&gt;-MIGRATED.js</strong> and the contents of the JSP are commented out.</li>\n<li>The use of <code>ResourceAlias</code> to set dynamic values in option properties: You need to replace <code>ResourceAlias</code> with the method appropriate to your use case as below. \n\t<ul>\n<li>Use of <code>ResourceAlias</code> to read resource sync data - Replace with<code> <strong>executeXPathQueryOnSyncData</strong></code></li>\n<li>Use of <code>ResourceAlias</code> to fetch data from an external source - Replace with <strong><code>ESMEndpoint</code></strong></li>\n</ul>\n</li>\n</ul>\n<h2>Guidelines to develop equivalent .js scripts</h2>\n<h3>Replace <strong>ResourceSync</strong> with <strong>executeXPathQueryOnSyncData</strong> service method of <strong>CSAIntegrationHelper</strong></h3>\n<ol>\n</ol>\n<p>Here is an example of a JavaScript file in 2022.02 which is developed to read the vCenter resource sync data to list the datacenters.</p>\n<pre>        vCenter-datacenter.js\n\n        var availableValues = [];                                           // This is the output array that will contain the dynamic options \n        var providerId=request.providerId;                                    // This is the input request parameter to the script \n        var fileName = \"vCenter-\" + providerId + \".xml\";                    // Initializes the resource sync filename variable whose value is in the format of &lt;ProviderType&gt;-&lt;ProviderId&gt;.xml \n        var expression = '/Providers/AvailableDatacenters/datacenter';        // XPath expression to read the datacenters from resource sync file\n         \n        var datacenters = CSAIntegrationHelper.executeXPathQueryOnSyncData(fileName, expression);  // This helper method will parse and evaluate the xpath expression on the resource sync data \n         \n        for(i = 0; i &lt; datacenters.length; i++) {\n                var datacenter = datacenters[i];\n                availableValues.push({\n                    'displayName':datacenter.evaluateString('name'),\n                    'value': datacenter.evaluateString('name'),\n                    'description':datacenter.evaluateString('name')\n                });\n        }</pre>\n<ol>\n</ol>\n<p>You can download and install the latest version of vCenter cloudslang capsule from ITOM Marketplace. This capsule will create a new design that provides the OOTB JavaScript files to read the dynamic options from resource sync data. Refer to the JavaScript files in the design and use that to refactor the JS content for dynamic option properties.</p>\n<p>Follow the aforementioned steps for each of the option properties that had used <strong>ResourceSync</strong>.</p>\n<h3>Convert ResourceAlias to OPB endpoint in JavaScript file</h3>\n<p>Ensure to complete the following prerequisites:</p>\n<ul>\n<li>Install and add an OPB Agent</li>\n<li>Configure OPB endpoints</li>\n</ul>\n<div class=\"Admonition_Note\"><strong>Note</strong>: Configure the OPB endpoints with a name that is similar to the one used in ResourceAlias. Example: In ResourceAlias, if JDBC endpoint name is <strong>myjdbcendpoint</strong>, then in OPB endpoint, use <strong>myjdbcendpoint</strong>.</div>\n<p>If you have service designs with dynamic options using ResourceAlias, you must convert ResourceAlias to their respective OPB endpoints depending on the type of external source you are using to fetch the data from.</p>\n<ol>\n<li>Create a new version of the service designs which has dynamic options using ResourceAlias.</li>\n<li>For each option property, open the <strong>Configuration Options</strong> tab in the new version of the service design.</li>\n<li>Open the JavaScript file and replace ResourceAlias with OPB endpoints, as shown below:\n\t<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\">\n<thead>\n<tr>\n<th scope=\"col\">Endpoint type</th>\n<th scope=\"col\">ResourceAlias</th>\n<th scope=\"col\">OPB endpoint</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>File system</td>\n<td><code>var client = new FileStorage(new ResourceAlias(\"file_endpoint\"));</code></td>\n<td><code>var client = new FileStorage(new ESMEndpoint(\"file_endpoint\"));</code></td>\n</tr>\n<tr>\n<td>JDBC</td>\n<td><code>var client = new SQLClient (new ResourceAlias('jdbc_endpoint'));</code></td>\n<td><code>var client = new SQLClient(new ESMEndpoint('jdbc_endpoint'));</code></td>\n</tr>\n<tr>\n<td>LDAP</td>\n<td><code>resourceAlias: new ResourceAlias('ldap_endpoint'),</code></td>\n<td><code>strategy: new ESMEndpoint(\"ldap_endpoint\"),</code></td>\n</tr>\n<tr>\n<td>REST</td>\n<td><code>resourceAlias: new ResourceAlias('rest_endpoint'),</code></td>\n<td><code>strategy: new ESMEndpoint('rest_endpoint'),</code></td>\n</tr>\n</tbody>\n</table>\n\tFor details on how to install, configure and use endpoint types, see <strong>Use case: OPB endpoints of Design and Deploy</strong>.</li>\n<li>Save the changes.</li>\n</ol>\n<p>Follow the aforementioned steps for each of the option properties that have a <strong>.jsp</strong> file.</p>\n<h2>Replacing content of &lt;jsp-filename&gt;-MIGRATED.js file with equivalent .js content</h2>\n<ol>\n<li>Log in to the <strong>Agent Interface</strong>. From the <strong>Dashboard</strong>, select <strong>Build</strong> &gt; <strong>Design</strong> &gt; <strong>All Designs</strong>.</li>\n<li>Select the service design. From the Action Menu <a class=\"image\" href=\"/file/images/7/74/2018.02/Management_Console/Sequenced_Designs/images/gear_icon.png\" title=\"/file/images/7/74/2018.02/Management_Console/Sequenced_Designs/images/gear_icon.png\"> <img alt=\"\" border=\"0\" file=\"\" height=\"22\" hspace=\"0\" src=\"../../../images/gear_icon_3d7a236d.png\" vspace=\"0\" width=\"28\"/> </a> , create a new version of the selected service design.</li>\n<li>From the new version of the service design, select the <strong>CONFIGURATION OPTIONS</strong> tab.</li>\n<li>Select the options set and choose the option properties listed on the right side, for example, <strong>Datacenter Name</strong>.</li>\n<li>In the <strong>Edit Property</strong> page, select <strong>Manage Scripts</strong>. In the <strong>Manage Scripts</strong> popup, create a new JS script by providing inputs and outputs same as the .jsp file to get the equivalent functionality as the .jsp file.</li>\n<li>Publish the new version of the service design.</li>\n<li>Create an offering and test the offering.</li>\n<li>Test if all the user operations are working.</li>\n</ol>\n<p>After performing the above tasks, the dynamic options associated with provisioned subscriptions and associated offerings will use the modified JS.</p>\n<h2><span style=\"color: rgb(0, 115, 231); font-family: Roboto, sans-serif; font-size: 24px;\">CSA Helper APIs</span></h2>\n<p>You can use the following Helper APIs in the JS scripts:</p>\n<ol>\n<li><strong>CSAIntegrationHelper.executeXPathQueryOnSyncData</strong>: Use this Helper API to fetch resource sync data.</li>\n<li><strong>CSAIntegrationHelper.getResourceProvidersJson</strong>: Use this to get provider info in JSON format.</li>\n</ol>\n<h2>Related topics</h2>\n<ul>\n<li>For details on how to install, configure and use endpoint types, see <a href=\"/doc/423/26.1/opbendpointsusecase\">Use case: OPB endpoints of Design and Deploy</a></li>\n<li>For information on option sets, see <a href=\"/doc/423/26.1/mgmtconssdsubsoptionpropadd\">Add configuration option sets and options</a>.</li>\n<li>For information on creating Configuration Options, see <a href=\"/doc/423/26.1/mgmtconssdsubsoptionpropcreate\">Create configuration option properties</a>. Select or create the Javascript that will determine the values that should be presented to a user in the Service Portal. </li>\n</ul>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}