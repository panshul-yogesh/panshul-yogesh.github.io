{
  "title": "Create flows with loops",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>You can set a step as a loop, to create an iterative task. A loop step can be based on an operation or flow.</p>\n<p>The OO Workflow Designer supports two kinds of loops:</p>\n<ul>\n<li>\n<p><b>Loop</b></p>\n<p>A loop step runs over a collection of items in a <b>synchronous</b> way.</p>\n<p>Steps set as a loop appear with a circular arrows icon.</p>\n<p><a class=\"image\" href=\"/file/images/2/26/Loop_step.png\" title=\"/file/images/2/26/Loop_step.png\"> <img alt=\"Loop step.png\" data-file-height=\"107\" data-file-width=\"98\" height=\"107\" src=\"../../../images/Loop_step_45f1e675.png\" width=\"98\"/> </a></p>\n</li>\n<li>\n<p><b>Parallel loop</b></p>\n<p>A parallel loop step runs over a collection of items in an <b>asynchronous</b> way. This means that the step can run simultaneously and in different contexts.</p>\n<p>Steps set as a parallel loop appear with a branch icon.</p>\n<p><a class=\"image\" href=\"/file/images/d/d5/Parallel_loop.png\" title=\"/file/images/d/d5/Parallel_loop.png\"> <img alt=\"Parallel loop.png\" data-file-height=\"103\" data-file-width=\"91\" height=\"103\" src=\"../../../images/Parallel_loop_a9cb959a.png\" width=\"91\"/> </a></p>\n</li>\n</ul>\n<h2>Create a flow with a loop</h2>\n<ol>\n<li>Create a flow and select the step that you want to use as a loop step.</li>\n<li>Click <b>Create Loop</b> <a class=\"image\" href=\"/file/images/f/fd/2018.02/OO_Designer/but_loop.png\" title=\"/file/images/f/fd/2018.02/OO_Designer/but_loop.png\"> <img alt=\"but loop.png\" data-file-height=\"25\" data-file-width=\"23\" height=\"25\" src=\"../../../images/but_loop_db8f6425.png\" width=\"23\"/> </a>  in the authoring pane toolbar.</li>\n<li>\n<p>From the menu that appears, select <b>Set as loop</b>.</p>\n<p><a class=\"image\" href=\"/file/images/8/8c/OOD_2018.08_loop.PNG\" title=\"/file/images/8/8c/OOD_2018.08_loop.PNG\"> <img alt=\"OOD 2018.08 loop.PNG\" data-file-height=\"110\" data-file-width=\"172\" height=\"110\" src=\"../../../images/OOD_2018.08_loop_2504b5f9.png\" width=\"172\"/> </a></p>\n</li>\n<li>\n<p>For a step set as a loop, the <b>Step Properties</b> &gt; <b>Inputs</b> tab has an extra <b>Loop Details</b> section, where you can define the collection that the input will be iterated on and the break points of the loop.<br/>\n<a class=\"image\" href=\"/file/images/b/be/Loop_inputs.png\" title=\"/file/images/b/be/Loop_inputs.png\"> <img alt=\"Loop inputs.png\" data-file-height=\"366\" data-file-width=\"286\" height=\"366\" src=\"../../../images/Loop_inputs_017e5455.png\" width=\"286\"/> </a></p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 500px;\">\n<caption>Loop Details</caption>\n<thead>\n<tr>\n<th scope=\"col\">Field</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><b>For</b></td>\n<td>Enter the name of the variable that you can assign the current value from the collection that's defined under <b>In</b>. This step is mandatory.<br/>\n\t\t\t\tThis variable will be available while the loop step is running.</td>\n</tr>\n<tr>\n<td><b>In</b></td>\n<td>Define the collection to be iterated on. This step is mandatory.<br/>\n\t\t\t\tYou can define the collection using a flow variable or system property. For example, you can create a system property with a comma delimited string ('1,2,3,4,5') as the value and use this to define the collection.<br/>\n\t\t\t\tThe evaluation of the flow variable or system properties must be a string as CloudSlang<span style=\"background-color: transparent;\"> supports only strings. For example, 'Range(1,6)' will work inline only if the </span><b style=\"background-color: transparent;\">for</b><span style=\"background-color: transparent;\"> variable (which will be a digit) isn't assigned to an inner step input (which requires string). It won't work if passed as a value of system property or flow variable.<br/>\n\t\t\t\tYou can also open the Expression Editor and write a Python expression that results in a list or map. For example:</span> <br/>\n\t\t\t\tAn array: <strong>['1','2','3','4'] or ['a','b','c','d']</strong><br/>\n\t\t\t\tA Python expression: <strong>map(str,range(1,5))</strong><br/>\n\t\t\t\tA map: <strong>{\"key1\":\"value1\",\"key2\":\"value2\"}</strong><br/>\n\t\t\t\tA comma delimited string, which split's automatically into a list: <strong>'1,2,3'</strong>.</td>\n</tr>\n<tr>\n<td><b>Break On</b></td>\n<td>A loop ends either when the list that it is looping on is finished or when the looped step returns one of the results defined as a break point.<br/>\n\t\t\t\tClick <b>Select break result to add</b> <a class=\"image\" href=\"/file/images/6/6b/2018.02/OO_Designer/but_add.png\" title=\"/file/images/6/6b/2018.02/OO_Designer/but_add.png\"> <img alt=\"but add.png\" data-file-height=\"22\" data-file-width=\"17\" height=\"22\" src=\"../../../images/but_add_81bca26c.png\" width=\"17\"/> </a>  to choose one of the step results as a break point. There can be multiple break points.<br/>\n\t\t\t\tTo remove a break point, roll over to display <b>Remove</b> <a class=\"image\" href=\"/file/images/b/b1/2018.02/OO_Designer/but_remove.png\" title=\"/file/images/b/b1/2018.02/OO_Designer/but_remove.png\"> <img alt=\"but remove.png\" data-file-height=\"15\" data-file-width=\"13\" height=\"15\" src=\"../../../images/but_remove_c5e33d53.png\" width=\"13\"/> </a> , and click <b>Remove</b> <a class=\"image\" href=\"/file/images/b/b1/2018.02/OO_Designer/but_remove.png\" title=\"/file/images/b/b1/2018.02/OO_Designer/but_remove.png\"> <img alt=\"but remove.png\" data-file-height=\"15\" data-file-width=\"13\" height=\"15\" src=\"../../../images/but_remove_c5e33d53.png\" width=\"13\"/> </a> .</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<p>In the <b>Step Properties</b> &gt; <b>Outputs</b> tab, define how to publish the output. At run time, the output will contain the value from the last iteration of the loop.</p>\n</li>\n<li>Click <b>Add a Step Output</b> <a class=\"image\" href=\"/file/images/0/0d/2018.02/OO_Designer/but_add_arrow.png\" title=\"/file/images/0/0d/2018.02/OO_Designer/but_add_arrow.png\"> <img alt=\"but add arrow.png\" data-file-height=\"29\" data-file-width=\"30\" height=\"29\" src=\"../../../images/but_add_arrow_a21ac586.png\" width=\"30\"/> </a>  to add a new output to the step.</li>\n<li>Choose one of the underline outputs to define the output.</li>\n<li>\n<p>Under <b>Value</b>, open the Expression Editor and enter a Python expression to aggregate all the iterations.</p>\n</li>\n<li>\n<p>Set up the navigation logic for the loop step.</p>\n<p>The navigation to the next step in the flow occurs when the last iteration of the step is completed or after the loop exits the iteration due to a break. The navigation will run according to the last iteration of the loop.</p>\n<p>If you want to use the <b>for</b> value inside the step, you must add it as the value to one of the step inputs.</p>\n</li>\n</ol>\n<h2>Aggregation of loop outputs</h2>\n<p>To aggregate the results of a specific loop step, proceed as in the following example, where the numbers generated in the loop's iterations are added:</p>\n<ol>\n<li>\n<p>Import a base content pack onto dependencies pane and choose the <b>random_number_generator</b> operation.</p>\n</li>\n<li>Drag the <b>random_number_generator</b> operation to the flow and set the resulting step as a loop.</li>\n<li>\n<p>Define the collection that the loop will run on (see the following example).</p>\n<p><a class=\"image\" href=\"/file/images/d/dd/random_step_properties.PNG\" title=\"/file/images/d/dd/random_step_properties.PNG\"> <img alt=\"random step properties.PNG\" data-file-height=\"421\" data-file-width=\"296\" height=\"421\" src=\"../../../images/random_step_properties_1385d401.png\" width=\"296\"/> </a></p>\n</li>\n<li>\n<p>Enter the values for <b>min</b> and <b>max</b> Step Inputs as shown in the following example image.</p>\n<p><a class=\"image\" href=\"/file/images/5/5d/2018.02/OO_Designer/min_max_values.PNG\" title=\"/file/images/5/5d/2018.02/OO_Designer/min_max_values.PNG\"> <img alt=\"min max values.PNG\" class=\"z_migration_tba_PDF\" data-file-height=\"164\" data-file-width=\"570\" height=\"164\" src=\"../../../images/min_max_values_3d77a2bb.png\" width=\"570\"/> </a></p>\n</li>\n<li>Define the aggregated output for the loop step as shown below. The <b>random_number</b> output is optional.<br/>\n<a class=\"image\" href=\"/file/images/b/ba/OOD_2018.12.NG_randomStepPropertiesOutput.png\" title=\"/file/images/b/ba/OOD_2018.12.NG_randomStepPropertiesOutput.png\"> <img alt=\"OOD 2018.12.NG randomStepPropertiesOutput.png\" data-file-height=\"512\" data-file-width=\"1022\" height=\"512\" src=\"../../../images/OOD_2018.12.NG_randomStepPropertiesOutput_7798f5bf.png\" width=\"1022\"/> </a> <span class=\"autonumber\">Note</span><br/>\n\tThe Python expression for the <b>sum_random</b> output using (aggregating) the outputs from the iterations is:<br/>\n<a class=\"image\" href=\"/file/images/3/3e/2018.02/OO_Designer/with_loop_step_flow_output_expression.PNG\" title=\"/file/images/3/3e/2018.02/OO_Designer/with_loop_step_flow_output_expression.PNG\"> <img alt=\"with loop step flow output expression.PNG\" class=\"z_migration_tba_PDF\" data-file-height=\"99\" data-file-width=\"770\" height=\"99\" src=\"../../../images/with_loop_step_flow_output_expression_4af8c120.png\" width=\"770\"/> </a></li>\n<li>Add a new <b>Step Input</b> and rename it as the <b>Output</b>. For example the following image shows the Step Input name as <b>sum_random</b>. This <b>sum_random</b> step input is assigned from itself, or with <b>0</b> when it has no value yet (at the first iteration).<br/>\n<a class=\"image\" href=\"/file/images/c/c3/OOD_2018.12_sum_random_otherwise.png\" title=\"/file/images/c/c3/OOD_2018.12_sum_random_otherwise.png\"> <img alt=\"OOD 2018.12 sum random otherwise.png\" data-file-height=\"511\" data-file-width=\"1016\" height=\"511\" src=\"../../../images/OOD_2018.12_sum_random_otherwise_2fbdcd86.png\" width=\"1016\"/> </a></li>\n<li>Click <b>Save</b> <a class=\"image\" href=\"/file/images/0/0b/2018.02/OO_Designer/but_save.png\" title=\"/file/images/0/0b/2018.02/OO_Designer/but_save.png\"> <img alt=\"but save.png\" class=\"z_migration_tba_PDF\" data-file-height=\"20\" data-file-width=\"18\" height=\"20\" src=\"../../../images/but_save_6815ae63.png\" width=\"18\"/> </a> .</li>\n</ol>\n<h2>Create a flow with a parallel loop</h2>\n<p>In a parallel loop step, a new branch is created for each value in the collection and the branches run in parallel. The rest of the flow will continue only after all the branches have finished running.</p>\n<p>If you defined a step as a parallel loop step, you can limit the maximum number of parallel loop lanes that will be iterated at once. The limit can be a positive number (range 1 - 1000, default 20) or a variable (flow variable or system property). </p>\n<ol>\n<li>Create a flow and select the step that you want to use as a parallel loop step.</li>\n<li>Click <b>Create Loop</b> <a class=\"image\" href=\"/file/images/f/fd/2018.02/OO_Designer/but_loop.png\" title=\"/file/images/f/fd/2018.02/OO_Designer/but_loop.png\"> <img alt=\"but loop.png\" data-file-height=\"25\" data-file-width=\"23\" height=\"25\" src=\"../../../images/but_loop_db8f6425.png\" width=\"23\"/> </a>  in the Authoring pane toolbar.</li>\n<li>\n<p>From the menu that appears, select <b>Set as a parallel loop</b>.</p>\n<p><a class=\"image\" href=\"/file/images/8/8c/OOD_2018.08_loop.PNG\" title=\"/file/images/8/8c/OOD_2018.08_loop.PNG\"> <img alt=\"OOD 2018.08 loop.PNG\" data-file-height=\"110\" data-file-width=\"172\" height=\"110\" src=\"../../../images/OOD_2018.08_loop_2504b5f9.png\" width=\"172\"/> </a></p>\n</li>\n<li>\n<p>For a step set as a loop, the <b>Step Properties</b> &gt; <b>Inputs</b> tab has an extra <b>Parallel Loop Details</b> section, where you can define the collection that the step will iterate on.<br/>\n<a class=\"image\" href=\"https://staging.docs.microfocus.com/file/images/4/41/OO_202305_ParallelLoopDetails.png\" title=\"https://staging.docs.microfocus.com/file/images/4/41/OO_202305_ParallelLoopDetails.png\"> <img alt=\"\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/4/41/OO_202305_ParallelLoopDetails.png\" height=\"512\" hspace=\"0\" src=\"../../../images/OO_202305_ParallelLoopDetails_81f38abc.png\" vspace=\"0\" width=\"400\"/> </a></p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 500px;\">\n<caption>Parallel Loop Details</caption>\n<thead>\n<tr>\n<th scope=\"col\">Field</th>\n<th scope=\"col\">Description</th>\n</tr>\n<tr>\n<td><b>For</b></td>\n<td>Enter the name of the variable that you can assign the current value from the collection that's defined under <b>In</b>. This step is mandatory.<br/>\n\t\t\t\tThis variable will be available while the loop step is running.</td>\n</tr>\n<tr>\n<td><b>In</b></td>\n<td>Define the collection to be iterated on. This step is mandatory.<br/>\n\t\t\t\tYou can define the collection using a flow variable or system property. For example, you can create a system property with a comma delimited string ('1,2,3,4,5') as the value and use this to define the collection.<br/>\n\t\t\t\tThe evaluation of the flow variable or system properties must be a string as CloudSlang<span style=\"background-color: transparent;\"> supports only strings. For example, 'Range(1,6)' will work inline only if the </span><b style=\"background-color: transparent;\">for</b><span style=\"background-color: transparent;\"> variable (which will be a digit) isn't assigned to an inner step input (which requires string). It won't work if passed as a value of system property or flow variable.<br/>\n\t\t\t\tYou can also open the Expression Editor and write a Python expression that results in a list or map. For example:</span> <br/>\n\t\t\t\tAn array: <strong>['1','2','3','4'] or ['a','b','c','d']</strong><br/>\n\t\t\t\tA Python expression: <strong>map(str,range(1,5))</strong><br/>\n\t\t\t\tA map: <strong>{\"key1\":\"value1\",\"key2\":\"value2\"}</strong><br/>\n\t\t\t\tA comma delimited string, which split's automatically into a list: <strong>'1,2,3'</strong>.</td>\n</tr>\n<tr>\n<td><b>max_throttle</b></td>\n<td>Control the maximum number of parallel loop lanes that will be iterated at once. The limit can be a positive number (range 1 - 1000, default 20) or a variable (flow variable or system property).<br/>\n\t\t\t\tIt's recommended to configure the number of parallel loop lanes according to the use case; a lower value will most often denote optimization at run time.<br/>\n\t\t\t\tThe <b>max_throttle</b> field isn't shown by default. Click the gear icon in the Parallel Loop Details section to show this field.</td>\n</tr>\n</thead>\n</table>\n</li>\n<li>\n<p>In the <b>Step Properties</b> &gt; <b>Outputs</b> tab, define how to publish the output.</p>\n</li>\n<li>Click <b>Add a step output</b> <a class=\"image\" href=\"/file/images/6/6b/2018.02/OO_Designer/but_add.png\" title=\"/file/images/6/6b/2018.02/OO_Designer/but_add.png\"> <img alt=\"but add.png\" data-file-height=\"22\" data-file-width=\"17\" height=\"22\" src=\"../../../images/but_add_81bca26c.png\" width=\"17\"/> </a>  to add a new output to the step.</li>\n<li>\n<p>Choose one of the underline outputs to define the output:</p>\n<p><a class=\"image\" href=\"/file/images/e/ec/2018.02/OO_Designer/Parallel_loop_outputs.png\" title=\"/file/images/e/ec/2018.02/OO_Designer/Parallel_loop_outputs.png\"> <img alt=\"Parallel loop outputs.png\" class=\"z_migration_tba_PDF\" data-file-height=\"282\" data-file-width=\"212\" height=\"282\" src=\"../../../images/Parallel_loop_outputs_1dda00cc.png\" width=\"212\"/> </a></p>\n</li>\n<li>\n<p>Under <b>Value</b> for the output, open the Expression Editor and enter a Python expression to aggregate the outputs.</p>\n<p><a class=\"image\" href=\"/file/images/9/96/Parallel_loop_outputs2.png\" title=\"/file/images/9/96/Parallel_loop_outputs2.png\"> <img alt=\"Parallel loop outputs2.png\" data-file-height=\"227\" data-file-width=\"397\" height=\"227\" src=\"../../../images/Parallel_loop_outputs2_ce802472.png\" width=\"397\"/> </a></p>\n<p>To define the step aggregation logic, you can use the <b>branches_context</b> construct. This is a list that includes the context of all the iterations. The <b>branches_context</b> is set according to the order of the executions, so that the execution that finishes first takes the first place in the list.</p>\n<p>After all the branches of the parallel loop have completed, the execution of the flow continues with the output that's published. The expression of each output pair is evaluated and published to the flow's scope. The out-of-the-box outputs are <b>name</b> (first branch), <b>name_list</b>, <b>iteration_size</b>, <b>result_status_list</b>, and <b>num_of_failures</b>.</p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 500px;\">\n<caption>Sample output pairs</caption>\n<thead>\n<tr>\n<th scope=\"col\">Example </th>\n<th scope=\"col\">Output</th>\n</tr>\n<tr>\n<td>Retrieve the name variable from the first branch to finish</td>\n<td><code>branches_context[0]['name']</code></td>\n</tr>\n<tr>\n<td>Publish aggregated output<br/>\n\t\t\t\tThis iterates over the branches_context, which contains a list of all the iterations of the parallel flow, and takes the value of 'name' from each branch.</td>\n<td><code>str([str(branch[\"name\"]) for branch in branches_context])</code></td>\n</tr>\n<tr>\n<td>Create a list of branch results<br/>\n\t\t\t\tAs branches of a parallel flow complete, the branch results get placed into the <b>branches_context</b> list under the <b>branch_result</b> key.</td>\n<td><code>str([str(branch[\"branch_result\"]) for branch in branches_context])</code></td>\n</tr>\n<tr>\n<td>Configure the iteration size</td>\n<td><code>str(len(branches_context))</code></td>\n</tr>\n<tr>\n<td>Configure the number of failures by using <b>num_of_failures</b></td>\n<td><code>str([branch[\"branch_result\"] for branch in branches_context].count(\"FAILURE\"))</code></td>\n</tr>\n</thead>\n</table>\n</li>\n</ol>\n<h2>Remove the loop from a step</h2>\n<ol>\n<li>Select the loop step.</li>\n<li>Click <b>Create Loop</b> <a class=\"image\" href=\"/file/images/f/fd/2018.02/OO_Designer/but_loop.png\" title=\"/file/images/f/fd/2018.02/OO_Designer/but_loop.png\"> <img alt=\"but loop.png\" data-file-height=\"25\" data-file-width=\"23\" height=\"25\" src=\"../../../images/but_loop_db8f6425.png\" width=\"23\"/> </a>  in the Authoring pane toolbar.</li>\n<li>From the menu that appears, click the selected option to clear it.</li>\n</ol>\n<h2>Related topics</h2>\n<ul>\n<li>To create or edit a flow, see <a href=\"/doc/423/26.1/newflow\" title=\"SMAX:25.1/NewFlow\">Create or edit a flow</a>.</li>\n<li>To create steps in a flow, see <a href=\"/doc/423/26.1/createstepsflow\" title=\"SMAX:25.1/CreateStepsFlow\">Create steps in a flow</a>.</li>\n</ul>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}