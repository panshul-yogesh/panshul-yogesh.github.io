{
  "title": "Create NFS volumes for Audit",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>To install the Audit service, you need to export NFS volumes to store the application data.</p>\n<p><span style=\"color: rgb(0, 115, 231); font-family: Roboto, sans-serif; font-size: 24px;\">Create NFS volumes</span></p>\n<ol>\n<li>Create an NFS directory for Audit by running the following command:\n\t<pre>mkdir -p /var/vols/itom/audit/&lt;Audit Namespace&gt;/vault\nmkdir -p /var/vols/itom/audit/&lt;Audit Namespace&gt;/log</pre>\n\twhere, <em>&lt;Audit Namespace&gt;</em> is the namespace where you deploy the Audit service.<br/>\n\tFor example,\n\t<pre>mkdir -p /var/vols/itom/audit/auditns/vault\nmkdir -p /var/vols/itom/audit/auditns/log</pre>\n</li>\n<li>Change the permission for the directory that you have created by running the following command:\n\t<pre>chmod g+ws /var/vols/itom/audit/&lt;Audit Namespace&gt;/vault\nchmod g+ws /var/vols/itom/audit/&lt;Audit Namespace&gt;/log\n</pre>\n\tFor example,\n\n\t<pre>chmod g+ws /var/vols/itom/audit/auditns/vault\nchmod g+ws /var/vols/itom/audit/auditns/log\n</pre>\n</li>\n<li>Change the owner of the directory you have created by running the following commands:\n\t<pre>chown <b>&lt;user&gt;</b>:<b>&lt;fsGroup&gt;</b>/var/vols/itom/audit/&lt;Audit Namespace&gt;/vault\nchown <b>&lt;user&gt;</b>:<b>&lt;fsGroup&gt;</b>/var/vols/itom/audit/&lt;Audit Namespace&gt;/log</pre>\n\tThe values of <code>&lt;user&gt;</code> and <code>&lt;fsGroup&gt;</code> configured here must be the same as the values for the <strong>global.securityContext.user</strong> (default:1999) and<b> global.securityContext.fsGroup</b> (default:1999) parameters when you create your custom <strong>my-values.yaml</strong> file for the Audit service deployment in the later step. The following are two examples. <br/>\n\tExample 1 (using their default value 1999): \n\t<pre>chown 1999:1999 /var/vols/itom/audit/auditns/vault\nchown 1999:1999 /var/vols/itom/audit/auditns/log</pre>\n\tExample 2 (using 100001 for <strong>global.securityContext.user </strong>and 200001 for <b>global.securityContext.fsGroup)</b>:\n\n\t<pre>chown 100001:200001 /var/vols/itom/audit/auditns/vault\nchown 100001:200001 /var/vols/itom/audit/auditns/log</pre>\n</li>\n<li>To export the NFS directory, add the following line to the <strong>/etc/exports</strong> file:\n\t<pre>/var/vols/itom/audit/&lt;Audit Namespace&gt; *(rw,sync,anonuid=<b>&lt;user&gt;</b>,anongid=<b>&lt;fsGroup&gt;</b>,root_squash)</pre>\n<br/>\n\tHere are two examples:\n\t<pre>/var/vols/itom/audit/auditns *(rw,sync,anonuid=1999,anongid=1999,root_squash)</pre>\n<pre>/var/vols/itom/audit/auditns *(rw,sync,anonuid=100001,anongid=200001,root_squash)</pre>\n</li>\n<li>Run the following command to export the folder:\n\t<pre>exportfs -ra</pre>\n</li>\n<li>Check the exported NFS volumes:\n\t<pre>showmount -e</pre>\n</li>\n</ol>\n<h2>Audit NFS volumes</h2>\n<p>You require the following NFS volumes for the Audit deployment. Make sure the exported NFS volumes are empty and have no data.</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Component</th>\n<th scope=\"col\">Persistent volume name</th>\n<th scope=\"col\">Description</th>\n<th scope=\"col\">Example directory path</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Audit</td>\n<td><strong>as-vault-volume-&lt;Audit Namespace&gt;</strong></td>\n<td>Stores Audit configuration files.</td>\n<td>/var/vols/itom/audit/auditns/vault</td>\n</tr>\n<tr>\n<td>Audit</td>\n<td><strong>as-log-volume-&lt;Audit Namespace&gt;</strong></td>\n<td>Stores logs generated by Audit.</td>\n<td>/var/vols/itom/audit/auditns/log</td>\n</tr>\n</tbody>\n</table>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}