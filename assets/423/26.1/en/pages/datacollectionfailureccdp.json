{
  "title": "Cloud Cost Data collection failure for a cloud providers",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>Cost data collection fails for the integration between Cloud Cost Data Provider and a Cloud Provider.</p>\n<h2 id=\"Cause\">Cause</h2>\n<p>Communication failure between <strong>Showback</strong> and <strong>RabbitMQ</strong> services</p>\n<h2 id=\"Solution\">Solution</h2>\n<p>Follow one of the two methods given below to confirm that the failure to collect data is due to a communication failure between <strong>Showback</strong> and <strong>RabbitMQ</strong> services.</p>\n<h3>Locate and review the most recent logs to confirm the communication failure between Showback and RabbitMQ services</h3>\n<ol>\n<li>Log in to the NFS server and navigate to <code>&lt;logging-volume&gt;/cgro/showback/&lt;namespace&gt;/&lt;namespace&gt;__&lt;showback-pod&gt;__&lt;showback-container&gt;__&lt;hostname&gt;</code>.</li>\n<li>\n<p>View the file <code>hcm-showback.log</code> and look for entries as below related to communication issues between <strong>Showback</strong> and <strong>RabbitMQ</strong>.  If the logs are present, execute the solution documented below.</p>\n<pre>    .. 12 common Trames omitted \nCaused by: com.rabbitmq.client.ShutdownSignalException: connection error; protocol method: tmethod&lt;connection.close(reply-code=530, reply-text-NOT_ALLOWED - vhost itom.cmp not found, class-id-10, method-id-40)\n\nat com.rabbitmq.utility.ValueOr Exception.getValue(ValueOrException.java:66) \nat com.rabbitmq.utility.BlockingValueOrException.uninterruptibleGetValue(BlockingValueOrException.java:36) \nat com.rabbitmq.client.impl.AMQChannel $BlockingRpcContinuation.getReply (AMQChannel.java:502) \nat com.rabbitmq.client.impl.AMQChannel. privaterpc (AMQChannel.java:293) \nat com.rabbitmq.client.impl. AMQChannel.exnwrappingRpc(AMQChannel.java:141) \n... 18 common frames omitted\n\n2021-10-08 14:24:13.269 INFO 1 --- [org.springframework.amqp.rabbit. RabbitListener EndpointContainer#0-206] o.s.a.r.c.CachingConnectionFactory : Attempting to connect to: [itom-xruntime-rabbitmq-svc:5672] \n2021-10-08 14:24:13.280 WARN 1 --- [AMQP Connection 10.0.125.171:5672] c.r.c.impl. ForgivingExceptionHandler : An unexpected connection driver error occured (Exception message: Socket closed) \n2021-10-08 14:24:18.291 INFO 1 --- [org.springframework.amqp.rabbit. RabbitListener EndpointContainer#0-206] o.s.a.r.1. SimpleMessageListenerContainer : Restarting Consumer@4262449b: tags-[[]), channel-null, acknowledgeMode-AUTO local queue size=0 \n2021-10-08 14:24:18.292 INFO 1 --- [org.springframework.amqp.rabbit. RabbitListener EndpointContainer#0-207] o.s.a.r.c.CachingConnectionFactory : Attempting to connect to: [itom-xruntime-rabbitmq-svc:5672] \n2021-10-08 14:24:18. 301 ERROR 1 --- [org.springframework.amqp.rabbit. RabbitListener EndpointContainer#0-207] 0.5.a.r.1. SimpleMessageListenerContainer : Failed to check/redeclare auto-delete queue(s).   \n    </pre>\n</li>\n</ol>\n<h3>Verify if data collection is done for the Cloud cost provider</h3>\n<ol>\n<li>Log in to NFS server and navigate to <code>&lt;config-volume&gt;/data/cgro/showback/demo-collection</code>.</li>\n<li>No collection has taken place if the directory <code>demo-collection</code> is empty. Execute the solution documented below. </li>\n</ol>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-important-icon\"></div>\n<div class=\"admonition-content admonition-important-content\">If you have configured a remote NFS server during the installation of ESM, then you should mount the NFS file system onto one of the master node servers in your Kubernetes Cluster to continue with the solution section. </div>\n</div>\n<h3>Solution</h3>\n<ol>\n<li>\n<p>Run the following commands to rerun the <code>cmp-bootstrap</code> job by performing helm upgrade:</p>\n<pre><code>helm get values &lt;ESM_RELEASE_NAME&gt; -n &lt;ESM_NAMESPACE&gt; &gt; my-values.yaml\nhelm upgrade &lt;ESM_RELEASE_NAME&gt; &lt;ESM_CHART_FILE&gt; -n &lt;ESM_NAMESPACE&gt; -f my-values.yaml</code></pre>\n<p>Delete and reconfigure the Cloud Cost Data Provider integration. The data collection should start after reconfiguring the integration.</p>\n</li>\n</ol>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}