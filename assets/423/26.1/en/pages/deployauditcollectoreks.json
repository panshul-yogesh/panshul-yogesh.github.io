{
  "title": "Deploy Audit collector on AWS (EKS)",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>This section provides the steps required to install the Audit collector.</p>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">Install and configure the Audit collector in each of the namespaces that contain the Audit producer services, for example, Service Management and UCMDB. The Audit collector requires the Audit producer file system and it will use the Audit producer PVC and subpath. </div>\n</div>\n<h2>Generate vault secrets</h2>\n<p>To generate vault secrets for the Audit collector chart, perform the following steps on the bastion node:</p>\n<ol>\n<li>\n<p>Navigate to the OPTIC Management Toolkit (OMT) installation directory:</p>\n<pre>cd OMT_External_K8s_2x.x-xxx/scripts/</pre>\n</li>\n<li>\n<p>Run the following command:</p>\n<pre>./gen_secrets.sh -n &lt;Audit Producer Namespace&gt; -c &lt;Audit Collector Chart File&gt; -o &lt;Secrets YAML File&gt;</pre>\n<p>where,</p>\n\t&lt;Audit Collector Namespace&gt; is the namespace in which the Audit Producer (for example, Service Management and UCMDB) is running.<br/>\n\t&lt;Audit Collector Chart File&gt; is the tar file containing the Audit collector installation charts (<strong>audit-collector-&lt;version&gt;.tgz</strong>).<br/>\n\t&lt;Secrets YAML File&gt; is the YAML file that stores the Audit collector secrets. Specify the file name (for example, <strong>audit-collector-secrets.yaml</strong>), and then the script will generate this YAML file after you run the script. You will need to use this file when you run the command to install the Audit collector.\n\n\t<p>For example:</p>\n<pre>/opt/cdf/scripts/gen_secrets.sh -n itsma-cfpni -c audit-collector-&lt;version&gt;.tgz -o audit-collector-secrets.yaml</pre>\n</li>\n<li>\n<p>The vault secret utility prompts you for the Audit collector integration user password: <strong>audit_collector_integration_user_pass_key</strong>.</p>\n</li>\n</ol>\n<h2>Install Audit collector</h2>\n<p>To complete the deployment, you will need to install the Audit collector using Helm.</p>\n<p>To install the audit collector, run the following command:</p>\n<pre>$helm install &lt;Audit Collector Release Name&gt; &lt;Audit Service Chart&gt; -n &lt;Audit Producer Namespace&gt; -f values.yaml -f audit-collector-secrets.yaml --set-file \"caCertificates.cert_one\\.crt\"=/path/to/cert_one.crt --set-file \"caCertificates.cert_two\\.crt\"=/path/to/cert_two.crt\n</pre>\n<p>Where:</p>\n<ul>\n<li><em>&lt;Audit Collector Release Name&gt; </em>is the unique release name that you need to specify for the Audit collector deployment. You need to use the same release name as specified here when you upgrade the Audit collector in the future.<em> </em></li>\n<li><em>&lt;Audit Collector Chart&gt;</em> is the tar file containing the Audit collector installation charts.</li>\n<li><em>&lt;Audit Producer Namespace&gt;</em> is the namespace where the Audit producer is running.</li>\n<li><em>&lt;Values YAML File&gt;</em> is your <b>values.yaml </b>file with properties configured for the Audit collector deployment.</li>\n<li><em>&lt;Audit Collector Secrets YAML file&gt;</em> is the file that gen_secret script generates and holds the Audit collector secrets.</li>\n<li>The certificates are passed by using the --set-file option. In the below example, you can see suite and the Audit service certificates are passed.</li>\n</ul>\n<p>For example:</p>\n<pre>$helm install audit-collector audit-collector-&lt;version&gt;.tgz -n itsma-cfpni -f values.yaml -f audit-collector-secrets.yaml --set-file \"caCertificates.idm\\.crt\"=idm.crt --set-file \"caCertificates.auditservice\\.crt\"=ase.crt</pre>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}