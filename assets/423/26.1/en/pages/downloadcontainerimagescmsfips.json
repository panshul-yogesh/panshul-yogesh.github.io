{
  "title": "Download and upload container images for UD/UCMDB (FIPS mode)",
  "content": "<div class=\"mw-parser-output\"><p>Before you deploy the suite, you need to download the required images from Docker Hub or other registries and then upload the images to your registry.</p><div class=\"Admonition_Note\"><b>Note</b> If you have already uploaded images to your registry, skip this step.</div><h2 id=\"Generate_the_Image_Set\">Generate the Image Set</h2><div class=\"transcontent stn-begin--forcmsupgrade1\"></div><span class=\"snippet-start\" data-sname=\"423-25.4-423-25.3-TextSnippets|generate_download|N\"></span><div class=\"Admonition_Note\"><strong>Note:</strong> To follow the steps in this section, you must have installed the <code>zip</code> Linux command on the node where you run the <code>generate_download_bundle.sh</code> script.</div><p><br/></p><span class=\"snippet-end\" data-sname=\"423-25.4-423-25.3-TextSnippets|generate_download|N\"></span><p>Before downloading and uploading the images, you need to generate the image set with the following steps on the bastion node:</p><ol><li><p><span id=\"cke_bm_21676C\" style=\"display: none;\"> </span>Run the following command to navigate to the UD/UCMDB helm chart directory of the downloaded UD/UCMDB helm chart package:</p><pre>cd &lt;UD/UCMDB helm chart directory&gt;</pre><p>For example:</p><pre>cd UCMDB_Helm_Chart-2x.x/ucmdb-helm-charts</pre><!--cke_bookmark_305S--><!--cke_bookmark_305E--></li><li><p>Copy the following content to a text editor such as Notepad without any auto-formatting, and then change the UD/UCMDB helm chart package name (<strong>ucmdb-1.xx.x-xxx+2x.x.x.tgz </strong>in the command) to the exact name of the package:</p><div class=\"Admonition_Note\"><span class=\"autonumber\">Note</span>: Only update the helm chart package name and keep the rest of the content as is. For the secrets part, you don't need to specify any real password at the moment and \"clear=dummy_password\" is just used as a placeholder value to pass the download bundle check.</div><pre>cat ./samples/values-fips-with-smax.yaml &gt; gdb_tmp.yaml\n\nsed -i 's/externalAccessHost: \"\"/externalAccessHost: \"dummy.com\"\\n  ignorePwdCheck : true/g' gdb_tmp.yaml\nsed -i 's/acceptEula: false/acceptEula:  true/g' gdb_tmp.yaml\nsed -i 's/dbName:/dbName:  dummydb/g' gdb_tmp.yaml\nsed -i 's/idmAuthUrl:/idmAuthUrl:  dummy.com/g' gdb_tmp.yaml\n\n$CDF_HOME/tools/generate-download/generate_download_bundle.sh -C ./charts/<strong><span style=\"background-color:#dddddd;\">ucmdb-1.xx.x-xxx+2x.x.x.tgz</span></strong> -H gdb_tmp.yaml -S\n</pre></li><li><p>Paste the content that you updated in step 2 to the command line, and then press <strong>Enter</strong> to run the commands.</p><p>After executing the commands, the system displays the following messages indicating that you have successfully generated the <strong>offline-download.zip</strong> file in the current working directory:</p><pre>2023-01-05 18:12:59 INFO generate offline-download.zip from ./charts/cms-1.x.0+2x.x.xxx.tgz  \n2023-01-05 18:12:59 INFO Rendering chart..................................................... [OK]\n2023-01-05 18:13:09 INFO offline-download.zip is generated under /UCMDB_Helm_Chart-2x.x/ucmdb-helm-charts  \n2023-01-05 18:13:09 INFO For more details, please refer: /opt/cdf/log/generate_download_bundle/generate_download_bundle.202x0105181259.log \n</pre>\n\tThe <strong>offline-download.zip</strong> file contains a list of the required images and will be used when you run the Python script to transfer the suite images in the later step.<br/>\n\tAfter you successfully run the commands, you can delete the <strong>gdb_tmp.yaml </strong>file. </li><li>Unzip the <strong>offline-download.zip</strong> file and copy the <strong>/offline-download/image-set.json </strong>file to the <i>&lt;</i><b><code><i>OMT_External_K8s_2x.x-xxx&gt;</i>/scripts/</code> </b>directory.</li></ol><div class=\"transcontent stn-end--forcmsupgrade1\"></div><h2>Download the required installation images</h2><span class=\"snippet-start\" data-sname=\"423-25.4-423-25.3-UploadImagestoExternalRegistry|DownloadImages|N\"></span><ol><li>Log on to the first control plane node or the bastion node. If that node can't access Docker Hub, transfer the  <code>offline-download.zip</code>  file to a Linux server that can access Docker Hub.</li><li>Extract the .zip package to a directory. If you can't access Docker Hub directly, set up the HTTP/HTTPS proxy. For example, run the following commands to set the HTTP/HTTPS proxy. Replace the placeholders with your actual server and port. <br/><code>export http_proxy=\"&lt;http://PROXY_SERVER:PORT&gt;\"<br/>\n\texport https_proxy=\"&lt;https://PROXY_SERVER:PORT&gt;\"</code></li><li>Go to the directory you extracted the <code>offline-download.zip</code> package into.</li><li>Run the following command:<br/>\n\t \n\t<pre><code>./downloadimages.sh -u &lt;username&gt;  -d &lt;image download directory&gt; -c on|off -o &lt;org name&gt;</code></pre><p>\tWhere:\n</p><ul><li>Replace &lt;<i>username</i>&gt; with the Docker Hub username.</li><li>If you don't specify the credentials here, you will be prompted to specify them when you run the command.</li><li>&lt;<em>image download directory</em>&gt;: The directory where the container images will be downloaded. The default value is /var/opt/cdf/offline.</li><li>The <code>-c</code> option is used to verify the digital signature of the images during the download. The default setting is off, which doesn't verify the signature.</li><li><code>&lt;org name&gt;</code>: The organization in the image registry that contains the images for installation. By default, this is <code>hpeswitom.</code> This option is mandatory if you aren't using the default organization name.</li></ul></li></ol><p>To see the full list of options for the <code>downloadimages.sh</code> command, run the following command:<br/><code>./downloadimages.sh –h</code><br/>\nThe command also has a <code>-p</code> option to provide your password. The <code>-p</code>  option doesn't support single quotes (don't include single quotes in the password).</p><div class=\"Admonition_Note\"><p><span class=\"autonumber\">Note:</span> OpenText encourages you to use some other password options, which aren't provided by OpenText. By implementing the -p option, you may expose the system to increased security risks. You understand and agree to assume all associated risks and hold OpenText harmless for the same. It remains at all times your sole responsibility to assess its own regulatory and business requirements. OpenText doesn't represent or warrant that its products comply with any specific legal or regulatory standards applicable to you in conducting your business.</p></div><p><br/></p><span class=\"snippet-end\" data-sname=\"423-25.4-423-25.3-UploadImagestoExternalRegistry|DownloadImages|N\"></span><h2 id=\"Download_and_upload_images\">Upload images</h2><span class=\"snippet-start\" data-sname=\"423-25.4-423-25.3-EKSDownloadImage|EKSUploadImages|N\"></span><p>Follow these steps to upload the installation images to your external image registry:</p>\n<ol>\n<li>Log on to one of the bastion nodes. The node must be able to connect to the external registry.</li>\n<li>Run the following commands to retrieve the username and password of ECR.\n\t<p>Make sure you have already installed AWS CLI version 2 when <a href=\"/doc/423/25.1/eksbastion#Configure_the_bastion_instance\" title=\"configuring bastion\">configuring bastion</a>:</p>\n<pre>ecrUserName=AWS\necrUserPassword=$(aws ecr get-login-password)\necrURL=&lt;aws_account_id&gt;.dkr.ecr.&lt;region&gt;.amazonaws.com</pre>\n<p>Where: &lt;region&gt; is your AWS region. </p>\n</li>\n<li>Go to the directory you extracted the <code>offline-download.zip</code> package into.</li>\n<li>Run the following command to upload the suite images to the external registry:\n\t<pre>./uploadimages.sh -r $ecrURL -u $ecrUserName -p $ecrUserPassword -d &lt;image download directory&gt; -o &lt;org name&gt; <code>--cleanup --</code>aws-region &lt;region&gt;</pre>\n<p>\tWhere:\n</p>\n<ul>\n<li><code>&lt;<em>image download directory</em>&gt;</code>: The directory to which you downloaded the container images. The default value is <code>/var/opt/cdf/offline</code>. Specify the <code>-d </code> option if the images aren't in the <code>/var/opt/cdf/offline/</code> directory. You can use the <code>-d</code> option multiple times when the images are in different directories. The images can be the images downloaded by <code>downloadimages.sh</code>. Make sure the image file type matches the file extension. </li>\n<li><code>&lt;<em>org name</em>&gt;</code>: The organization in the image registry that contains the images for installation. By default, this is <code>hpeswitom.</code> This option is mandatory if you aren't using the default organization name.</li>\n<li><code>--cleanup</code>: Delete the image source folder to save disk space. It only works when all images are uploaded successfully.</li>\n<li>&lt;<code>region</code>&gt;: is your AWS region (default: \"us-east-1\"). </li>\n</ul>\n<p>To see the full list of options for the <code>uploadimages.sh</code> command, run the following command:<br/>\n<br/>\n<code>./uploadimages.sh -h </code></p>\n</li>\n<li>Wait until the images are successfully uploaded. Your terminal should resemble the following:\n\t<pre>Upload-process successfully completed.\n</pre>\n</li>\n</ol>\n<p><br/>\n</p><span class=\"snippet-end\" data-sname=\"423-25.4-423-25.3-EKSDownloadImage|EKSUploadImages|N\"></span></div>",
  "modifiedon": "2025-10-24 08:51:12"
}