{
  "title": "Use case: back up and restore",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p lang=\"en-US\">The backup and restore solution for all deployments provides the details to create your Disaster Recovery Plan (DRP), including the procedures to back up data and handle specific disaster scenarios. </p>\n<p lang=\"en-US\">This use case describes how a fictional company (Example Corp.) creates its DRP from scratch, performs the first and routine backup tasks, and successfully restores the suite in the event of service interruption.</p>\n<p lang=\"en-US\">The chart below gives an overview of how Example Corp executes its DRP flow.</p>\n<p lang=\"en-US\"><a class=\"image\" href=\"/file/images/b/bd/DR-design-flow-v3.png\" title=\"/file/images/b/bd/DR-design-flow-v3.png\"> <img alt=\"\" border=\"0\" file=\"/mediawiki/images/b/bd/DR-design-flow-v3.png\" height=\"534\" hspace=\"0\" src=\"../../../images/DR-design-flow-v3_70e95a19.png\" style=\"width: 800px; height: 534px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/> </a></p>\n<h2 lang=\"en-US\">Personas</h2>\n<p>The following personas are involved in creating and implementing DRP.</p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\">\n<thead>\n<tr>\n<th scope=\"col\">Name</th>\n<th scope=\"col\">Role</th>\n<th scope=\"col\">Responsibilities</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\n<p><strong>Steve</strong></p>\n</td>\n<td>\n<p>Suite administrator</p>\n</td>\n<td>\n<ul>\n<li>Investigate and create DRP.</li>\n<li>Get informed when disaster happens.</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td>\n<p><b>Eve</b></p>\n</td>\n<td>\n<p>Cloud administrator</p>\n</td>\n<td>\n<ul>\n<li>Set up Velero (Only applicable for managed kubernetes)</li>\n<li>Coordinate with other administrators in backup and restoration tasks.</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td><strong>Monica</strong></td>\n<td>Kubernetes administrator</td>\n<td>\n<ul>\n<li>Perform and manage backups of Kubernetes configurations.</li>\n<li>Restore Kubernetes configurations when disaster happens.</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td>\n<p><b>Peter</b></p>\n</td>\n<td>\n<p>Database administrator</p>\n</td>\n<td>\n<ul>\n<li>Perform and manage the first and routine backups of database data.</li>\n<li>Restore database data when disaster happens.</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td>\n<p><strong>Sam</strong></p>\n</td>\n<td>\n<p>Storage administrator</p>\n</td>\n<td>\n<ul>\n<li>Perform and manage the first and routine backups of file storage data.</li>\n<li>Restore file storage when disaster happens.</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<h2>Prerequisites</h2>\n<p>The suite is up and running in a Kubernetes environment. To perform restoration steps, you also need to make sure:</p>\n<ul>\n<li>The source and target environments must be hosted on the same platform.</li>\n<li>The Kubernetes versions in both environments must be the same.</li>\n</ul>\n<h2 lang=\"en-US\">Create Disaster Recovery Plan</h2>\n<p lang=\"en-US\">Steve is the suite administrator of Example Corp. After considering the business requirements and company SLA, he identifies four possible disaster scenarios and sets Recovery Time Objective (RTO) and Recovery Point Objective (RPO) as below:</p>\n<p lang=\"en-US\">For RTO:</p>\n<ul>\n<li>Scenario1 (Kubernetes configuration corruption): <strong>10 minutes</strong>.</li>\n<li>Scenario 2 (storage data corruption): <strong>2 hours</strong>.</li>\n<li>Scenario 3 (database data corruption): <strong>30 minutes</strong>. </li>\n<li>Scenario 4 (Kubernetes cluster crash): <strong>half a day</strong> for setting up new system +  <strong>20 minutes</strong> for configuration recovery.</li>\n</ul>\n<p lang=\"en-US\">RPO is set to <strong>8 hours</strong> and database and file storage data should be backed up every <strong>7 hours</strong> in the <strong>same cadence</strong>. Since the Kubernetes configuration is seldom changed, it should be backed up only when there is a change.</p>\n<p lang=\"en-US\">He also involves all stakeholders in an exclusive communication channel called <em>DRResponse</em>. DRP details are fully discussed and related training is delivered through the channel.</p>\n<p lang=\"en-US\">For more details on how to create DRP, see <a href=\"/doc/423/26.1/backuprestorehandbook\">Overview of backup and restore</a>.</p>\n<h2 lang=\"en-US\">Set up Velero </h2>\n<div class=\"Admonition_Note\"><strong>Note</strong>  This step is only applicable for managed Kubernetes.</div>\n<p lang=\"en-US\">To back up and restore Kubernetes configurations, Eve as the cloud administrator sets up Velero as instructed at <a href=\"/doc/423/26.1/installveleromanagedk8s\">Set up Velero</a>.</p>\n<h2 lang=\"en-US\">First backup</h2>\n<p lang=\"en-US\">The first backup includes three parts:</p>\n<ul>\n<li lang=\"en-US\">Kubernetes administrator Monica backs up all Kubernetes configurations as instructed at <a href=\"/doc/423/26.1/smabackupprocedure\">Back up Kubernetes configurations</a>.</li>\n<li lang=\"en-US\">Database administrator Peter backs up all database data by following <a href=\"/doc/423/26.1/smabackupprocedure\">Back up database data</a>. For example, for the suite on AWS, he creates an <a href=\"https://docs.aws.amazon.com/aws-backup/latest/devguide/create-on-demand-backup.html\">on-demand backup</a> of RDS data from the AWS Backup console (https://console.aws.amazon.com/backup). </li>\n<li lang=\"en-US\">Storage administrator Sam backs up all storage data by following <a href=\"/doc/423/26.1/smabackupprocedure\">Back up storage data</a>. For example, for the suite on AWS, he creates an <a href=\"https://docs.aws.amazon.com/aws-backup/latest/devguide/create-on-demand-backup.html\">on-demand backup</a> of EFS data from the AWS Backup console (https://console.aws.amazon.com/backup).</li>\n</ul>\n<h2 lang=\"en-US\">Routine backup</h2>\n<p lang=\"en-US\">Based on DRP requirements, Example Corp schedules its routine backups as below:</p>\n<ul>\n<li lang=\"en-US\">There is no routine backup of Kubernetes configuration as it's rarely changed. Monica backs up all Kubernetes configurations as instructed at <a href=\"/doc/423/26.1/smabackupprocedure\">Back up Kubernetes configurations</a> only when it's updated.</li>\n<li lang=\"en-US\">Eve works together with Peter and Sam to schedule routine backups of database and storage data. For example, for the suite on AWS, they create a <a href=\"https://docs.aws.amazon.com/aws-backup/latest/devguide/create-a-scheduled-backup.html\">scheduled backup plan</a> for RDS and EFS from the AWS Backup console (https://console.aws.amazon.com/backup).\n\t<ol start=\"1\">\n<li lang=\"en-US\">They create a <strong>rule</strong> of backing up every <strong>7 hours</strong> based on RTO.</li>\n<li>Since database and storage need to be backed up in the same cadence, they <strong>assign both EFS and RDS </strong>to the same backup plan. </li>\n</ol>\n</li>\n</ul>\n<h2 lang=\"en-US\">Test and adjust Disaster Recovery Plan</h2>\n<p lang=\"en-US\">To test the validity of DRP, Steve simulates a disaster scenario where database data has been deleted accidentally. Steve informs the <em>DRResponse</em> channel and Peter immediately helps to <a href=\"/doc/423/26.1/databasedatacorrupted\">restore the database data</a> backed up 7 hours ago.</p>\n<p lang=\"en-US\">However, Steve and Peter find that they are too optimistic about their tolerance of data loss in disasters. After discussion, they adjust RPO to <strong>6 hours</strong>. Peter works together with Eve and Sam to update the backup plan rule accordingly. Now database and file storage data should be backed up every <strong>5 hours</strong>.</p>\n<h2 lang=\"en-US\">When a disaster happens</h2>\n<p lang=\"en-US\">An actual disaster happens to Example Corp. Its database data has been corrupted and business is thus interrupted. Steve is informed of the incident and instantly releases the news in <em>DRResponse</em> channel. Peter restores the database data to the latest backup and business is back to normal. </p>\n<p lang=\"en-US\">For the restoration procedures in different scenarios, see:</p>\n<ul>\n<li><a href=\"/doc/423/26.1/restorekubernetesconfig\">Scenario 1: Kubernetes configurations have been corrupted</a></li>\n<li><a href=\"/doc/423/26.1/storagedatacorrupted\">Scenario 2: Persistent storage data has been corrupted</a></li>\n<li><a href=\"/doc/423/26.1/databasedatacorrupted\">Scenario 3: Databases data has been corrupted</a></li>\n<li><a href=\"/doc/423/26.1/kubernetesclustercrashed\">Scenario 4: Kubernetes cluster has crashed</a></li>\n</ul>\n<p lang=\"en-US\"></p>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}