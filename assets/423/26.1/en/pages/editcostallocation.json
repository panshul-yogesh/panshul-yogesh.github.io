{
  "title": "Edit a cost allocation rule",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><div id=\"tag-premium\"></div>\n<p>You can edit multiple records simultaneously by selecting them in the grid and updating them in the Preview pane on the right. For more information, see <a href=\"/doc/423/26.1/editrecpreview#Mass\" title=\"SMAX:25.1/EditRecPreview\">Mass update</a>.</p>\n<ol>\n<li>\n<p>From the main menu, select <b>Run &gt; Financials &gt; Cost Allocation</b>. The Cost Allocation page opens.</p>\n</li>\n<li>Click the record identifier in the <b>ID</b> column to display the selected record.</li>\n<li>\n<p>Click the tab you want to view or edit. The General tab is displayed by default.</p>\n<table>\n<tbody>\n<tr>\n<th>Tab</th>\n<th>Description</th>\n</tr>\n<tr>\n<td>General</td>\n<td>Displays details of the selected record. For more information, see the <strong>General tab</strong> section.</td>\n</tr>\n<tr>\n<td>Workflow</td>\n<td>Displays the workflow for the selected record. For more information about the workflow, see <a href=\"/doc/423/26.1/costallocationwflw\" title=\"SMAX:25.1/BudgetLineWflw\">Cost allocation workflow</a>.</td>\n</tr>\n<tr>\n<td>Allocation</td>\n<td>Displays details of the generated expense lines. For more information, see the <strong>Allocation tab</strong> section.</td>\n</tr>\n<tr>\n<td>Discussions</td>\n<td>Displays any relevant conversations about the selected record. For more information about discussions, see <a href=\"/doc/423/26.1/discussions\" title=\"SMAX:25.1/Discussions\">Discussions</a>.</td>\n</tr>\n<tr>\n<td>History</td>\n<td>Displays changes to the selected record. For more information about history, see <a href=\"/doc/423/26.1/history\" title=\"SMAX:25.1/History\">History</a>.</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<p>Save your changes.</p>\n</li>\n</ol>\n<h2 id=\"General_tab\">General tab</h2>\n<p>This tab includes the following sections.</p>\n<h3 id=\"Details\">Overview</h3>\n<table>\n<tbody>\n<tr>\n<th>Field</th>\n<th>Description</th>\n</tr>\n<tr>\n<td>Rule type</td>\n<td>Displays the type of the cost allocation rule.</td>\n</tr>\n<tr>\n<td>Parent type</td>\n<td>Displays the record type to which the cost allocation rule applies.</td>\n</tr>\n<tr>\n<td>Display label</td>\n<td>External (common) name of the cost allocation rule.</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Description that captures the details of the cost allocation rule.</td>\n</tr>\n<tr>\n<td>Start date</td>\n<td>Specify a date that the cost allocation rule becomes effective.</td>\n</tr>\n<tr>\n<td>End date</td>\n<td>Specify a date that the cost allocation rule becomes ineffective.</td>\n</tr>\n<tr>\n<td>Owner</td>\n<td>Owner of the cost allocation rule.</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"Attachments\">Condition</h3>\n<p>Enter an expression in the Filter field to add conditions for the cost allocation rule.</p>\n<p>For example, if you want to create a cost allocation rule to generate expense lines to track recurring costs, you can limit to the record with a recurring cost value, add the condition as below:</p>\n<p><code>${entity.RecurringCost != null }</code></p>\n<h2>Allocation tab</h2>\n<p>The following modes are available for the fields in this tab:</p>\n<ul>\n<li><b>Simple Mode.</b> Enter the default value in the text box, or for a list, select a value from the drop-down list, or select or deselect an option field.</li>\n<li><b>Expression Language Mode.</b> Enter an Expression Language phrase that returns the default value.</li>\n</ul>\n<p>Click the <b>Expression Language</b>  <a class=\"image\" href=\"/file/images/thumb/f/f3/SMAiconfx.png/30px-SMAiconfx.png\" title=\"/file/images/thumb/f/f3/SMAiconfx.png/30px-SMAiconfx.png\"> <img alt=\"SMAiconfx.png\" data-file-height=\"75\" data-file-width=\"79\" height=\"28\" src=\"../../../images/30px-SMAiconfx_894ae630.png\" width=\"30\"/> </a>  button to toggle between these options. When the button is selected (blue), the field is in Expression Language mode. When it's not selected (white), the field is in Simple mode. For a full list of Expression Language functions, see <a href=\"/doc/423/26.1/explangfunctions\" title=\"SMAX:25.1/ExpLangFunctions\">Expression Language functions and syntax</a>. Note that \"-\" isn't supported in the expression in this tab.</p>\n<p>This tab includes the following sections.</p>\n<h3 id=\"Details\">Expense information</h3>\n<table>\n<tbody>\n<tr>\n<th>Field</th>\n<th>Description</th>\n</tr>\n<tr>\n<td>Initial amount</td>\n<td>Amount of the expense line for a one-time cost allocation rule or amount of the initial expense line for a recurring cost allocation rule.</td>\n</tr>\n<tr>\n<td>Currency</td>\n<td>Currency of the expense line.</td>\n</tr>\n<tr>\n<td>Expense date</td>\n<td>\n<p>Expense date of the generated expense line.</p>\n<p>If this field is empty, the system would use the date when the expense line is generated as the expense date.</p>\n</td>\n</tr>\n<tr>\n<td>Recurring</td>\n<td>\n<p>Select this check box to generate expense lines for recurring costs based on the recurring period.</p>\n<ul>\n<li>For an expense allocation rule, an expense plan is created in the backend to generate recurring expense lines and the expense lines scheduled in the current fiscal year are generated.</li>\n<li>For a chargeback allocation rule, two expense plans are created in the backend to generate recurring expense lines and the expense lines scheduled in the current fiscal year are generated.</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td>Recurring amount</td>\n<td>Amount of the recurring expense lines.</td>\n</tr>\n<tr>\n<td>Recurring period</td>\n<td>\n<p>Define the sequence of the recurring expense lines generation. It should be the same as the recurring period of the record type usually.</p>\n<p>You can also enter the following values in Simple mode:</p>\n<ul>\n<li>WEEKLY</li>\n<li>MONTHLY</li>\n<li>YEARLY</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td>Recurring start</td>\n<td>\n<p>Specify a date when the recurring starts. This field is used to generate the expense date for the recurring expense lines. For example, if the recurring start date is September 1st, 2020 and the recurring period is MONTHLY, the expense date for the recurring expense lines would be October 1st, November 1st, December 1st, and so on.</p>\n<p>If this field is empty, the system would use the date when the expense line is generated as the recurring start date.</p>\n</td>\n</tr>\n<tr>\n<td>Recurring end</td>\n<td>Specify a date when the recurring ends.</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"Attachments\">Debit</h3>\n<p>Cost center and cost type for the debit expense line. In Simple mode, you can select the cost center and cost type from the drop-down list.</p>\n<h3>Credit (Expense allocation rule only)</h3>\n<p>Cost center and cost type for the credit expense line. In Simple mode, you can select the cost center and cost type from the drop-down list.</p>\n<p>Activate the cost allocation rule after you enter values for all mandatory fields.</p>\n<h2>Trigger the cost allocation rule</h2>\n<p>Besides the configuration of the cost allocation rules, Allocate cost and Cancel cost rules for the record types should also be set up to trigger or stop the expense line generation. You can contact your tenant administrator to enable the out-of-the-box Allocate cost and Cancel cost rules or create customized rules based on your business requirements in Studio.</p>\n<p>To successfully generate expense lines based on the configured cost allocation rules, make sure:</p>\n<ul>\n<li>The cost allocation rule is active.</li>\n<li>The cost allocation rule is effective when the rule is triggered.</li>\n<li>The expense date is equal to or greater than the date when the rule is triggered.</li>\n</ul>\n<p>You can view all expense lines generated in <a href=\"/doc/423/26.1/expenselines\">Expense lines</a> or expense lines associated with a certain record on the record's detail page.</p>\n<h2>Example: generate recurring expense lines on devices based on an out-of-the-box cost allocation rule</h2>\n<p>To generate chargeback expense lines when a device is In use:</p>\n<ol>\n</ol>\n<p>Financial manager configures the cost allocation rule:</p>\n<ol>\n<li>From the main menu, select <b>Run &gt; Financials &gt; Cost Allocation</b>.</li>\n<li>Click the out-of-the-box rule \"CAR for device direct assignment recurring\" to view the details.\n\t<p><a class=\"image\" href=\"/file/images/0/0c/SMAX_202011_ootbcondition.png\" title=\"/file/images/0/0c/SMAX_202011_ootbcondition.png\"> <img alt=\"\" border=\"0\" file=\"/mediawiki/images/0/0c/SMAX_202011_ootbcondition.png\" height=\"70\" hspace=\"0\" src=\"../../../images/SMAX_202011_ootbcondition_ff2fc7ba.png\" style=\"width: 800px; height: 70px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/> </a></p>\n<p>The condition indicates that this rule works on the device records whose:</p>\n<ul>\n<li>\n<p>phase is in \"In use\"</p>\n</li>\n<li>\n<p>value for Recurring charge field isn't empty</p>\n</li>\n</ul>\n<p><a class=\"image\" href=\"/file/images/b/bd/SMAX_202011_ootbchargeback.png\" title=\"/file/images/b/bd/SMAX_202011_ootbchargeback.png\"> <img alt=\"\" border=\"0\" file=\"/mediawiki/images/b/bd/SMAX_202011_ootbchargeback.png\" height=\"300\" hspace=\"0\" src=\"../../../images/SMAX_202011_ootbchargeback_dc2656a2.png\" style=\"width: 800px; height: 300px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/> </a></p>\n\tThe allocation tab displays detailed information about how to generate expense lines according to the cost information on the device records.</li>\n<li>Move this cost allocation to Active.</li>\n</ol>\n<p>Tenant admin enables the out-of-the-box Allocate cost and Cancel cost rule for the device records in Studio:</p>\n<ol>\n<li>From the main menu, select <b>Administration &gt; Configuration &gt; Studio</b>.</li>\n<li>Select Device from the drop-down box at the top of the screen and select the <b>Processes and Rules</b> tab.</li>\n<li>\n<p>Under the After Applying changes event, enable the rule If <code>${current_update.PhaseId.IsChanged &amp;&amp; current_update.PhaseId.NewValue =='pInUse'} and </code></p>\n<p><code>${current_update.PhaseId.IsChanged &amp;&amp; current_update.PhaseId.OldValue =='pInUse' &amp;&amp;(current_update.PhaseId.NewValue =='pPrepare' || current_update.PhaseId.NewValue =='pRetire')}</code>, click <strong>Save</strong>.</p>\n</li>\n</ol>\n<p>When a device is transitioned to In use phase, the following expense lines are generated:</p>\n<ul>\n<li>A debit expense line allocated to the device owner's cost center, with the device's initial charge as the amount</li>\n<li>A credit expense line allocated to the device's cost center, with the device's initial charge as the amount </li>\n<li>Recurring debit expense lines allocated to the device owner's cost center in the current fiscal year, with the device's recurring charge as the amount</li>\n<li>Recurring credit expense lines allocated to the device's cost center in the current fiscal year, with the device's recurring charge as the amount</li>\n</ul>\n<p>When a device is transitioned to Prepare or Retire phase from In use, the generated expense lines that are in Projected status are deleted.</p>\n<h2 id=\"Related_topics\">Related topics</h2>\n<ul>\n<li><a href=\"/doc/423/26.1/explang\">Expression language</a></li>\n<li><a href=\"/doc/423/26.1/expenselines\">Expense lines</a></li>\n<li><a href=\"/doc/423/26.1/processcontracts\">Contract process - Business rules</a></li>\n<li><a href=\"/doc/423/26.1/processdevice\">Device process - Business rules</a></li>\n<li><a href=\"/doc/423/26.1/processip\">Infrastructure &amp; peripheral process - Business rules</a></li>\n<li><a href=\"/doc/423/26.1/processlicense\">License process - Business rules</a></li>\n<li><a href=\"/doc/423/26.1/processsubscription\">Subscription process - Business rules</a></li>\n<li><a href=\"/doc/423/26.1/noexpenselinegenerated\">Expense lines aren't generated as expected</a></li>\n</ul>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}