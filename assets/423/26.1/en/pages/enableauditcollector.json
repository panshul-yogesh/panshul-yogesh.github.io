{
  "title": "Enable Audit collector",
  "content": "<div class=\"mw-parser-output\">\n<p>Services that are integrated with the Audit service store the audits on the NFS file system when the audit service isn't reachable. Audit collector is a microservice that collects the audits from the NFS file system and passes them to the Audit service via REST.</p>\n<p>This section describes the steps to install the Audit collector.</p>\n<h2><a id=\"Prerequisite\" name=\"Prerequisite\" title=\"Prerequisite\"></a>Prerequisite</h2>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">You must have already installed the audit service.  For more information, see <a href=\"/doc/423/26.1/installauditservice\" title=\"(Optional) Install the Audit service on-premises\">(Optional) Install the Audit service on-premises</a> and <a href=\"/doc/423/26.1/createauditdeploymenteks\" title=\"Install the Audit service on AWS (EKS)\">Install the Audit service on AWS (EKS)</a>.</li><li style=\"margin-left: 28px; position: relative;\">You must have completed the Enable Audit procedure.</li></ul>\n<h2><a id=\"Configure_values_yaml_for_Audit_collector\" name=\"Configure_values_yaml_for_Audit_collector\" title=\"Configure values.yaml for Audit collector\"></a>Configure values.yaml for Audit collector</h2>\n<div>Follow the steps to configure values.yaml file</div>\n<h3><a id=\"Export_the_Audit_service_engine_certificate\" name=\"Export_the_Audit_service_engine_certificate\" title=\"Export the Audit service engine certificate\"></a> Export the Audit service engine certificate</h3>\n<p>To enable the audit collector to connect to the Audit service, you need to import the Audit service engine certificate.</p>\n<p>It's highly recommended that you get the correct Root CA certificate from the engineer who creates and administers the Audit service deployment. If this isn't possible, you can export the Root CA certificate from the browser as follows.</p>\n<ol style=\"padding-left: 0px;\" type=\"1\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Open the Audit engine URL in a web browser: <code>https://&lt;auditEngineHostname&gt;:&lt;auditEnginePort&gt;/audit-service-engine</code>. The values of <code><em>&lt;auditEngineHostname&gt;</em></code> and<em> <code>&lt;auditEnginePort&gt;</code></em>will correspond to the values of these properties in the <strong>create_secret.yaml</strong> file (audit client configuration file) that you will be creating later.</p>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Export the certificate (for example, <strong>audit.cer</strong>) in the base-64 encoding format. As an example, the following are steps in Google Chrome:</p>\n<ol style=\"padding-left: 0px;\" type=\"1\"><li style=\"--number-width: 21px; --number-spacing: 25px; margin-left: 49px; position: relative;\">\n<p>Click the lock icon before the URL on the address bar.</p>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<p>Click <strong>Certificate</strong>.</p>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<p>On the <strong>Certification Path</strong> tab, select the site <strong>root </strong>certificate (the topmost one), and then click <strong>View Certificate</strong>. If this tab shows only one certificate, the <strong>View Certificate</strong> option isn't available and you need to directly go to the next step.</p>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<p>On the <strong>Details</strong> tab, click <strong>Copy to File</strong>.</p>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<p>In the <strong>Certificate Export Wizard</strong>, click<strong> Next</strong>.</p>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<p>Select the <strong>Base-64 encoded X.509 (.CER)</strong> format, and click <strong>Next</strong>.</p>\n</li><li style=\"--number-width: 23px; --number-spacing: 27px; margin-left: 51px; position: relative;\">\n<p>Follow the rest of the instructions and export the certificate.</p>\n</li></ol>\n</li></ol>\n<h3><a id=\"Edit_the_auditCollector_values_yaml_file\" name=\"Edit_the_auditCollector_values_yaml_file\" title=\"Edit the auditCollector-values.yaml file\"></a> Edit the auditCollector-values.yaml file</h3>\n<p>Go to the <code>ESM_Helm_Chart-2x.x.x/samples/</code> directory, and edit the <code>auditCollector-values.yaml</code> file by including the following parameters.</p>\n<h3><a id=\"IdM_user_configuration\" name=\"IdM_user_configuration\" title=\"IdM user configuration\"></a>IdM user configuration</h3>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Required</strong></th>\n<th><strong>Default</strong></th>\n<th><strong>Example</strong></th>\n</tr>\n<tr>\n<td><code>auditCollector.idm.integrationUser</code></td>\n<td>\n<style type=\"text/css\">a {\n    text-decoration: none;\n    color: #464feb;\n}\ntr th, tr td {\n    border: 1px solid #e6e6e6;\n}\ntr th {\n    background-color: #f5f5f5;\n}\n\t\t\t</style>\n<div>The user responsible for sending audit data to the Audit service may be the same as the integration user of the Audit producer. This user must be a member of the administrator group in IdM. Additionally, make sure that this user's password is configured to never expire.</div>\n</td>\n<td>Yes</td>\n<td>Not defined</td>\n<td>suite-admin</td>\n</tr>\n<tr>\n<td><code>auditCollector.idm.integrationUserOrgName</code></td>\n<td>The organization that the integration user belongs to.</td>\n<td>Yes</td>\n<td>Not defined</td>\n<td>sysbo</td>\n</tr>\n</thead>\n<tbody>\n</tbody>\n</table>\n<h3><a id=\"Audit_engine_configuration\" name=\"Audit_engine_configuration\" title=\"Audit engine configuration\"></a>Audit engine configuration</h3>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Required</strong></th>\n<th><strong>Default</strong></th>\n<th><strong>Example</strong></th>\n</tr>\n<tr>\n<td>auditCollector.auditengine.url</td>\n<td>The audit engine URL: <code>https://&lt;Audit FQDN:Audit engine port&gt;/audit-service-engine</code>. You don't need to specify the audit engine port if it is set to 443.</td>\n<td>Yes</td>\n<td>Not defined</td>\n<td>https://internal.com:443/audit-service-engine</td>\n</tr>\n</thead>\n<tbody>\n</tbody>\n</table>\n<h3><a id=\"Audit_collector_NFS_configuration\" name=\"Audit_collector_NFS_configuration\" title=\"Audit collector NFS configuration\"></a>Audit collector NFS configuration</h3>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Required</strong></th>\n<th><strong>Default</strong></th>\n<th><strong>Example</strong></th>\n</tr>\n<tr>\n<td><code>auditCollector.nfs.subpath</code></td>\n<td>The subPath refers to the directory or subPath of the PVC path. For instance, if the PVC points to <code>/var/vols/itom/itsma/global-volume</code> and the subPath is designated as audit, the Audit collector will gather the files from the NFS path <code>/var/vols/itom/itsma/global-volume/audit</code>. The Audit producer is responsible for creating this path.\n\t\t\t<p>For example, by default, SMAX uses the <strong>&lt;global-volume&gt;/audit </strong>directory, and CMS uses the <strong>&lt;log-volume&gt;/ucmdb/audit </strong>directory on its NFS server as a fallback to store audits when audits don't get pushed to the audit engine. For more information, see <a href=\"/doc/128/26.1/administerauditfilesonnfs\" title=\"Administer audit files on the audit client NFS server\">Administer audit files on the audit client NFS server</a>.</p>\n</td>\n<td>Yes</td>\n<td>Not defined</td>\n<td>audit</td>\n</tr>\n</thead>\n<tbody>\n</tbody>\n</table>\n<h3><a id=\"Audit_collector_chart_deployment\" name=\"Audit_collector_chart_deployment\" title=\"Audit collector chart deployment\"></a>Audit collector chart deployment</h3>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Required</strong></th>\n<th><strong>Default</strong></th>\n<th><strong>Example</strong></th>\n</tr>\n<tr>\n<td><code>global.services.auditCollector.deploy</code></td>\n<td>This flag enables the deployment of the Audit collector chart</td>\n<td>Yes</td>\n<td>false</td>\n<td>true</td>\n</tr>\n</thead>\n<tbody>\n</tbody>\n</table>\n<h3><a id=\"Audit_collector_integration_user_password\" name=\"Audit_collector_integration_user_password\" title=\"Audit collector integration user password\"></a>Audit collector integration user password</h3>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Required</strong></th>\n<th><strong>Default</strong></th>\n<th><strong>Example</strong></th>\n</tr>\n<tr>\n<td><code>auditCollector.secrets. audit_collector_integration_user_pass_key</code></td>\n<td>Audit collector integration user password with base64 encoded</td>\n<td>Yes</td>\n<td>Not defined</td>\n<td>\n<p>QWRtaW4xMjM0Cg==</p>\n<p>For Admin1234 password after encoding</p>\n</td>\n</tr>\n</thead>\n<tbody>\n</tbody>\n</table>\n<h3><a id=\"Audit_service_certificate\" name=\"Audit_service_certificate\" title=\"Audit service certificate\"></a><a id=\"Audit_collector_user_credentials\" name=\"Audit_collector_user_credentials\" title=\"Audit collector user credentials\"></a>Audit service certificate</h3>\n<table>\n<thead>\n<tr>\n<th><strong>Parameter</strong></th>\n<th><strong>Description</strong></th>\n<th><strong>Required</strong></th>\n<th><strong>Default</strong></th>\n<th><strong>Example</strong></th>\n</tr>\n<tr>\n<td><code>auditCollector.caCertificates</code></td>\n<td>To integrate with Audit Service, please create a copy of the Audit Service certificate under this section</td>\n<td>Yes</td>\n<td>Not defined</td>\n<td><a class=\"image\" href=\"\"> <img alt=\"usercredentialssm\" src=\"../../../images/Picture1_8ae072c3.png\" style=\"width:602px;height:373px\"/> </a></td>\n</tr>\n</thead>\n<tbody>\n</tbody>\n</table>\n<h3><a id=\"Apply_changes_to_service_management\" name=\"Apply_changes_to_service_management\" title=\"Apply changes to service management\"></a><a id=\"Apply_the_changes\" name=\"Apply_the_changes\" title=\"Apply the changes\"></a>Apply changes to service management</h3>\n<p>Apply the changes and import the Audit certificate to Service Management</p>\n<p>Perform the following steps on the control plane node or the bastion node.</p>\n<ol style=\"padding-left: 0px;\" type=\"1\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Get your my-values.yaml file:</p>\n<pre><code>helm get values &lt;ESM_Release_Name&gt; -n &lt;ESM namespace&gt; &gt; my-values.yaml</code></pre>\n\t \n\n\t<p>where: &lt;ESM Release_name&gt; is the unique release name of the ESM deployment.<br/>\n\t </p>\n</li></ol>\n<ol start=\"2\" style=\"padding-left: 0px;\" type=\"1\"><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Run a Helm upgrade:<br/>\n\t </p>\n<pre><code>helm upgrade &lt;ESM_Release_Name&gt; &lt;ESM_CHART_FILE&gt; -n &lt;ESM namespace&gt; -f &lt;my-values.yaml&gt; -f &lt; auditCollector-values.yaml &gt;</code></pre>\n<p><br/>\n\t </p>\n</li></ol>\n<h3><a id=\"Related_topics\" name=\"Related_topics\" title=\"Related topics\"></a>Related topics</h3>\n<p><a href=\"/doc/423/26.1/enableaudit\" target=\"_blank\" title=\"Enable audit\">Enable audit</a></p>\n</div>",
  "modifiedon": "2025-12-10 04:36:19"
}