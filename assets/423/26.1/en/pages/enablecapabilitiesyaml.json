{
  "title": "Create a values.yaml file to enable capabilities after installation",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>To enable an OMT capability after installation, you will upgrade a Helm chart. To do this, you must create a file that contains the information needed to configure the chart. Usually, this file is called <code>values.yaml</code>. Chart file names resemble <code>apphub-1.18.0+202xxxxx.xxxx.tgz</code>. You can find charts in the <code>$CDF_HOME/charts</code> directory (for example, <code>/opt/cdf/charts/apphub-1.18.0+202xxxxx.xxxx.tgz</code>), and also in the OMT installation package.</p>\n<p>To enable the capability, you run the <code>helm upgrade</code> command together with options to specify the chart that you want to upgrade, and the configuration file. For example:</p>\n<pre><code>helm upgrade -n core apphub apphub-1.18.0+20210500.1161.tgz --install --reuse-values -f values.yaml</code></pre>\n<div class=\"Admonition_Important\"><strong>Important:</strong> The <code>--reuse-values</code> flag in this command ensures that only values specified in the <code>values.yaml</code> file are updated in the chart. If you don't set this flag, the <code>helm upgrade</code> command overwrites all values in the chart that aren't specified in the <code>values.yaml</code> file with their default values.</div>\n<p>In some scenarios (for example, when you deploy OMT with all capabilities disabled), the AppHub chart isn't installed when you deploy OMT. In this case, you'll need to run the <code>helm install</code> command to install the chart. And, because some configuration information is mandatory for a first installation, you must enter all the required information in the <code>values.yaml</code> file (whereas, when you run the <code>helm upgrade</code> command you need only enter information for the new configuration). For example:</p>\n<pre><code>helm install -n core apphub apphub-1.18.0+20210500.1161.tgz -f values.yaml</code></pre>\n<p>This topic describes the most common items that you'll need to configure in the chart. These are shared by multiple capabilities, and are found in the <code>global</code> configuration section of the chart. To see all available configurable items, refer to the default <code>values.yaml</code> file in the chart package. Note, however, that some configurations in the default <code>values.yaml</code> file are for internal use only, and we recommend that you don't change the default values. For information about the specific configurations required to enable each capability, refer to the specific topics for those capabilities.</p>\n<h2>Capabilities</h2>\n<p>In AppHub chart, four keys configure the OMT capabilities: </p>\n<ul>\n<li><code>deploymentManagement</code></li>\n<li><code>clusterManagement</code></li>\n<li><code>monitoring</code></li>\n<li><code>logCollection</code></li>\n</ul>\n<p>Enable different capabilities to deploy different components. You can enable one or more capabilities by setting the corresponding value to <code>true</code> or <code>false</code> to disable the capability. </p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 500px;\">\n<thead>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default value</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\n<p><code>global.services.deploymentManagement</code></p>\n</td>\n<td colspan=\"1\"><strong>true</strong></td>\n<td>Deploys the components that deploy apps.</td>\n</tr>\n<tr>\n<td>\n<p><code>global.services.clusterManagement</code></p>\n</td>\n<td colspan=\"1\"><strong>false</strong></td>\n<td>Deploys the components that manage the Kubernetes cluster.</td>\n</tr>\n<tr>\n<td>\n<p><code>global.services.monitoring</code></p>\n</td>\n<td colspan=\"1\"><strong>false</strong></td>\n<td>Deploys the components that collect and display metrics data.</td>\n</tr>\n<tr>\n<td colspan=\"1\">\n<p><code>global.services.logCollection</code></p>\n</td>\n<td colspan=\"1\"><strong>false</strong></td>\n<td colspan=\"1\">Deploys the components that collect and rotate logs.</td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content that enables only the monitoring content:</p>\n<pre><code>global:\n  services:\n    deploymentManagement: false\n    clusterManagement: false\n    monitoring: true\n    logCollection: false</code></pre>\n<h2>External access</h2>\n<p>If you enable the deployment management, cluster management, or monitoring capabilities, you must set external access to the OMT services.</p>\n<table>\n<tbody>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default value</th>\n<th>Description</th>\n</tr>\n<tr>\n<td><code>global.externalAccessHost</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td>Externally accessible hostname or FQDN. This could be the hostname of a load balancer or another valid hostname to access the cluster.</td>\n</tr>\n<tr>\n<td><code>global.externalAccessPort</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td>Externally accessible port for the access host.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>caCertificates.CUS_ca.crt</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The custom CA certificate for external access. The value of this key should match the value of the <code>tls.cert</code> key. If not set, OMT will use the internal self-signed certificate. The certificate must be <code>base64</code> encrypted.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.tls.cert</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The custom server certificate for external access. The value of this key should match the values of the <code>caCertificates.CUS_ca.crt</code> and <code>tls.key keys</code>. If not set, OMT will use the internal self-signed certificate. The certificate must be <code>base64</code> encrypted.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.tls.key</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The custom server key for external access. The value of this key should match the value of the <code>tls.cert</code> key. The certificate must be <code>base64</code> encrypted.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.setFqdnInIngress</code></td>\n<td colspan=\"1\"><strong>false</strong></td>\n<td colspan=\"1\">If <strong>true</strong>, the external access host will be set to the host field of all ingress resources. Usually just use the default value. </td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content to configure external access to OMT through <code>https://omtdemo.mycompany.net:5443</code>.</p>\n<pre><code>global:\n  externalAccessHost: omtdemo.mycompany.net\n  externalAccessPort: 5443</code></pre>\n<h2>Image registry</h2>\n<p>The following configurations are mandatory for all capabilities to pull Docker images.</p>\n<table>\n<tbody>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default Value</th>\n<th>Description</th>\n</tr>\n<tr>\n<td><code>global.docker.registry</code></td>\n<td colspan=\"1\"><strong>localhost:5000</strong></td>\n<td>The Docker registry URL.</td>\n</tr>\n<tr>\n<td><code>global.docker.orgName</code></td>\n<td colspan=\"1\"><strong>hpeswitom</strong></td>\n<td>The Docker registry organization name.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.docker.imagePullSecret</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">\n<p>The name of the secret used to log in to the Docker registry.</p>\n</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.docker.tlsCert</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The CA certificate of the Docker registry for truststore. Usually, there's no need to set this.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.docker.imagePullPolicy</code></td>\n<td colspan=\"1\"><strong>IfNotPresent</strong></td>\n<td colspan=\"1\">The Docker image pull policy.</td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content to configure an external registry:</p>\n<pre><code>global:\n  docker:\n    imagePullSecret: registrypullsecret\n    orgName: hpeswitom\n    registry: gcr.io</code></pre>\n<h2>Persistent Volume Claims</h2>\n<p>All capabilities require persistent storage. You will have to create a maximum of three Persistent Volume Claims (PVCs) if all capabilities are enabled. A fourth PVC is created by the chart automatically for the monitoring capability. You don't need to configure it in the <code>values.yaml</code> file, but will have to create a Persistent Volume (PV) for it if you enable monitoring.</p>\n<p>The AppHub chart won't create the PVs for the capabilities. You must first create them yourself, and then use the chart create the PVCs and bind them to each PV. Set the <code>global.persistence.enabled</code> key to <strong>true</strong> and leave the three PVC names empty. The chart automatically generates the names. Or, you can instead create the PVCs yourself and bind them to PVs manually. In this situation, you must set the existing PVC names to the corresponding values.</p>\n<table>\n<tbody>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default value</th>\n<th>Description</th>\n</tr>\n<tr>\n<td><code>global.persistence.enabled</code></td>\n<td colspan=\"1\"><strong>true</strong></td>\n<td>\n<p>If set to <strong>true</strong>, the following PVCs will be automatically created by the chart. </p>\n<p>If set to <strong>false</strong>, you must create the PVCs and specify the names below.</p>\n<p>We recommend that you use the chart create the PVCs automatically.</p>\n</td>\n</tr>\n<tr>\n<td><code>global.persistence.storageClasses.default-rwx</code></td>\n<td colspan=\"1\"><strong>cdf-default</strong></td>\n<td>The default <code>storageClassName</code> for the PVs and PVCs with <code>ReadWriteMany</code> mode. Usually you can use the default value.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.persistence.dataVolumeClaim</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">\n<p>The PVC for storing core OMT data. This PVC is required by the cluster management, deployment management, and monitoring capabilities.</p>\n</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.persistence.logVolumeClaim</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The PVC for storing OMT log files. This PVC is required by all capabilities.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.persistence.dbVolumeClaim</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The PVC for storing database data. This PVC is required when the cluster management or deployment management capabilities are enabled and the internal database is used.</td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content that lets you create the PVCs manually, and in which you use an external database (no need to create a <code>dbVolumeClaim</code> PVC):</p>\n<pre><code>global:\n  persistence:\n    enabled: false\n    dataVolumeClaim: itom-vol-claim\n    logVolumeClaim: logging-vol\n    dbVolumeClaim:</code></pre>\n<div class=\"Admonition_Important\"><strong>Important: </strong>You must create enough corresponding PVs before you create the PVCs. Otherwise, the PVCs are pending for looking up available PVs. </div>\n<h3>Create Persistent Volumes</h3>\n<p>You also use a YAML file to create PVs. You can use the following template:</p>\n<pre><code># This is the core data volume needed by cluster management, deployment management, and monitoring.\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: apphub-data-vol\nspec:\n  accessModes:\n  - ReadWriteMany\n  capacity:\n    storage: 5Gi\n  claimRef:\n    apiVersion: v1\n    kind: PersistentVolumeClaim\n    name: apphub-datavolumeclaim\n    namespace: core\n  nfs:\n    path: /var/vols/itom/core\n    server: 192.0.2.0\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: cdf-default\n  volumeMode: Filesystem\n\n# This is the logging volume needed by all capabilities; it's always needed.\n---\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: apphub-log-vol\nspec:\n  accessModes:\n  - ReadWriteMany\n  capacity:\n    storage: 5Gi\n  claimRef:\n    apiVersion: v1\n    kind: PersistentVolumeClaim\n    name: apphub-logvolumeclaim\n    namespace: core\n  nfs:\n    path: /var/vols/itom/logging\n    server: 192.0.2.0\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: cdf-default\n  volumeMode: Filesystem\n\n# This is the database volume needed by cluster management and deployment management and when you use an internal database. It's not needed when an external database is used.\n---\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: apphub-db-vol\nspec:\n  accessModes:\n  - ReadWriteMany\n  capacity:\n    storage: 5Gi\n  claimRef:\n    apiVersion: v1\n    kind: PersistentVolumeClaim\n    name: apphub-dbvolumeclaim\n    namespace: core\n  nfs:\n    path: /var/vols/itom/database\n    server: 192.0.2.0\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: cdf-default\n  volumeMode: Filesystem\n\n# This is the monitoring volume needed by monitoring capability.\n---\napiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: apphub-monitor-vol\nspec:\n  accessModes:\n  - ReadWriteMany\n  capacity:\n    storage: 5Gi\n  claimRef:\n    apiVersion: v1\n    kind: PersistentVolumeClaim\n    name: prometheus-itom-prometheus-prometheus-db-prometheus-itom-prometheus-prometheus-0\n    namespace: core\n  nfs:\n    path: /var/vols/itom/monitor\n    server: 192.0.2.0\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: cdf-default\n  volumeMode: Filesystem</code></pre>\n<p>This template contains all the PVs that you need if you enable all capabilities.</p>\n<ul>\n<li>Edit the template according to the requirements of the capabilities that you enable.</li>\n<li>The <code>claimRef</code> is already set for each PV, so they will be bound to the corresponding PVCs created by the chart automatically. If you want to create the PVCs manually, the PVC name should be same as the name defined in <code>claimRef</code> in the YAML file.</li>\n<li>Replace the NFS path and server with the actual NFS configurations.</li>\n<li>The <code>storageClassName</code> must be same as the value of the <code>global.persistence.storageClasses.default</code> key in the<code> values.yaml</code> file, and the storage must be at least 5 GB.</li>\n<li>This template is for embedded Kubernetes environments. The PV definitions may be different for external Kubernetes. Update the definitions according to the requirements of your Kubernetes provider. </li>\n</ul>\n<p>When the YAML file is ready, run the following command to create the PVs:</p>\n<pre><code>kubectl create -f &lt;yaml file path&gt;</code></pre>\n<h2>User and group IDs</h2>\n<p>The user and group IDs (UID/GID) for runtime deployment, and ownership of persistent storage. </p>\n<table>\n<tbody>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default value</th>\n<th>Description</th>\n</tr>\n<tr>\n<td><code>global.securityContext.user</code></td>\n<td colspan=\"1\"><strong>1999</strong></td>\n<td>User ID that has ownership of persistent storage and runtime deployment.</td>\n</tr>\n<tr>\n<td><code>global.securityContext.fsGroup</code></td>\n<td colspan=\"1\"><strong>1999</strong></td>\n<td>Group ID that has ownership of persistent storage and runtime deployment.</td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content for OpenShift, where the user ID must fall within a limited range:</p>\n<pre><code>global:\n  securityContext:\n    user: 10006000\n    fsGroup: 10006000</code></pre>\n<div class=\"Admonition_Note\"><strong>Notes: </strong>Some Kubernetes providers, such as OpenShift, have restrictions on the permitted <code>user</code> and <code>fsGroup</code> values.</div>\n<h2>Admin Password</h2>\n<p>Mandatory for cluster management, deployment management, and monitoring. If the password contains special characters, add single quotes around it.</p>\n<table>\n<tbody>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default value</th>\n<th>Description</th>\n</tr>\n<tr>\n<td><code>global.apphubAdmin.userPassword</code></td>\n<td colspan=\"1\"><strong>somePassword</strong></td>\n<td>The Admin password for the Kubernetes cluster.</td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content:</p>\n<pre><code>global:\n  apphubAdmin:\n    userPassword: 'ashf@124!'</code></pre>\n<h2>Proxy</h2>\n<p>Only required when some internal services need to access outside services through a proxy. For example, if the log collection capability needs to output logs to an external ElasticSearch server, which is only accessible through proxy.</p>\n<table>\n<tbody>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default value</th>\n<th>Description</th>\n</tr>\n<tr>\n<td><code>global.proxy.httpsProxy</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td>Sets the <code>https_proxy</code> in the container.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.proxy.httpProxy</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">Sets the <code>http_proxy</code> in the container.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.proxy.noProxy</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">Sets the <code>no_proxy</code> in the container.</td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content:</p>\n<pre><code>global:\n  proxy:\n    httpsProxy: https://myproxy.com\n    httpProxy: http://myproxy.com\n    noProxy: localhost,127.0.0.1,.cluster.local</code></pre>\n<h2>Cluster</h2>\n<p>The following Kubernetes cluster information is mandatory for all capabilities.</p>\n<table>\n<tbody>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default value</th>\n<th>Description</th>\n</tr>\n<tr>\n<td><code>global.cluster.k8sProvider</code></td>\n<td colspan=\"1\"><strong>cdf</strong></td>\n<td>Defines the Kubernetes provider. For on-premises clusters, it can be <code>cdf</code>, <code>cdf-aws</code>, or <code>cdf-azure</code>. For external Kubernetes, it can be <code>aws</code>, <code>azure</code>, <code>gcp</code>, <code>openshift</code>, or <code>generic</code>.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.cluster.kubernetesDomain</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">Usually no need to set. If empty, the components will use <code>svc.cluster.local</code>, which is the default Kubernetes domain.</td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content:</p>\n<pre><code>global:\n  cluster:\n    ## classic: cdf cdf-aws cdf-azure,  BYOK: aws azure gcp generic openshift\n    k8sProvider: \"cdf\"\n    # Kubernetes cluster domain\n    # - default: svc.cluster.local\n    kubernetesDomain:</code></pre>\n<h2>Expose</h2>\n<p>The <code>expose</code> information used by the <code>nginx-ingress</code> services. </p>\n<table>\n<tbody>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default value</th>\n<th>Description</th>\n</tr>\n<tr>\n<td><code>global.expose.type</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td>The type of <code>nginx-ingress</code> service for external access. Valid value: <code>NodePort</code>, <code>ClusterIP</code>, <code>LoadBalancer</code>.<br/>\n\t\t\tIf not specified, the type of <code>nginx-ingress</code> service is determined according to the actual Kubernetes provider. For an external Kubernetes cluster, it’s usually <code>LoadBalancer</code>. For an embedded Kubernetes cluster, it’s usually <code>NodePort</code>.<br/>\n\t\t\tThe following parameters for <code>externalLoadBalancer</code> and <code>internalLoadBalancer</code> are only needed when the type is <code>LoadBalancer</code>.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.expose.externalLoadBalancer.ip</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The IP of the external load balancer. Not needed if the Kubernetes provider generates the IP automatically for the services. The value will be injected into the <code>loadBalancerIP</code> field of the <code>nginx-ingress</code> service.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.expose.externalLoadBalancer.sourceRanges</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The <code>sourceRanges</code> of the load balancer. The value will be injected into the <code>loadBalancerSourceRanges</code> field of the <code>nginx-ingress</code> service.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.expose.externalLoadBalancer.annotations</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">Annotations added to the <code>nginx-ingress</code> services.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.expose.externalLoadBalancer.externalIPs</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The <code>externalIPs</code> of the load balancer. The value will be injected into the <code>externalIPs</code> field of the <code>nginx-ingress</code> service.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.expose.internalLoadBalancer.ip</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The IP of the internal load balancer. Not needed if the Kubernetes provider generates the IP automatically for the services. The value will be injected into the <code>loadBalancerIP</code> field of the <code>nginx-ingress</code> service. It’s only valid when the internal <code>nginx-ingress</code> service is enabled and the type is <code>LoadBalancer</code>.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.expose.internalLoadBalancer.sourceRanges</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The <code>sourceRanges</code> of the load balancer. The value will be injected into the <code>loadBalancerSourceRanges</code> field of the <code>nginx-ingress</code> service. It’s only valid when the internal <code>nginx-ingress</code> service is enabled and the type is <code>LoadBalancer</code>.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.expose.internalLoadBalancer.annotations</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">Annotations added to the <code>nginx-ingress</code> services. It’s only valid when the internal <code>nginx-ingress</code> service is enabled and the type is <code>LoadBalancer</code>.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.expose.internalLoadBalancer.externalIPs</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The <code>externalIPs</code> of the load balancer. The value will be injected into the <code>externalIPs</code> field of the <code>nginx-ingress</code> service. It’s only valid when internal <code>nginx-ingress</code> service is enabled and the type is <code>LoadBalancer</code>.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.expose.ipConfig.ipFamilyPolicy</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">What <code>ipFamilyPolicy</code> should be used for the <code>nginx-ingress</code> service. If not specified, Kubernetes will decide which <code>ipFamiliyPolicy</code> should be used.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.expose.ipConfig.ipFamilies</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">Valid value: <code>ipv4</code>. If not specified, Kubernetes will decide which <code>ipFamily</code> should be used.</td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content for AWS:</p>\n<pre><code>global:\n  expose:\n    externalLoadBalancer:\n      annotations:\n        cdf.ingress.deployments.microfocus.com/creator: install\n        service.beta.kubernetes.io/aws-load-balancer-internal: \"true\"\n        service.beta.kubernetes.io/aws-load-balancer-type: nlb\n      sourceRanges:\n      - 172.20.0.0/16\n    ipconfig:\n      ipFamilyPolicy: PreferDualStack\n      ipFamilies:\n      - ipv4\n</code></pre>\n<h2>Database</h2>\n<p>Database information is mandatory for the deployment management and cluster management capabilities.</p>\n<p>The keys below configure the global database used by components including the <code>cdf-apiserver</code>, <code>idm</code>, and <code>apphub-apiserver</code> services. By design, the <code>idm</code> and <code>apphub-apiserver</code> services use the same database and user, and the <code>cdf-apiserver</code> service uses a different database and user. You can set the connection information by using these keys because all components use the same database host. However, the actual name, schema, and database user for each component aren't same. Therefore, the same database configuration structure appears under each component in the chart. You can set the common connection information by using global keys, and set the configurations specific to each components by using the keys under each component. The chart always prioritizes the information specified for a component over information specified in the global configurations. For example, you could set the database host by using the<code> global.database.host</code> key (because it's shared by all components), set the database name of the <code>cdf-apiserver</code> service by using the <code>cdfapiserver.deployment.database.dbName</code>key, and set the database name of the <code>idm</code> and <code>apphub-apiserver</code> services by using the <code>global.database.dbName</code> key (because these services use the same database). However, we recommend that you set the database information under each component to keep the logic of the <code>values.yaml</code> file simple. For example, set values in both the <code>idm.deployment.database.dbName</code> and <code>apphub-apiserver.deployment.database.dbName</code> keys, even though the value of both keys is the same. </p>\n<table>\n<tbody>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default value</th>\n<th>Description</th>\n</tr>\n<tr>\n<td><code>global.database.internal</code></td>\n<td colspan=\"1\"><strong>false</strong></td>\n<td>This key specifies whether OMT uses the embedded database. If set to <strong>true</strong>, the chart generates all the connection data automatically, and you can use the default values for the later keys (except for <code>createDb</code>). If set to <strong>false</strong>, you must enter the external database information in the later keys.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.createDb</code></td>\n<td colspan=\"1\"><strong>false</strong></td>\n<td colspan=\"1\">If set to <strong>true</strong>, every service will create the database, schema, and users automatically. You must enter the admin user and password. If set to <strong>false</strong>, you must create the database, schema, and user manually. For embedded database, this key must be <strong>true</strong>. You can't set this key to <strong>true</strong> if you use an Oracle database.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.admin</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The username of the admin user who has permission to create the database, schema, and user. You must enter a value if <code>createDb</code> is <strong>true</strong>.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.adminPassword</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The username of the admin user. You must enter a value if <code>createDb</code> is <strong>true</strong>.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.type</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The supported database type: this can be either <strong>postgresql</strong> or <strong>oracle</strong>. If left empty the chart uses PostgreSQL.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.host</code></td>\n<td colspan=\"1\"><strong>itom-postgresql</strong></td>\n<td colspan=\"1\">The database host. <b>itom-</b><b>postgresql</b><b> </b>is the default service name of the embedded database. When you use an external database, set this key to the actual hostname or IP address. If you use the embedded database, use the default value.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.port</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The port number of the database host. You must enter a value when you use an external database. If you use the embedded database, use the default value.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.user</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">You must enter a value when you use an external database. If <code>createDb</code> is <strong>true</strong>, this is the name of the user that the chart creates automatically for the admin user. If <code>createDb</code> is <strong>false</strong>, specify an existing user name.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.userPassword</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">You must enter a value when you use an external database. If <code>createDb</code> is <strong>true</strong>, this is the password of the user that the chart creates automatically for the admin user. If <code>createDb</code> is <strong>false</strong>, specify the password for the existing user.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.dbName</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">If <code>createDb</code> is set to <strong>true</strong>, this is the name of the database that the chart creates automatically for the admin user. If <code>createDb</code> is <strong>false</strong>, specify the name of an existing database.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.schema</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The schema of the database.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.oracleConnectionString</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The connection string, if you have one. Otherwise, use host and port.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.oracleServiceName</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">Oracle service name.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.oracleSid</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">The Oracle SID.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.tlsEnabled</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">If TLS is enabled for the database, set to <strong>true</strong>. Empty means \"false\". For the embedded database, use the default value.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.tlsCert</code></td>\n<td colspan=\"1\">&lt;empty&gt;</td>\n<td colspan=\"1\">If <code>tlsEnabled</code> is <strong>true</strong>, set a value for <code>tlsCert</code>. This is the CA certificate, which should be a <code>base64 </code>encrypted certificate. </td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.database.tlsSkipHostnameVerification</code></td>\n<td colspan=\"1\"><strong>false</strong></td>\n<td colspan=\"1\">If you set the value to <strong>true</strong>, OMT services won't verify the database hostname with the subject names in the server certificate and they will only verify the CA certificate of the database server.</td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content to configure an external Oracle database.</p>\n<pre><code>global:\n  database:\n    createDb: false\n    host: example.dbhost.net\n    internal: false\n    oracleSid: ORCL\n    port: \"2484\"\n    type: oracle\n    dbName: defaultdb\n    schema: \"\"\n    user: idm\n    userPassword: idmPasswd</code></pre>\n<h2>Monitoring content</h2>\n<p>When you enable the monitoring capability, the components and embedded contents of the Prometheus chart are deployed. However, some monitoring content provided by OMT isn't included in the Prometheus chart. The following configurations are needed to deploy this additional content. </p>\n<table>\n<tbody>\n<tr>\n<th>Key</th>\n<th colspan=\"1\">Default value</th>\n<th>Description</th>\n</tr>\n<tr>\n<td><code>global.prometheus.deployPrometheusConfig</code></td>\n<td colspan=\"1\"><strong>false</strong></td>\n<td>If set to <strong>true</strong>, deploys the additional Prometheus content provided by OMT.</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.prometheus.deployGrafanaConfig</code></td>\n<td colspan=\"1\"><strong>false</strong></td>\n<td colspan=\"1\">\n<p>If set to <strong>true</strong>, deploys the additional Grafana dashboards provided by OMT.</p>\n</td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.prometheus.prometheusSelector</code></td>\n<td colspan=\"1\"><strong>prometheus_config: \"1\"</strong></td>\n<td colspan=\"1\">The label selector used by Prometheus to get the expected content. It's only needed when you use a third party Prometheus instance to monitor OMT metrics. Usually just use the default value. </td>\n</tr>\n<tr>\n<td colspan=\"1\"><code>global.prometheus.grafanaSelector</code></td>\n<td colspan=\"1\"><strong>grafana_dashboard: \"1\"</strong></td>\n<td colspan=\"1\">The label selector used by Grafana to get the expected dashboards. It's only needed when you use a third party Grafana instance to display OMT metrics. Usually just use the default value. </td>\n</tr>\n</tbody>\n</table>\n<p>Example <code>values.yaml</code> file content:</p>\n<pre><code>global:\n  prometheus:\n    deployPrometheusConfig: true\n    deployGrafanaConfig: true</code></pre>\n<h2></h2>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}