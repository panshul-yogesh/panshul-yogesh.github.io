{
  "title": "Enable a firewall after installation",
  "content": "<div class=\"mw-parser-output\"> <div class=\"transcontent stn-begin--body\"> </div>\n<p>If your firewall was disabled during the suite installation and needs to be enabled after installation, follow the instructions below to enable the firewall on the suite nodes that are up and running.</p>\n<ol>\n<li>On the control plane node, go to the <code>$CDF_HOME/scripts</code> directory, and run the following command to stop the SMA suite pods:\n\n\t<pre>./cdfctl.sh runlevel set -l DOWN -n &lt;namespace&gt;</pre>\n<p>Where: <code>&lt;namespace&gt;</code> is your suite namespace (for example, <code>itsma1</code>).</p>\n<p>You can use the global option <code>-f</code> to show more logs during the stop process.</p>\n</li>\n<li>Stop the OMT Kubernetes system on the control plane node:\n\t<pre>cd <code>$CDF_HOME</code>/bin \n./kube-stop.sh\n</pre>\n</li>\n<li>Enable the firewall on the control plane node:\n\t<pre>systemctl start firewalld</pre>\n<p>If you have already run firewalld before and want to clear the iptables rules, see the \"How to clear iptables rules on each SMA node\" section in this document.</p>\n</li>\n<li>Configure firewall rules for the required ports of the control plane node. For details, see the \"Related topics\" section.</li>\n<li>Disable SELINUX:\n\t<pre>vim /etc/selinux/config\nSELINUX=disabled\n</pre>\n</li>\n<li>Reboot the host:\n\t<pre>reboot -i</pre>\n</li>\n<li>Restart Kubernetes:\n\t<pre>cd <code>$CDF_HOME</code>/bin\n./kube-start.sh\n</pre>\n</li>\n<li>Check the Kubernetes status:\n\t<pre>./kube-status.sh</pre>\n<p>Wait until all pods are in green status.</p>\n</li>\n<li>Enable SELINUX:\n\t<pre>vim /etc/selinux/config\nSELINUX=enforcing\n</pre>\n<p>Run the command below for the SELINUX setting to take effect:</p>\n<pre>setenforce 1</pre>\n</li>\n<li>Make sure that DOCKER rules are created after the docker-bootstrap service is up and running:\n\t<pre>iptables -S|grep DOCKER</pre>\n</li>\n<li>Repeat steps 3-10 on the rest of the control plane nodes and worker nodes.</li>\n<li>Navigate to the <code>$CDF_HOME/scripts</code> directory, and run the following command to start the suite pods:\n\t<pre>./cdfctl.sh runlevel set -l UP -n &lt;namespace&gt;</pre>\n<p>Where: <code>&lt;namespace&gt;</code> is your suite namespace (for example, <code>itsma1</code>).</p>\n<p>You can use the global option <code>-f</code> to show more logs during the start process.</p>\n</li>\n</ol>\n<h3 class=\"mw-headline\" id=\"How_to_clear_iptables_rules_on_each_SMA_node\">How to clear iptables rules on each SMA node</h3>\n<p>To clear iptables rules, follow these steps:</p>\n<ol>\n<li>Stop the SMA suite pods if they are running by running the following commands on any control plane node:\n\t<pre>cd $CDF_HOME/scripts\n./cdfctl.sh runlevel set -l DOWN -n &lt;namespace&gt;\n</pre>\n</li>\n<li>Stop the OMT Kubernetes system:\n\t<pre>cd <code>$CDF_HOME</code>/bin\n./kube-stop.sh\n</pre>\n</li>\n<li>Stop the firewall if it's already running, and clear the rules:\n\t<pre>systemctl stop firewalld\niptables -F\niptables -X\nrm -f /etc/firewalld/direct.xml\nrm -f /etc/firewalld/zones/public.xml\n</pre>\n<p>You can check the rules with the following command:</p>\n<pre>iptables -S</pre>\n</li>\n<li>Enable iptables:\n\t<pre>systemctl start firewalld</pre>\n<p>You can check the rules with the following command:</p>\n<pre>iptables -S</pre>\n<p>In this step, you should be able to see that firewalld has already inserted the default rules.</p>\n</li>\n<li>Enable the firewall on the NFS server and PostgreSQL DB server. For details, see \"Related topics\".</li>\n</ol>\n<div class=\"transcontent stn-end--body\"> </div>\n<h2 class=\"mw-headline\" id=\"Related_topics\">Related topics</h2>\n<p><a href=\"/doc/423/26.1/enablefirewallonnode\" title=\"SMAX:25.1/EnableFirewallOnNode\">Enable a firewall in the suite environment</a></p>\n</div>",
  "modifiedon": "2025-10-24 08:51:12"
}