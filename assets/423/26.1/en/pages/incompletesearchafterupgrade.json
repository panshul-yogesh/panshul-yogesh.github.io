{
  "title": "Search data is incomplete after an upgrade",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><div>After a system upgrade or a multi-hop upgrade, some data failed to be found using a global search.</div>\n<h2>Cause</h2>\n<p>You may have performed IDOL content scaling before an upgrade but haven't set the replicas of the content pod back to their default value after the upgrade. Therefore, the data in IDOL will be missing and the new data index will fail to be completed.</p>\n<h2>Solution</h2>\n<p>To resolve this issue, manually reset the replica count of the content StatefulSet to its original value after the upgrade.</p>\n<p>First, verify that all content pods are ready by using one of the following options:</p>\n<p><strong>Option 1: check content pod status</strong></p>\n<ol>\n<li>Log in to the bastion node.</li>\n<li>Go to the IDOL configuration folder in the Network File System (NFS):\n\t<p>For helm version: <code>&lt;nfs_folder&gt;/config-volume/idol</code></p>\n<p>For classic version: <code>&lt;nfs_folder&gt; /smartanalytics-volume/config/idol</code></p>\n</li>\n<li>Run the <code>cat count</code> command to view the contents of a file named <code>count</code>, as shown in the following example.\n\t<pre>{\"group\":{\"sawmetaContent\":1,\"sawContent\":2,\"sawarcContent\":1,\"stxContent\":0},\"count\":{\"sawmetaContent\":0,\"sawContent\":0,\"sawarcContent\":0,\"stxContent\":0},\"scale\":{}}</pre>\n\tThe number of <strong>saw-content</strong> pods (also known as engines) should be double the <strong>sawContent</strong> group number. In this example, the <b>sawContent </b>group number is <strong>2</strong>, so four <strong>saw-content</strong> pods (2 * 2) are expected.</li>\n<li>Run the <code>kubectl get pods -n itsma | grep saw-con</code> command to verify that four pods exist in the DAH and DIH servers, as shown below.\n\t<pre>smarta-saw-con-0                                      2/2     Running    0               8d\nsmarta-saw-con-1                                      2/2     Running    0               7d1h\nsmarta-saw-con-a-0                                    2/2     Running    0               8d\nsmarta-saw-con-a-1                                    2/2     Running    0               7d1h</pre>\n</li>\n</ol>\n<p><strong>Option 2: check content engine status</strong></p>\n<ol>\n<li>Log in to Suite Administration, navigate to <strong>Configurations </strong>&gt; <strong>Smart Analytics</strong>, and click <strong>Go to Smart Analytics</strong>.</li>\n<li>Double-click <strong>XService DAH 0</strong> to view its status. It should show four engines online, as shown in the following figure.<br/>\n<a class=\"image\" href=\"/file/images/general/SMA244_EngineStatus.png\" title=\"/file/images/general/SMA244_EngineStatus.png\"> <img alt=\"EngineStatus\" height=\"508\" src=\"../../../images/SMA244_EngineStatus_b2d6bb4a.png\" width=\"358\"/> </a></li>\n<li>Double-click <strong>XService DIH</strong> to view its status. It should show four engines up, as shown in the following figure.<br/>\n<a class=\"image\" href=\"/file/images/general/SMA244_EngineUp.png\" title=\"/file/images/general/SMA244_EngineUp.png\"> <img alt=\"EngineUp\" height=\"823\" src=\"../../../images/SMA244_EngineUp_ecbaea96.png\" width=\"472\"/> </a></li>\n</ol>\n<p>If content pods are missing or content engines encounter startup issues, incomplete search results or index issues might occur. To solve the issue, perform these steps:</p>\n<ol>\n<li>Run the <code>kubectl get sts -n itsma | grep saw-con</code> command to get the related StatefulSet resources. For example,\n\n\t<pre>smarta-saw-con         2/2    23d\nsmarta-saw-con-a       2/2    23d</pre>\n</li>\n<li>Scale down all the pods by running the following commands and then wait until they shut down.\n\t<pre>kubectl scale sts smarta-saw-con-a -n itsma  --replicas=0\nkubectl scale sts smarta-saw-con -n itsma  --replicas=0\n</pre>\n</li>\n<li>Scale up all the pods based on the engine group number specified in the count file. For example,\n\t<pre>kubectl scale sts smarta-saw-con-a -n itsma  --replicas=2\nkubectl scale sts smarta-saw-con -n itsma  --replicas=2\n</pre>\n</li>\n<li>Restart the <strong>smarta-saw-dah-0</strong> pod and <strong>smarta-saw-dih-xxxx-xxxx</strong> pods.</li>\n<li>If needed, perform a full reindex to refresh the data.</li>\n</ol>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}