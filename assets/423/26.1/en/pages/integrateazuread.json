{
  "title": "Integration Studio—Microsoft Azure Active Directory (AD) integration",
  "content": "<div class=\"mw-parser-output\">\n \n\n<p>You can integrate Service Management Automation with Azure Active Directory. This integration allows you to import users and groups (as well as user-group relationships) from Azure AD into Service Management. The import is achieved by using the following integration scenarios.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">User import that initially imports all the users in Service Management.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">User import (delta) that initially imports all the users in Service Management. In any subsequent import, only new or modified users are considered.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Group import and user assignment that initially imports all the groups and assigns the users to the groups.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Group import and user assignment (delta) that initially imports all the groups and assigns the users to the groups. In any subsequent import, only new or modified groups are considered.</li></ol>\n<p><strong>Comparison:</strong></p>\n<table cellpadding=\"1\" cellspacing=\"1\" style=\"width: 500px;\">\n<thead>\n<tr>\n<th scope=\"col\">Options</th>\n<th scope=\"col\">User import</th>\n<th scope=\"col\">User import (delta)</th>\n<th scope=\"col\">Group import &amp; User assignment</th>\n<th scope=\"col\">Group import &amp; User assignment (delta)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Allows to filter records in Azure AD</td>\n<td>Yes, Azure AD filter query parameters can be users</td>\n<td>Limited, only filter by object id is supported</td>\n<td>Yes, Azure AD filter query parameters can be users</td>\n<td>Limited, only filter by object id is supported</td>\n</tr>\n<tr>\n<td>Allows to import delta changes only</td>\n<td>No, all data matching the filter criteria is imported</td>\n<td>Yes</td>\n<td>No, all data matching the filter criteria is imported</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td>Can convert users to contacts</td>\n<td>No, since users removed in Azure AD are not returned</td>\n<td>Yes, since users removed in Azure AD are returned</td>\n<td>n/a</td>\n<td>n/a</td>\n</tr>\n</tbody>\n</table>\n<p>The integrations can be scheduled to regularly import the data.</p>\n<p><span style='color: rgb(51, 51, 51); font-family: Roboto, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"; font-size: 16px;'>As an example, the procedure below will set up the integration to import users and groups from Azure AD.</span></p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>The integration use cases described in this document serve as examples to inspire and guide your integration efforts. However, they should not be considered as prescriptive or guaranteed solutions for your particular scenario. The examples may or may not be applicable for your license edition.</div></div></div>\n<h2><a id=\"Prerequisites\" name=\"Prerequisites\" title=\"Prerequisites\"></a>Prerequisites</h2>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p>You have registered an app in the Azure Portal. To be able to use the Microsoft Graph API for the Azure AD user and group import, an app in the Azure Portal is required. The App ID is used in the Service Management endpoint to connect to the Graph API.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p>You have generated a secret for the app. The secret key is used in the Service Management endpoint to connect to the Graph API.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p>You have assigned the following permissions to the app (assign Delegated permissions or Application permissions for OAuth 2.0's Authorization Code or Client Credentials flow, respectively).</p>\n<p><strong>Permissions to get user data:</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">\n<p><strong>Delegated (work or school account):</strong></p>\n<p>Minimum: <code>User.ReadBasic.All, User.Read.All</code></p>\n<p>Optional: <code>User.ReadWrite.All, Directory.Read.All, Directory.ReadWrite.All</code></p>\n</li><li style=\"margin-left: 40px; position: relative;\">\n<p><strong>Application:</strong></p>\n<p>Minimum: <code>User.Read.All</code></p>\n<p>Optional: <code>User.ReadWrite.All, Directory.Read.All, Directory.ReadWrite.All</code></p>\n</li></ul>\n<p><strong>Permissions to get group data:</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">\n<p><strong>Delegated (work or school account):</strong></p>\n<p>Minimum: <code>GroupMember.Read.All, Group.Read.All</code></p>\n<p>Optional: <code>Directory.Read.All, Group.ReadWrite.All, Directory.ReadWrite.All</code></p>\n</li><li style=\"margin-left: 40px; position: relative;\">\n<p><strong>Application:</strong></p>\n<p>Minimum: <code>GroupMember.Read.All, Group.Read.All</code></p>\n<p>Optional: <code>Directory.Read.All, Group.ReadWrite.All, Directory.ReadWrite.All</code></p>\n</li></ul>\n</li></ul>\n<h2><a id=\"Prepare_an_integration_user\" name=\"Prepare_an_integration_user\" title=\"Prepare an integration user\"></a>Prepare an integration user</h2>\n<p>Perform the following steps to prepare an integration user:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Create an integration user. See <a href=\"/doc/423/26.1/createuser\" title=\"How to create an integration user\">How to create an integration user</a>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to Service Management's Agent Portal as the tenant admin.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Administration </strong>&gt; <strong>Master Data</strong> &gt; <strong>People.</strong></li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Locate the integration user you created.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Assign the <strong>Tenant Admin</strong> role to the integration user. This role provides the necessary permission to create and update persons and groups. </li></ol>\n<h2><a id=\"Create_an_endpoint\" name=\"Create_an_endpoint\" title=\"Create an endpoint\"></a>Create an endpoint</h2>\n<p>Create an endpoint using the Rest Executor 2.0 endpoint type.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to the Agent Portal as the integration administrator.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Administration &gt; Utilities &gt; Integration &gt; Endpoints</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Add</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select <strong>Rest Executor 2.0</strong> as the endpoint type, enter a name for the endpoint (for example, Azure AD), and then click <strong>Add</strong>. The system creates the endpoint.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Configure</strong> and complete the following fields.<span id=\"cke_bm_11362C\" style=\"display: none;\"> </span>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">ld</th>\n<th scope=\"col\">Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td colspan=\"2\"><strong>General configuration</strong></td>\n</tr>\n<tr>\n<td>Agent</td>\n<td>Select <strong>Agentless</strong> for a direct connection to the Graph API.</td>\n</tr>\n<tr>\n<td>Authentication type</td>\n<td>Select <strong>OAuth 2.0</strong></td>\n</tr>\n<tr>\n<td>Protocol</td>\n<td>Select <strong>https</strong>.</td>\n</tr>\n<tr>\n<td>Base URL</td>\n<td>Enter the base URL of the Graph API: <code>https://graph.microsoft.com</code></td>\n</tr>\n<tr>\n<td>Certificate type</td>\n<td>Leave it empty.</td>\n</tr>\n<tr>\n<td>Certificate format</td>\n<td>Leave it empty.</td>\n</tr>\n<tr>\n<td>Server certificate</td>\n<td>Leave it empty.</td>\n</tr>\n<tr>\n<td>Enable email notification for expired token</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Recipients</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td colspan=\"2\"><strong>Get Token configuration</strong></td>\n</tr>\n<tr>\n<td>Grant Type</td>\n<td>\n<p>Select <strong>Authorization Code</strong> or <strong>Client Credentials</strong> <span style=\"background-color: transparent;\">based on your preferred authentication method. </span></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>Authorization Code</strong> requires a username/password to connect to the Graph API and the specified app.</p>\n<p><strong>Note:</strong> If special authorizations are required, use the Authorization Code type, because you can grant special Azure AD permissions to the signed-in user if required.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>Client Credentials</strong> is designed for server-to-server communication. It connects to the specific app and uses the permissions assigned to the app.</p>\n</li></ul>\n</td>\n</tr>\n<tr>\n<td>Client ID</td>\n<td>The App ID.</td>\n</tr>\n<tr>\n<td>Client Secret</td>\n<td>The secret key for the app.</td>\n</tr>\n<tr>\n<td>Authorization URL</td>\n<td>Only required when <strong>Authorization Code</strong> is used. The URL can be found under Endpoints for the App in Azure Portal.</td>\n</tr>\n<tr>\n<td>Redirect URL</td>\n<td>Automatically generated. Only available when <strong>Authorization Code</strong> is used.</td>\n</tr>\n<tr>\n<td>Token URL</td>\n<td>The URL can be found under Endpoints for the App in Azure Portal.</td>\n</tr>\n<tr>\n<td>Scope</td>\n<td>\n<p>Enter <code>.default</code> if <strong>Client Credentials</strong> is selected.</p>\n<p>Enter <code>offline_access</code> if <strong>Authorization Code</strong> is selected.</p>\n<p>See <a href=\"https://learn.microsoft.com/en-us/azure/active-directory/develop/scopes-oidc\" title=\"Scopes and permissions in the Microsoft identity platform\">Scopes and permissions in the Microsoft identity platform</a> for details.</p>\n</td>\n</tr>\n<tr>\n<td>State</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Send client Id and secret</td>\n<td>In body</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Example</strong></p>\n<p><strong><span aria-label=\"aFbdu2pTqBOyuggAIKKKCAAgoooIACiUCqAHLy5Mlw4sQJ9RRQQAEFFFBAAQUUUECBagn8PxD2whgOtKIYAAAAAElFTkSuQmCC image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><span aria-label=\"aFbdu2pTqBOyuggAIKKKCAAgoooIACiUCqAHLy5Mlw4sQJ9RRQQAEFFFBAAQUUUECBagn8PxD2whgOtKIYAAAAAElFTkSuQmCC image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><a class=\"image\" href=\"\"> <img alt=\"aFbdu2pTqBOyuggAIKKKCAAgoooIACiUCqAHLy5Mlw4sQJ9RRQQAEFFFBAAQUUUECBagn8PxD2whgOtKIYAAAAAElFTkSuQmCC\" border=\"1\" hspace=\"0\" src=\"../../../images/pn_image_661f3152773438.78918587_3c122dae.png\" style=\"width:800px;height:534px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:1px solid black;\" vspace=\"0\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span><span title=\"Click and drag to resize\">​</span></span><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><span aria-label=\" image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><a class=\"image\" href=\"\"> <img alt=\"\" draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width:15px;height:15px\" title=\"Click and drag to move\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span><span title=\"Click and drag to resize\">​</span></span></span><span title=\"Click and drag to resize\">​</span></span> </strong></p>\n<p><strong><span aria-label=\"aHksBBRRQQAEFFFBAgRIXMICU+AVg8xVQQAEFFFBAAQUUyKeAASSf2h5LAQUUUEABBRRQQIESFzCAlPgFYPMVUEABBRRQQAEFFMingAEkn9oeSwEFFFBAAQUUUECBEhf4f3KbBztuc0yNAAAAAElFTkSuQmCC image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><span aria-label=\"aHksBBRRQQAEFFFBAgRIXMICU+AVg8xVQQAEFFFBAAQUUyKeAASSf2h5LAQUUUEABBRRQQIESFzCAlPgFYPMVUEABBRRQQAEFFMingAEkn9oeSwEFFFBAAQUUUECBEhf4f3KbBztuc0yNAAAAAElFTkSuQmCC image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><a class=\"image\" href=\"\"> <img alt=\"aHksBBRRQQAEFFFBAgRIXMICU+AVg8xVQQAEFFFBAAQUUyKeAASSf2h5LAQUUUEABBRRQQIESFzCAlPgFYPMVUEABBRRQQAEFFMingAEkn9oeSwEFFFBAAQUUUECBEhf4f3KbBztuc0yNAAAAAElFTkSuQmCC\" border=\"1\" hspace=\"0\" src=\"../../../images/pn_image_661f3153409438.07850134_3c94a091.png\" style=\"width:800px;height:486px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:1px solid black;\" vspace=\"0\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span><span title=\"Click and drag to resize\">​</span></span><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><span aria-label=\" image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><a class=\"image\" href=\"\"> <img alt=\"\" draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width:15px;height:15px\" title=\"Click and drag to move\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span><span title=\"Click and drag to resize\">​</span></span></span><span title=\"Click and drag to resize\">​</span></span>   </strong> </p>\n</li></ol>\n<h2><a id=\"Create_an_integration\" name=\"Create_an_integration\" title=\"Create an integration\"></a>Create an integration</h2>\n<p>Create an integration and configure scenarios to define your business logic for the Azure AD integration. The Azure AD integration has four predefined scenario templates, which are based on the <strong>Microsoft Graph</strong> connector, choose the ones based on your requirements.</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Azure AD - User import</li><li style=\"margin-left: 28px; position: relative;\">Azure AD - User import (delta)</li><li style=\"margin-left: 28px; position: relative;\">Azure AD - Group import &amp; User assignment</li><li style=\"margin-left: 28px; position: relative;\">Azure AD - Group import &amp; User assignment (delta)</li></ul>\n<p>In the following steps, you'll create an integration with the predefined templates.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Administration &gt; Utilities &gt; Integration &gt; Integration Studio</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>New</strong>, enter the name of your integration, and then click <strong>Save</strong>. The system displays the Integration page.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the Details section, configure the integration user you created for the current Service Management system and activate the integration.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the Connector-Endpoint mappings section, click <strong>Add</strong> to add a mapping.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select <strong>Graph</strong> (under <strong>Microsoft</strong>) as the connector, select the Azure AD endpoint that you created earlier, and then enter an alias for the mapping.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save</strong>.</li></ol>\n<h2><a id=\"Configure_the_scenarios\" name=\"Configure_the_scenarios\" title=\"Configure the scenarios\"></a>Configure the scenarios</h2>\n<p>Perform the following steps to add the scenarios to the integration:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Add scenario</strong>. </li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter a name for the scenario. For example, enter <strong>Group import &amp; User Assignment</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Template</strong> field, select for example <strong>Azure AD - Group import &amp; User Assignment</strong> (under <strong>Microsoft Graph</strong>) from the list.\n\t<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>Using templates will make the integration configuration easier than starting from scratch. If you don't select this option, you'll have to manually add your own logic, starting from a blank page. </div></div></div>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save</strong> to add the scenario.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Use the above steps to add another second scenario, for example <strong>Azure AD - User import</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Configure the parameters described below, and then click <strong>Save</strong>.</li></ol>\n<p>The table describes the parameters that you can modify to control the behavior of the scenarios. These parameters are located in the specified rules at the start of the <strong>Process logic</strong> section. Modify them before you run the integration.</p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\">\n<thead>\n<tr>\n<th scope=\"col\">Scenario name</th>\n<th scope=\"col\">Options to be considered before using the scenario </th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Azure AD – Group import &amp; User assignment</strong></td>\n<td>\n<p><strong>Rule - Settings:</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>AzureGroupUniqueKeyProperty</strong>: This is the unique key property of groups in Azure. When groups are created in Service Management, it becomes the group UPN. Make sure the property is also listed in the <b>select </b>parameter of the <strong>Prepare Azure query parameters</strong> rule.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>importAll</strong>: If set to <code>true</code>, all groups are imported in each run of the scenario. If false, see the filter query parameter to filter the required data.</p>\n</li></ul>\n<p><strong>Rule - Prepare Azure query parameters:</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>top</strong>:<strong> </strong>The number of records to retrieve in one API call. Default: <em>50</em>.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>select:</strong> The group properties to get from Azure AD.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>filter</strong>: The query used to retrieve groups when <strong>importAll</strong> is set to <code>false</code>. Replace the placeholder <em>&lt;Your Azure AD group filter&gt;</em> with your filter for the Graph API. See query parameters in the <a href=\"http://learn.microsoft.com/en-us/graph/query-parameters?source=recommendations&amp;tabs=http\" title=\"Graph API documentation\">Graph API documentation</a> for details.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>skiptoken: </strong>The variable to use to handle the skip token from Azure to access the next page of records.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>final: </strong>The query parameters to append to the URI when the API call is made.</p>\n</li></ul>\n</td>\n</tr>\n<tr>\n<td><strong>Azure AD – Group import &amp; User assignment (delta)</strong></td>\n<td>\n<p><strong>Rule - Settings:</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>AzureGroupUniqueKeyProperty</strong>: This is the unique key property of groups in Azure. When groups are created in Service Management, it becomes the group UPN. Make sure the property is also listed in the <b>select </b>parameter of the <strong>Prepare Azure query parameters</strong> rule.</p>\n</li></ul>\n<p><strong>Rule - Prepare Azure query parameters:</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>select:</strong> The group properties to get from Azure AD. In the delta request, those are the properties which are monitored for modifications. If other properties than the listed once are modified, the delta API will not return these records.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>skiptoken: </strong>The variable to use to handle the skip token from Azure to access the next page of records.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>storedDeltaToken</strong>: The delta token from Microsoft which identifies the records to return in the next execution of the scenario. Ensure the scenario is running at least once in 30 days, to avoid losing the delta token. If the delta token is deleted the system will import all records in the next execution</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>deltaToken</strong>: The delta token from Microsoft, appended to the query parameters.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>final: </strong>The query parameters to append to the URI when the API call is made.</p>\n</li></ul>\n</td>\n</tr>\n<tr>\n<td><strong>Azure AD – User import</strong></td>\n<td>\n<p><strong>Rule - Settings:</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>SMAXLicenseCapacity</strong>: Enter the license capacity of the license assigned to users.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>SMAXLicenseName</strong>: Enter the name of the license to assign to users.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>SMAXDefaultRoles</strong>: The default role(s) to be assigned to users.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>SMAXAuthenticationType</strong>: The authentication type. See <a href=\"/doc/423/26.1/managepersonsapi\" title=\"Manage person API\">Manage person API</a> for possible values.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>AzureUniqueKeyProperty</strong>: This is the unique key property of users in Azure. When users are created in Service Management, it becomes the user UPN. Make sure the property is also listed in the <strong>select</strong> parameter of the  <strong>Prepare Azure query parameters</strong> rule. In case you change the value to something other than <code>'mail'</code>, make sure the value meets the Service Management requirements for Upn.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>importAll</strong>: If set to <code>true</code>, all users are imported in each run of the scenario.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>UpnDataType</strong>: The DataType, in case email is not used as UPN. See <a href=\"/doc/423/26.1/managepersonsapi\" title=\"Manage person API\">Manage person API</a> for possible values.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>TrackPersonAPIResponse</strong>: If set to true, the system will collect the Job IDs of the Manage Person API to fetch the status of each request and stores the result in the execution history. Default, false. We recommend to only set this parameter to true, for debugging purposes.</p>\n</li></ul>\n<p><strong>Rule </strong><strong style=\"background-color: transparent;\"> - Prepare Azure query parameters:</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>top</strong>:<strong> </strong>The number of records to retrieve in one API call. Default: <em>50</em>.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>select:</strong> The user properties to get from Azure AD.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>filter</strong>: The query used to retrieve users when <strong>importAll</strong> is set to <code>false</code>. Replace the placeholder <em>&lt;Your Azure AD User filter&gt;</em> with your filter for the Graph API. See query parameters in the <a href=\"http://learn.microsoft.com/en-us/graph/query-parameters?source=recommendations&amp;tabs=http\" title=\"Graph API documentation\">Graph API documentation</a> for details.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>skiptoken: </strong>The variable to use to handle the skip token from Azure to access the next page of records.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>final: </strong>The query parameters to append to the URI when the API call is made.</p>\n</li></ul>\n</td>\n</tr>\n<tr>\n<td><strong>Azure AD – User import (delta)</strong></td>\n<td>\n<p><strong>Rule - Settings:</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>Service ManagementLicenseCapacity</strong>: Enter the license capacity of the license assigned to users.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>Service ManagementLicenseName</strong>: Enter the name of the license to assign to users.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>Service ManagementDefaultRoles</strong>: The default role(s) to be assigned to users.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>Service ManagementAuthenticationType</strong>: The authentication type. See <a href=\"/doc/423/26.1/managepersonsapi\" title=\"Manage person API\">Manage person API</a> for possible values.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>AzureUniqueKeyProperty</strong>: This is the unique key property of users in Azure. When users are created in Service Management, it becomes the user UPN. Make sure the property is also listed in the <strong>select</strong> parameter of the  <strong>Prepare Azure query parameters</strong> rule. In case you change the value to something other than <code>'mail'</code>, make sure the value meets the Service Management requirements for Upn.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>UpnDataType</strong>: The DataType, in case email is not used as UPN. See <a href=\"/doc/423/26.1/managepersonsapi\" title=\"Manage person API\">Manage person API</a> for possible values.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>TrackPersonAPIResponse</strong>: If set to true, the system will collect the Job IDs of the Manage Person API to fetch the status of each request and stores the result in the execution history. Default, false. We recommend to only set this parameter to true, for debugging purposes.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>ProcessUserRemovals: </strong>If set to true, persons, which are removed from Azure AD are converted to contacts in Service Management.</p>\n</li></ul>\n<p><strong>Rule </strong><strong style=\"background-color: transparent;\"> - Prepare Azure query parameters:</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>select:</strong> The user properties to get from Azure AD.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>skiptoken: </strong>The variable to use to handle the skip token from Azure to access the next page of records.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>storedDeltaToken</strong>: The delta token from Microsoft which identifies the records to return in the next execution of the scenario. Ensure the scenario is running at least once in 30 days, to avoid losing the delta token. If the delta token is deleted the system will import all records in the next execution</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>deltaToken</strong>: The delta token from Microsoft, appended to the query parameters.</p>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong>final: </strong>The query parameters to append to the URI when the API call is made.</p>\n</li></ul>\n</td>\n</tr>\n</tbody>\n</table>\n<h2><a id=\"Use_the_scenarios\" name=\"Use_the_scenarios\" title=\"Use the scenarios\"></a>Use the scenarios</h2>\n<p>For the <strong>User Import</strong> scenarios, create a new field to store the Azure ID of the user.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to <strong>Studio</strong> and select the <strong>Person</strong> record type.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Open the <strong>Fields</strong> tab and add a new custom field with the following properties.\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">Field name: AzureID_c</li><li style=\"margin-left: 40px; position: relative;\">Multilingual label: Azure ID</li><li style=\"margin-left: 40px; position: relative;\">Logical Type: SMALL TEXT</li></ul>\n</li></ol>\n<h3><a id=\"Use_the_scenarios_without_delta_import_functionality\" name=\"Use_the_scenarios_without_delta_import_functionality\" title=\"Use the scenarios without delta import functionality\"></a>Use the scenarios without delta import functionality</h3>\n<p>We recommend executing the scenarios in the following sequence:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the User import scenario manually the first time, by clicking <strong>Run scenario</strong> in the Integration Studio. This should import all users into Service Management. Ensure the <strong>importAll</strong> parameter is set to <code>true</code>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the Group import scenario manually the first time, by clicking <strong>Run scenario</strong> in the Integration Studio. This should import all groups into Service Management and associate the users with the imported groups. Ensure the <strong>importAll</strong> parameter is set to <code>true</code>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Change the <strong>importAll</strong> parameter to <code>false</code> and configure the filter parameters to load only modified records. Then schedule the modified scenarios based on your preferred interval. Make sure the scenario can finish before the next run starts.<br/>\n<br/>\n\tFor ex<span id=\"cke_bm_3727C\" style=\"display: none;\"> </span>am<span id=\"cke_bm_4370C\" style=\"display: none;\"> </span>ple, you can set a filter as below to import only records created after the last execution time of the scheduler:<br/>\n\t \n\t<div aria-label=\"code snippet widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\">\n<div aria-label=\"code snippet widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\">\n<pre><code class=\"hljs\">if (Settings.ImportAll == false) {\n\n  'createdDateTime ge ' +\n\n    format(payload.data.last_execution_time, \"yyyy-MM-dd'T'HH:mm:ss'Z'\");\n\n} else {\n\n  ignore_query_parameter();\n\n}</code></pre>\n<a class=\"image\" href=\"\"> <img src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span></div>\n<span aria-label=\" image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><a class=\"image\" href=\"\"> <img alt=\"\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span><span title=\"Click and drag to resize\">​</span></span><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><span aria-label=\" image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><a class=\"image\" href=\"\"> <img alt=\"\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width:15px;height:15px\" title=\"Click and drag to move\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span><span title=\"Click and drag to resize\">​</span></span></span></div>\n<br/>\n<span aria-label=\"Azure AD integration data import filter image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><span aria-label=\"Azure AD integration data import filter image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><a class=\"image\" href=\"\"> <img alt=\"Azure AD integration data import filter\" src=\"../../../images/integrateAzureAD_65a279df.png\" style=\"width: 881px; height: 563px;\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span><span title=\"Click and drag to resize\">​</span></span><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><span aria-label=\" image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><a class=\"image\" href=\"\"> <img alt=\"\" draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width:15px;height:15px\" title=\"Click and drag to move\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span><span title=\"Click and drag to resize\">​</span></span></span><span title=\"Click and drag to resize\">​</span></span></li></ol>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-tip-icon\"></div><div class=\"admonition-content admonition-tip-content\"><div>When using the scheduler to run scenarios, you can use the built-in object property  <strong>payload.data.last_execution_time</strong> to query data in the target system based on the last modification timestamp. </div></div></div>\n<div>\n<h3><a id=\"Use_the_scenarios_with_delta_import_functionality\" name=\"Use_the_scenarios_with_delta_import_functionality\" title=\"Use the scenarios with delta import functionality\"></a>Use the scenarios with delta import functionality</h3>\n<p>We recommend executing the scenarios in the following sequence:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the <em>User import</em> (delta) scenario manually the first time, by clicking <strong>Run scenario</strong> in the Integration Studio. This should import all users into Service Management. Ensure the <strong>deltaToken</strong> is stored in the Manage Data section for the Integration. You can now schedule the scenario and the scenario will only import newly created or modified users. In case all users have to be imported again, delete the delta token.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the <em>Group import</em> (delta) scenario manually the first time, by clicking <strong>Run scenario</strong> in the Integration Studio. This should import all groups into Service Management and associate the users with the imported groups. Ensure the <strong>deltaToken</strong> is stored in the Manage Data section for the Integration. You can now schedule the scenario and the scenario will only import newly created or modified users. In case all users have to be imported again, delete the delta token.</li></ol>\n<p>Since the Delta API in Microsoft does only offer limited filter capabilites all users or groups are in scope of the import. In case it is required to ignore some of the users or groups, you can use the json parser filter functionality to ensure some of the data is not processed. The following json parser example, will filter the response from Azure to only consider users where the userPrincipleName starts with Ni.</p>\n<p><code>json_parser(response.data, '$.value[?(@.userPrincipalName=~ /^Ni.*?/i)]')</code></p>\n<p>For additional json parser filter operators see here: <a href=\"https://github.com/json-path/JsonPath?tab=readme-ov-file#filter-operators\" title=\"GitHub - json-path/JsonPath: Java JsonPath implementation\">GitHub - json-path/JsonPath: Java JsonPath implementation</a></p>\n<p>This function can be used in step 4 in the <strong>Group Import (delta)</strong> scenario, for key \"Groups\" or step 5 in the <strong>User import (delta)</strong> scenario for the key \"Items\".</p>\n<p>Here is an example.</p>\n</div>\n<div><span aria-label=\"JSON Parser example image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><span aria-label=\"JSON Parser example image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><a class=\"image\" href=\"\"> <img alt=\"JSON Parser example\" src=\"../../../images/AzureAD_Json_parser_9abcced7.png\" style=\"width: 1002px; height: 533px;\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span><span title=\"Click and drag to resize\">​</span></span><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><span aria-label=\" image widget\" contenteditable=\"false\" role=\"region\" tabindex=\"-1\"><a class=\"image\" href=\"\"> <img alt=\"\" draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width:15px;height:15px\" title=\"Click and drag to move\"/> </a><span style=\"background:rgba(220,220,220,0.5);background-image:url(https://staging.docs.microfocus.com/assets/vendor/ckeditor/plugins/widget/images/handle.png);display:none;\"><a class=\"image\" href=\"\"> <img draggable=\"true\" role=\"presentation\" src=\"../../../images/wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw_d639b57c\" style=\"width: 15px; height: 15px;\" title=\"Click and drag to move\"/> </a></span><span title=\"Click and drag to resize\">​</span></span></span><span title=\"Click and drag to resize\">​</span></span></div>\n</div>",
  "modifiedon": "2025-10-24 08:51:12"
}