{
  "title": "Change control in HCM offering fulfillment",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><div class=\"Admonition_Note\"><span class=\"autonumber\">Note</span>\n<p>The SMAX-HCM integration has been deprecated since this release, and may be obsoleted in a future release. Customers can deploy and enable the Design and Deploy (DND) capability to use aggregated offerings instead of this integration (see <a href=\"/doc/423/26.1/createaggregationproviders\" title=\"SMAX:25.1/CreateAggregationProviders\">Create and edit aggregation providers</a>).</p>\n</div>\n<p>This topic describes three use cases that implement change control in HCM offering fulfillment based on an integration between SMAX and HCM:</p>\n<ul>\n<li>Successful VM provisioning in HCM upon approval by normal change in Service Management</li>\n<li>VM provisioning in HCM rejected by normal change in Service Management</li>\n<li>Successful VM provisioning in HCM upon approval by standard change (for auditing) in Service Management</li>\n</ul>\n<p>This topic also provides step-by-step guidance for setting up the SMAX-HCM integration to support these use cases.</p>\n<h2 class=\"mw-headline\" id=\"Use_case_1:_Successful_VM_provisioning_in_HCM_upon_approval_by_normal_change_in_SMAX\">Use case 1: Successful VM provisioning in HCM upon approval by normal change in Service Management</h2>\n<p>In this use case, Amy, as an R&amp;D engineer, needs to request one Linux VM from vCenter for her daily testing work. Although she knows she can use the SMAX Service Portal to submit a request, she still wants to use HCM because she is more familiar with HCM. </p>\n<p><a class=\"image\" href=\"https://staging.docs.microfocus.com/file/images/0/0c/SMAX_HCMp2_integrate1_new.png\" title=\"https://staging.docs.microfocus.com/file/images/0/0c/SMAX_HCMp2_integrate1_new.png\"> <img alt=\"\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/0/0c/SMAX_HCMp2_integrate1_new.png\" height=\"508\" hspace=\"0\" src=\"../../../images/SMAX_HCMp2_integrate1_new_d941a909.png\" style=\"width: 800px; height: 508px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/> </a></p>\n<h3 class=\"mw-headline\" id=\"Step_1:_User_accesses_HCM_MPP_consumer_portal\">Step 1: User accesses HCM MPP consumer portal</h3>\n<p>Amy logs in to the HCM MPP consumer portal and accesses the landing page.</p>\n<h3 class=\"mw-headline\" id=\"Step_2:_User_submits_VM_request_in_HCM_MPP_portal\">Step 2: User submits VM request in HCM MPP portal</h3>\n<p>Amy goes to ‘Shop for Services’, and searches for ‘Vcenter’ to find the ‘VcenterServerOffering(1.0.0)’ offering, which she always uses to request new VMs.</p>\n<p><a class=\"image\" href=\"/file/images/8/8e/HCM2/SMAX_HCMp2_integrate2.png\" title=\"/file/images/8/8e/HCM2/SMAX_HCMp2_integrate2.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate2.png\" data-file-height=\"312\" data-file-width=\"1003\" height=\"312\" src=\"../../../images/SMAX_HCMp2_integrate2_275f6f7c.png\" width=\"1003\"/> </a></p>\n<p>Amy drills down to this offering, keep the default values for all properties, checks it out and submits a request after a final review.</p>\n<p><a class=\"image\" href=\"/file/images/8/8b/HCM2/SMAX_HCMp2_integrate3.png\" title=\"/file/images/8/8b/HCM2/SMAX_HCMp2_integrate3.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate3.png\" data-file-height=\"574\" data-file-width=\"1074\" height=\"574\" src=\"../../../images/SMAX_HCMp2_integrate3_545531b4.png\" width=\"1074\"/> </a></p>\n<p>Amy goes back to the dashboard and clicks the <b>My Requests</b> icon. The request she submitted is displayed, and pending external approval by Service Management.</p>\n<p><a class=\"image\" href=\"/file/images/e/e2/HCM2/SMAX_HCMp2_integrate4.png\" title=\"/file/images/e/e2/HCM2/SMAX_HCMp2_integrate4.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate4.png\" data-file-height=\"252\" data-file-width=\"1154\" height=\"252\" src=\"../../../images/SMAX_HCMp2_integrate4_9ee2ba0c.png\" width=\"1154\"/> </a></p>\n<h3 class=\"mw-headline\" id=\"Step_3:_IT_agent_handles_SMAX_normal_change_and_approves_the_request\">Step 3: IT agent handles SMAX normal change and approves the request</h3>\n<p>By default, HCM configures SMAX external change approval for each VM request. Alex, as a SMAX agent who monitors the SMAX-HCM integration, notices that there is a normal change created via HCM and pending approval. As the current VM quota is still sufficient, Alex moves this change to the \"Approve Deployment\" phase and then approves it.</p>\n<p><a class=\"image\" href=\"/file/images/5/54/HCM2/SMAX_HCMp2_integrate5.png\" title=\"/file/images/5/54/HCM2/SMAX_HCMp2_integrate5.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate5.png\" data-file-height=\"498\" data-file-width=\"1245\" height=\"498\" src=\"../../../images/SMAX_HCMp2_integrate5_76964b81.png\" width=\"1245\"/> </a></p>\n<h3 class=\"mw-headline\" id=\"Step_4:_VM_fulfillment_is_successfully_completed_in_HCM\">Step 4: VM fulfillment is successfully completed in HCM</h3>\n<p>As soon as the change is approved in Service Management, the status pf the HCM request submitted by Amy also becomes <b>Approved</b>.</p>\n<p><a class=\"image\" href=\"/file/images/6/67/HCM2/SMAX_HCMp2_integrate6.png\" title=\"/file/images/6/67/HCM2/SMAX_HCMp2_integrate6.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate6.png\" data-file-height=\"272\" data-file-width=\"1185\" height=\"272\" src=\"../../../images/SMAX_HCMp2_integrate6_da0c698d.png\" width=\"1185\"/> </a></p>\n<p>After the approval, the related subscription is created and is pending actual VM fulfillment.</p>\n<p><a class=\"image\" href=\"/file/images/4/4c/HCM2/SMAX_HCMp2_integrate7.png\" title=\"/file/images/4/4c/HCM2/SMAX_HCMp2_integrate7.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate7.png\" data-file-height=\"259\" data-file-width=\"1183\" height=\"259\" src=\"../../../images/SMAX_HCMp2_integrate7_aff064c1.png\" width=\"1183\"/> </a></p>\n<p>After 5 to 10 minutes, VM fulfillment is successfully completed and the subscription is active.</p>\n<p><a class=\"image\" href=\"/file/images/b/b4/HCM2/SMAX_HCMp2_integrate8.png\" title=\"/file/images/b/b4/HCM2/SMAX_HCMp2_integrate8.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate8.png\" data-file-height=\"260\" data-file-width=\"1199\" height=\"260\" src=\"../../../images/SMAX_HCMp2_integrate8_2e1d1c97.png\" width=\"1199\"/> </a></p>\n<p>At this moment, Amy logs in to the HCM MPP portal again to check the status. She is happy to know that her request is approved and the subscription is active. She drills down to the subscription and click <b>View Linked Service</b> to check the IP address of the new VM provisioned for her. Now, she can log in to the new VM for her daily testing.</p>\n<p><a class=\"image\" href=\"/file/images/b/bd/HCM2/SMAX_HCMp2_integrate9.png\" title=\"/file/images/b/bd/HCM2/SMAX_HCMp2_integrate9.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate9.png\" data-file-height=\"770\" data-file-width=\"1502\" height=\"770\" src=\"../../../images/SMAX_HCMp2_integrate9_50b1f97b.png\" width=\"1502\"/> </a></p>\n<h2 class=\"mw-headline\" id=\"Use_case_2:_VM_provisioning_in_HCM_rejected_by_normal_change_in_SMAX\">Use case 2: VM provisioning in HCM rejected by normal change in Service Management</h2>\n<p>In this use case, Alex will deny the change approval in Service Management for HCM fulfillment, so that the HCM request is also rejected, and no fulfillment will start and no subscription will be created in HCM.</p>\n<p>Step 1 and Step 2 of this use case are same with user case 1. However, in Step 3, Alex is aware that IT has already run out of the VM quota, as a result, no VM can be fulfilled at this moment. In this case, Alex has to add the comments and deny this change.</p>\n<p><a class=\"image\" href=\"/file/images/0/02/HCM2/SMAX_HCMp2_integrate10.png\" title=\"/file/images/0/02/HCM2/SMAX_HCMp2_integrate10.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate10.png\" data-file-height=\"560\" data-file-width=\"1279\" height=\"560\" src=\"../../../images/SMAX_HCMp2_integrate10_4681a8aa.png\" width=\"1279\"/> </a></p>\n<p>After the change request is denied, the status of the request in HCM also becomes rejected.</p>\n<p><a class=\"image\" href=\"/file/images/7/72/HCM2/SMAX_HCMp2_integrate11.png\" title=\"/file/images/7/72/HCM2/SMAX_HCMp2_integrate11.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate11.png\" data-file-height=\"255\" data-file-width=\"1141\" height=\"255\" src=\"../../../images/SMAX_HCMp2_integrate11_1228b2b1.png\" width=\"1141\"/> </a></p>\n<p>At this moment, Amy logs in to the HCM MPP portal again to check the request status. She can see that the request is rejected. As a result, Amy has to submit another request after a larger VM quota is allocated.</p>\n<p><a class=\"image\" href=\"/file/images/a/a8/HCM2/SMAX_HCMp2_integrate12.png\" title=\"/file/images/a/a8/HCM2/SMAX_HCMp2_integrate12.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate12.png\" data-file-height=\"591\" data-file-width=\"1144\" height=\"591\" src=\"../../../images/SMAX_HCMp2_integrate12_ade148bc.png\" width=\"1144\"/> </a></p>\n<h2 class=\"mw-headline\" id=\"Use_case_3:_Successful_VM_provisioning_in_HCM_upon_approval_by_standard_change_in_SMAX\">Use case 3: Successful VM provisioning in HCM upon approval by standard change in Service Management</h2>\n<p>In this use case, Alex doesn't need to approve or deny the change request in Service Management. He only needs to audit the HCM offering fulfillment when monitoring the SMAX-HCM integration each time.</p>\n<p>Most of the steps in this case are the same with use case 1, except that in Step 3, there is a standard change created in Service Management instead of a normal change that's used in use case 1. Because there is no approval action required for a standard change, Alex only needs to move this change to the \"Execute\" phase and the approval status \"Approved\" will be directly sent back to HCM to trigger the VM fulfillment.</p>\n<p>For related configurations, refer to <b>SMAX Step 6: Configure change model</b>.</p>\n<h2 class=\"mw-headline\" id=\"Behind_the_scenes:_setting_up_the_integration\">Behind the scenes: setting up the integration</h2>\n<p>This section provides step-by-step guidance for setting up the SMAX-HCM integration to implement change control in HCM offering fulfillment.</p>\n<h3 class=\"mw-headline\" id=\"Configure_HCM\">Configure HCM</h3>\n<ol>\n<li>Apply the OO content pack</li>\n<li>Configure OO flows in the OO central server.</li>\n<li>Configure an external approval policy for the CSA catalog.</li>\n</ol>\n<h4 class=\"mw-headline\" id=\"Step_1:_Apply_the_OO_content_pack\">Step 1: Apply the OO content pack</h4>\n<p>The HCM suite has OO and most of the content packs embedded already. Here you need to deploy the content pack named <b>Service Management Automation X</b> of version 3.2.0, which you can download from the <a class=\"external text\" href=\"https://marketplace.opentext.com/itom/content/oo-service-management-automation-x-smax-content\" rel=\"nofollow\" target=\"1\">ITOM Marketplace</a>. </p>\n<p><a class=\"image\" href=\"/file/images/b/b9/HCM2/SMAX_HCMp2_integrate13.png\" title=\"/file/images/b/b9/HCM2/SMAX_HCMp2_integrate13.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate13.png\" data-file-height=\"466\" data-file-width=\"830\" height=\"466\" src=\"../../../images/SMAX_HCMp2_integrate13_298620ea.png\" width=\"830\"/> </a></p>\n<h4 class=\"mw-headline\" id=\"Step_2:_Configure_OO_flows_in_the_OO_central_server\">Step 2: Configure OO flows in the OO central server</h4>\n<h5 class=\"mw-headline\" id=\"Configure_System_Accounts\">Configure System Accounts</h5>\n<p>Configure a system account to allow OO to connect to HCM and Service Management. To do so, click <b>Content Management</b> <i>&gt;</i><b>Configuration Items</b>.</p>\n<p>Go to the <b>Content Management</b> <i>&gt;</i> <b>Configuration Items</b> <i>&gt;</i> <b>Configuration/System Accounts/Integrations/Micro Focus/Service Management Automation X/HCM</b> folder and configure the following System Accounts.</p>\n<table class=\"sortable\">\n<tbody>\n<tr>\n<th><b>Parameter</b></th>\n<th><b>Comments</b></th>\n</tr>\n<tr>\n<td>HCM Credentials</td>\n<td>Allow OO to access HCM with the role of admin</td>\n</tr>\n<tr>\n<td>HCM Consumer Credentials</td>\n<td>Allow OO to access HCM with the role of consumer</td>\n</tr>\n<tr>\n<td>IDM Credential</td>\n<td>Allow OO to access IDM in the container</td>\n</tr>\n<tr>\n<td>SMAX Credentials</td>\n<td>Allow OO to access SMAX</td>\n</tr>\n</tbody>\n</table>\n<p><b>Example:</b></p>\n<p><a class=\"image\" href=\"/file/images/1/1e/HCM2/SMAX_HCMp2_integrate14.png\" title=\"/file/images/1/1e/HCM2/SMAX_HCMp2_integrate14.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate14.png\" data-file-height=\"462\" data-file-width=\"1005\" height=\"462\" src=\"../../../images/SMAX_HCMp2_integrate14_a22c7679.png\" width=\"1005\"/> </a></p>\n<h5 class=\"mw-headline\" id=\"Configure_System_Properties\">Configure System Properties</h5>\n<p>Configure the parameters required for OO to access the HCM and SMAX URLs properly. To do so, click <b>Content Management</b> &gt; <b>Configuration Items</b>.</p>\n<p>Go to the <b>Content Management</b> &gt; <b>Configuration Items</b> &gt; <b>Configuration/System Properties/Integrations/Micro Focus/Service Management Automation X/</b> folder and then go to the following subfolders:</p>\n<ul>\n<li>HCM</li>\n<li>SMAX</li>\n</ul>\n<p>Configure the system properties described in the following table.</p>\n<table class=\"sortable\">\n<tbody>\n<tr>\n<th><b>Parameter</b></th>\n<th><b>Comments</b></th>\n</tr>\n<tr>\n<td>HCMConsumerURL</td>\n<td>MPP URL for consumers to log in.</td>\n</tr>\n<tr>\n<td>HCMURL</td>\n<td>HCM base URL for CSA and OO, etc.</td>\n</tr>\n<tr>\n<td>SMAXBaseURL</td>\n<td></td>\n</tr>\n<tr>\n<td>SMAXLoginURI</td>\n<td>SMAX login URI, it's hardcoded as /auth/authentication-endpoint/authenticate/login</td>\n</tr>\n<tr>\n<td>SMAXModelID</td>\n<td>Target change model ID in Service Management, maybe standard or normal change model ID.</td>\n</tr>\n<tr>\n<td>SMAXTenantID</td>\n<td>SMAX tenant ID, which is the target tenant all OO flows connect to.</td>\n</tr>\n</tbody>\n</table>\n<p><b>Example:</b></p>\n<p><a class=\"image\" href=\"/file/images/0/02/HCM2/SMAX_HCMp2_integrate15.png\" title=\"/file/images/0/02/HCM2/SMAX_HCMp2_integrate15.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate15.png\" data-file-height=\"588\" data-file-width=\"1189\" height=\"588\" src=\"../../../images/SMAX_HCMp2_integrate15_e32e237d.png\" width=\"1189\"/> </a></p>\n<h4 class=\"mw-headline\" id=\"Step_3:_Configure_an_external_approval_policy_for_CSA_catalog\">Step 3: Configure an external approval policy for CSA catalog</h4>\n<p>Log in to the CSA console, and go to <b>Administration &gt; Catalogs</b> to create a new Catalog. For example, \"External Approval\".</p>\n<p><a class=\"image\" href=\"/file/images/a/a2/HCM2/SMAX_HCMp2_integrate16.png\" title=\"/file/images/a/a2/HCM2/SMAX_HCMp2_integrate16.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate16.png\" data-file-height=\"384\" data-file-width=\"884\" height=\"384\" src=\"../../../images/SMAX_HCMp2_integrate16_509cc4d5.png\" width=\"884\"/> </a></p>\n<p>Click the catalog created to edit the details. On the <b>Approval Policies</b> tab, set the <b>Approval Policy Template</b> as \"Delegated Template’\"and set the <b>External Approval Action</b> as \"SMAX Initiate Request Approval\", which is one OO flow in Service Management Content Pack 3.2.0, to create a SMAX normal or standard change per model ID.</p>\n<p><a class=\"image\" href=\"/file/images/5/55/HCM2/SMAX_HCMp2_integrate17.png\" title=\"/file/images/5/55/HCM2/SMAX_HCMp2_integrate17.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate17.png\" data-file-height=\"747\" data-file-width=\"1046\" height=\"747\" src=\"../../../images/SMAX_HCMp2_integrate17_1ef59630.png\" width=\"1046\"/> </a></p>\n<p>On the <b>Publish Offerings</b> tab, make sure that the HCM offerings that need SMAX change approval are listed. For example, the VcenterServerOffering offering mentioned in the demo use cases above.</p>\n<p><a class=\"image\" href=\"/file/images/8/85/HCM2/SMAX_HCMp2_integrate18.png\" title=\"/file/images/8/85/HCM2/SMAX_HCMp2_integrate18.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate18.png\" data-file-height=\"355\" data-file-width=\"885\" height=\"355\" src=\"../../../images/SMAX_HCMp2_integrate18_b9b77396.png\" width=\"885\"/> </a></p>\n<h3 class=\"mw-headline\" id=\"Configure_SMAX\">Configure SMAX </h3>\n<ol>\n<li>Set up an On-Premise Bridge (OPB) agent. </li>\n<li>Add an Operations Orchestration endpoint for invoking OO flows.</li>\n<li>Add a REST execution endpoint for invoking OO flow via REST APIs.</li>\n<li>Define new fields for change.</li>\n<li>Expose new fields in change forms</li>\n<li>Configure Change Models:\n\t<ol>\n<li>Define an approval.</li>\n<li>Define a task plan.</li>\n<li>Define rules.</li>\n</ol>\n</li>\n<li>Configure workflow rules for normal change. </li>\n</ol>\n<h4 class=\"mw-headline\" id=\"Step_1:_Set_up_an_On-Premises_Bridge_agent\">Step 1: Set up an On-Premises Bridge agent</h4>\n<p>Before you begin, you may want to go to the <a href=\"/doc/423/26.1/onpremisebridge\" title=\"SMAX:25.1/OnPremiseBridge\">On-Premises Bridge Agents and Endpoints</a> document to read general background details for setting up integrations.</p>\n<p><b>Note:</b>  If required, ensure that you import the SMAX certificates into the On-Premises Bridge to ensure that the OPB can establish a connection to Service Management.</p>\n<h4 class=\"mw-headline\" id=\"Step_2:_Add_an_Operations_Orchestration_endpoint_for_invoking_OO_flows\">Step 2: Add an Operations Orchestration endpoint for invoking OO flows</h4>\n<ol>\n<li>Once you have an On Premise Bridge (OPB) endpoint agent available, the next step is to add an endpoint that will be used to call our flows into the OO system: </li>\n<li>From the Administration menu, navigate to <b>Integration Management &gt; ENDPOINTS</b>.</li>\n<li>Press the <i>+Add</i> button to create a new endpoint:\n\t<ol>\n<li>Select <b>Operations Orchestration 10.02</b> and later as the <b>Endpoint type</b>.</li>\n<li>Provide a name (such as <b>OO</b>).</li>\n<li>Specify the OPB agent that will enable the endpoint.<br/>\n<a class=\"image\" href=\"/file/images/0/0d/HCM2/SMAX_HCMp2_integrate19.png\" title=\"/file/images/0/0d/HCM2/SMAX_HCMp2_integrate19.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate19.png\" data-file-height=\"339\" data-file-width=\"1292\" height=\"339\" src=\"../../../images/SMAX_HCMp2_integrate19_7a909b17.png\" width=\"1292\"/> </a></li>\n</ol>\n</li>\n<li>Once created, configure the endpoint:\n\t<ol>\n<li>Enter the OO URL location, such as https://smax-c7edb01d-mea86ed0b.swinfra.net:8444/.</li>\n<li>Select the credentials entered in On-Premises Bridge to connect to the OO Server.</li>\n<li>If required, you may click the <b>Test connection</b> button to perform a test.</li>\n</ol>\n</li>\n</ol>\n<p><a class=\"image\" href=\"/file/images/b/be/HCM2/SMAX_HCMp2_integrate20.png\" title=\"/file/images/b/be/HCM2/SMAX_HCMp2_integrate20.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate20.png\" data-file-height=\"370\" data-file-width=\"991\" height=\"370\" src=\"../../../images/SMAX_HCMp2_integrate20_5812ac3b.png\" width=\"991\"/> </a></p>\n<h4 class=\"mw-headline\" id=\"Step_3:_Add_a_REST_execution_endpoint_for_invoking_OO_flow_via_REST_APIs\">Step 3: Add a REST execution endpoint for invoking OO flow via REST APIs</h4>\n<p>Add another endpoint that will be used to call REST APIs into the OO system.</p>\n<p><b>Note:</b> When a normal change moves back to the \"Build and Test\" phase because the approval is denied, Service Management has to call REST APIs to run the OO flow instead of the task plan. This is a limitation in Service Management; the detailed configurations are described in Step 7.</p>\n<ol>\n<li>In the Administration menu, navigate to <b>Integration Management</b>  &gt; <b>ENDPOINTS</b>.</li>\n<li>Press the <i>+Add</i> button to create a new endpoint: \n\t<ol>\n<li>Select <b>Rest Executor 1.0</b> as the <b>Endpoint type</b>. </li>\n<li>Provide a name (such as <b>REST</b>).</li>\n<li>Specify the OPB agent that will enable the endpoint. <br/>\n<a class=\"image\" href=\"/file/images/0/00/HCM2/SMAX_HCMp2_integrate21.png\" title=\"/file/images/0/00/HCM2/SMAX_HCMp2_integrate21.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate21.png\" data-file-height=\"337\" data-file-width=\"1297\" height=\"337\" src=\"../../../images/SMAX_HCMp2_integrate21_ea2f1ec9.png\" width=\"1297\"/> </a></li>\n</ol>\n</li>\n<li>Once created, configure the endpoint:\n\t<ol>\n<li>Enter the OO URL location, such as https://smax-c7edb01d-mea86ed0b.swinfra.net:8444/.</li>\n<li>Select the credentials entered in On-Premises Bridge to connect to the OO Server</li>\n<li>If required, you may click the <b>Test connection</b> button to perform a test.<br/>\n<a class=\"image\" href=\"/file/images/5/58/HCM2/SMAX_HCMp2_integrate22.png\" title=\"/file/images/5/58/HCM2/SMAX_HCMp2_integrate22.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate22.png\" data-file-height=\"322\" data-file-width=\"985\" height=\"322\" src=\"../../../images/SMAX_HCMp2_integrate22_f41407ae.png\" width=\"985\"/> </a></li>\n</ol>\n</li>\n</ol>\n<h4 class=\"mw-headline\" id=\"Step_4:_Define_new_fields_for_change\">Step 4: Define new fields for change</h4>\n<p>Define a number of new fields for change, which are used to store output/input values for OO flows (\"SMAX Initiate Request Approve\" and \"SMAX Update Ticket\").</p>\n<p>The detailed information of the fields are listed below:</p>\n<table class=\"sortable\">\n<tbody>\n<tr>\n<th>Custom Field Name</th>\n<th>Purpose</th>\n</tr>\n<tr>\n<td>HCMApprovalContextId</td>\n<td rowspan=\"6\">The first 6 custom fields are required by HCM, and HCM will write and read values via OO flows. </td>\n</tr>\n<tr>\n<td>HCMApprovalProcessId</td>\n</tr>\n<tr>\n<td>HCMCatalogId</td>\n</tr>\n<tr>\n<td>HCMCsaContextId</td>\n</tr>\n<tr>\n<td>HCMCsaProcessId</td>\n</tr>\n<tr>\n<td>HCMOrganizationId</td>\n</tr>\n<tr>\n<td>HCMApprovalStatus</td>\n<td>Stores approval status in Service Management.</td>\n</tr>\n<tr>\n<td>HCMOutput</td>\n<td>Stores the rest call output of OO flow \"SMAX Update Ticket\".</td>\n</tr>\n<tr>\n<td>HCMSubscriptionLink</td>\n<td>Stores HCM subscription URL in HTTP links.</td>\n</tr>\n<tr>\n<td>HCMSubscriptionUrl</td>\n<td>Stores HCM subscription URL in text.</td>\n</tr>\n<tr>\n<td>HCMuuid</td>\n<td>Stores the OO flow UUID for \"SMAX Update Ticket\" for the next rest call.</td>\n</tr>\n<tr>\n<td>IsHCMChange</td>\n<td>Indicates whether the change is created for HCM or not.</td>\n</tr>\n</tbody>\n</table>\n<p><a class=\"image\" href=\"/file/images/0/0b/HCM2/SMAX_HCMp2_integrate23.png\" title=\"/file/images/0/0b/HCM2/SMAX_HCMp2_integrate23.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate23.png\" data-file-height=\"693\" data-file-width=\"711\" height=\"693\" src=\"../../../images/SMAX_HCMp2_integrate23_492fa21a.png\" width=\"711\"/> </a></p>\n<h4 class=\"mw-headline\" id=\"Step_5:_Expose_the_new_fields_in_change_forms\">Step 5: Expose the new fields in change forms</h4>\n<p>Most of the fields added for change are used in the backend except for the <i>HCMSubscriptionLink_c</i> field, which should be displayed as URL in the <b>Full Change form</b>. In this way, the SMAX agent can find the HCM subscription URL in the change record, and thus check the subscription details in HCM via this link.</p>\n<p><a class=\"image\" href=\"/file/images/2/25/HCM2/SMAX_HCMp2_integrate24.png\" title=\"/file/images/2/25/HCM2/SMAX_HCMp2_integrate24.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate24.png\" data-file-height=\"423\" data-file-width=\"940\" height=\"423\" src=\"../../../images/SMAX_HCMp2_integrate24_290dcd3d.png\" width=\"940\"/> </a></p>\n<h4 class=\"mw-headline\" id=\"Step_6:_Configure_change_models\">Step 6: Configure change models</h4>\n<p>Define two change models for HCM. One is a standard change model, which is used to create standard changes to audit HCM offering fulfillment. The other is a normal change model, which is used to create normal changes to actually approve or deny HCM offering fulfillment requests.</p>\n<p><a class=\"image\" href=\"/file/images/2/22/HCM2/SMAX_HCMp2_integrate25.png\" title=\"/file/images/2/22/HCM2/SMAX_HCMp2_integrate25.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate25.png\" data-file-height=\"111\" data-file-width=\"850\" height=\"111\" src=\"../../../images/SMAX_HCMp2_integrate25_9c35ddc6.png\" width=\"850\"/> </a></p>\n<p>Once created, define an associated approval, task and rule for the change models to address HCM requests, as described in the following.</p>\n<h5 class=\"mw-headline\" id=\"Define_approval\">Define approval</h5>\n<p>For the standard change model, there is no need to define approval because the standard change is automatically approved by default.</p>\n<p>For the normal change model, you need to define the approval for HCM VM provisioning at <b>Approval deployment</b> phase as follows:</p>\n<p><a class=\"image\" href=\"/file/images/f/f5/HCM2/SMAX_HCMp2_integrate26.png\" title=\"/file/images/f/f5/HCM2/SMAX_HCMp2_integrate26.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate26.png\" data-file-height=\"498\" data-file-width=\"735\" height=\"498\" src=\"../../../images/SMAX_HCMp2_integrate26_d2ee9919.png\" width=\"735\"/> </a></p>\n<h5 class=\"mw-headline\" id=\"Define_a_task_plan\">Define a task plan</h5>\n<p>For the normal change model, you need to define the tasks in the <b>Execute</b> phase to trigger OO flow \"SMAX Update Ticket\", and store the HCM subscription URL in the change record that's returned by the OO flow. In this way, after the change is approved, SMAX can push the approval status back to HCM to trigger VM fulfillment.</p>\n<p>The following shows an task plan example:</p>\n<p><a class=\"image\" href=\"/file/images/e/e4/HCM2/SMAX_HCMp2_integrate27.png\" title=\"/file/images/e/e4/HCM2/SMAX_HCMp2_integrate27.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate27.png\" data-file-height=\"358\" data-file-width=\"340\" height=\"358\" src=\"../../../images/SMAX_HCMp2_integrate27_c6044061.png\" width=\"340\"/> </a></p>\n<h6><span class=\"mw-headline\" id=\"Task-1\">Task-1</span></h6>\n<table class=\"sortable\">\n<tbody>\n<tr>\n<th>Parameter</th>\n<th>Value</th>\n<th>Comments</th>\n</tr>\n<tr>\n<td>Task Type</td>\n<td>Automatic</td>\n<td></td>\n</tr>\n<tr>\n<td>Task Properties\n\t\t\t<p>Title</p>\n</td>\n<td>Send Approval Status</td>\n<td></td>\n</tr>\n<tr>\n<td>Scheduling</td>\n<td>N/A</td>\n<td></td>\n</tr>\n<tr>\n<td>External</td>\n<td>N/A</td>\n<td></td>\n</tr>\n<tr>\n<td>Business rule</td>\n<td><i><b>Rule Template</b>:</i>\n<p>Execute Operations Orchestration (OO) flow</p>\n<p><i><b>Integration Endpoint:</b></i> OO</p>\n<p><i><b>OO Flow Name</b>:</i> SMAX Update Ticket</p>\n<p><i><b>Flow Parameters</b>:</i></p>\n<p>1)      changeId: ${entity.Id}</p>\n<p>2)      status: ${entity.HCMApprovalStatus_c}</p>\n<p><i><b>Output Mappings</b>:</i></p>\n<p>1)      HCM Subscription Url: subscriptionURL</p>\n</td>\n<td>OO flow \"SMAX Update Ticket\" is called to push approval status back via ${entity.HCMApprovalStatus_c}.  \n\t\t\t<p>SMAX change ID, ${entity.Id} is also passed for HCM to query 6 custom fields defined in step 4. </p>\n<p>Output \"subscriptionURL\" is returned as URL text.</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p><a class=\"image\" href=\"/file/images/8/88/HCM2/SMAX_HCMp2_integrate28.png\" title=\"/file/images/8/88/HCM2/SMAX_HCMp2_integrate28.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate28.png\" data-file-height=\"690\" data-file-width=\"669\" height=\"690\" src=\"../../../images/SMAX_HCMp2_integrate28_889acf32.png\" width=\"669\"/> </a></p>\n<h6><span class=\"mw-headline\" id=\"Task-2\">Task-2</span></h6>\n<table class=\"sortable\">\n<tbody>\n<tr>\n<th>Parameter</th>\n<th>Value</th>\n</tr>\n<tr>\n<td>Task Type</td>\n<td>Automatic</td>\n</tr>\n<tr>\n<td>Task Properties / Title</td>\n<td>Convert Subscription URL</td>\n</tr>\n<tr>\n<td>Scheduling</td>\n<td>N/A</td>\n</tr>\n<tr>\n<td>External</td>\n<td>N/A</td>\n</tr>\n<tr>\n<td>Business rule</td>\n<td><i><b>Rule Template</b>:</i> Set Field\n\t\t\t<p><i><b>Logic:</b></i> Set ‘HCM Subscription Link’ to ‘${entity.HCMSubscriptionURL_c}’</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p><a class=\"image\" href=\"/file/images/7/7b/HCM2/SMAX_HCMp2_integrate29.png\" title=\"/file/images/7/7b/HCM2/SMAX_HCMp2_integrate29.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate29.png\" data-file-height=\"764\" data-file-width=\"710\" height=\"764\" src=\"../../../images/SMAX_HCMp2_integrate29_9619a61b.png\" width=\"710\"/> </a></p>\n<p>In the standard change model, you also need to define two tasks that are same with the normal change model. However, because a standard change is automatically approved by default, you need to hard-code the status ‘APPROVED’ for HCM in the first task as shown in the following:</p>\n<p><a class=\"image\" href=\"/file/images/6/65/HCM2/SMAX_HCMp2_integrate30.png\" title=\"/file/images/6/65/HCM2/SMAX_HCMp2_integrate30.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate30.png\" data-file-height=\"821\" data-file-width=\"701\" height=\"821\" src=\"../../../images/SMAX_HCMp2_integrate30_49ffc178.png\" width=\"701\"/> </a></p>\n<h5 class=\"mw-headline\" id=\"Define_rules\">Define rules</h5>\n<p>In Step 4, the \"HCM Change’\" field was defined to indicate if one change is created for HCM. In order to initialize its value, you need to configure the \"After change\" rule in the normal change model to set it to TRUE as soon as the change is created. You can later utilize this field when approving or denying the change.</p>\n<p>Because there is no approval needed for the standard change model, you don't need to define this rule in the standard change model.</p>\n<p><a class=\"image\" href=\"/file/images/e/ee/HCM2/SMAX_HCMp2_integrate31.png\" title=\"/file/images/e/ee/HCM2/SMAX_HCMp2_integrate31.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate31.png\" data-file-height=\"101\" data-file-width=\"1063\" height=\"101\" src=\"../../../images/SMAX_HCMp2_integrate31_a4faf988.png\" width=\"1063\"/> </a></p>\n<h4 class=\"mw-headline\" id=\"Step_7:_Configure_workflow_rules_for_normal_change\">Step 7: Configure workflow rules for normal change</h4>\n<p>If the approval is denied for a normal change created by HCM, the change will be moved back to the \"Build and Test\" phase. At this point, SMAX should push the \"REJECTED’\" status to HCM. Because this action can't be fulfilled through a task plan due to a SMAX limitation, you need to define additional rules to make SMAX to call REST API to run  OO flow \"SMAX Update Ticket\" per its UUID in order to push the \"REJECTED\" status to HCM.</p>\n<p>Here you need to define three rules in the \"Normal\" change workflow as follows:</p>\n<h5 class=\"mw-headline\" id=\"Rule-1\">Rule-1</h5>\n<p>Define the \"After applying changes\" rule to run a rest call on OO flow \"SMAX Update Ticket\" to send the approval status to HCM.</p>\n<table class=\"sortable\">\n<tbody>\n<tr>\n<th>Parameter</th>\n<th>Value</th>\n<th>Comments</th>\n</tr>\n<tr>\n<td>Rule Template</td>\n<td>Execute Rest</td>\n<td></td>\n</tr>\n<tr>\n<td>Condition</td>\n<td>${entity.HCMApprovalStatus_c == 'REJECTED'}</td>\n<td>The rule is only run if the approval is denied, so HCM Approval Status is set as \"REJECTED\".</td>\n</tr>\n<tr>\n<td>Agent</td>\n<td>&lt;your agent&gt;</td>\n<td></td>\n</tr>\n<tr>\n<td>Endpoint</td>\n<td>&lt;your OO REST endpoint&gt;</td>\n<td></td>\n</tr>\n<tr>\n<td>Credentials</td>\n<td>&lt;your credentials&gt;</td>\n<td></td>\n</tr>\n<tr>\n<td>HTTP Method</td>\n<td>POST</td>\n<td></td>\n</tr>\n<tr>\n<td>Uri Suffix</td>\n<td>/oo/rest/v2/executions</td>\n<td></td>\n</tr>\n<tr>\n<td>Payload Type</td>\n<td>JSON</td>\n<td></td>\n</tr>\n<tr>\n<td>Body</td>\n<td>${concat('{\"flowUuid\":\"', entity.HCMuuid_c, '\",\"uuid\":\"', entity.HCMuuid_c, '\",\"runName\":\"SMAX Reject\",\"inputs\":{\"changeId\":\"', entity.Id, '\",\"status\":\"', entity.HCMApprovalStatus_c,'\"}}')}</td>\n<td>Call OO flow \"SMAX Update Ticket\" with its UUID, which is saved in HCMuuid when HCM creates the change.  \n\t\t\t<p>Provide HCM changeId and HCMApprovalStatus which are similar to Task-1.</p>\n</td>\n</tr>\n<tr>\n<td>Headers</td>\n<td>Accept: application/json\n\t\t\t<p>Content-Type: application/json</p>\n</td>\n<td></td>\n</tr>\n<tr>\n<td>Output Field</td>\n<td>HCM Output</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p>Example:</p>\n<p><a class=\"image\" href=\"/file/images/a/a4/HCM2/SMAX_HCMp2_integrate32.png\" title=\"/file/images/a/a4/HCM2/SMAX_HCMp2_integrate32.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate32.png\" data-file-height=\"279\" data-file-width=\"971\" height=\"279\" src=\"../../../images/SMAX_HCMp2_integrate32_3e4cee3b.png\" width=\"971\"/> </a></p>\n<h5 class=\"mw-headline\" id=\"Rule-2\">Rule-2</h5>\n<p>If the approval is approved, the change will be moved to the \"Execute\" phase, define the \"During transition\" rule at the transition \"Approval Deployment\" as \"Execute\" to set the HCM approval status to \"APPROVED\".</p>\n<p>Example: <a class=\"image\" href=\"/file/images/8/85/HCM2/SMAX_HCMp2_integrate33.png\" title=\"/file/images/8/85/HCM2/SMAX_HCMp2_integrate33.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate33.png\" data-file-height=\"101\" data-file-width=\"1440\" height=\"101\" src=\"../../../images/SMAX_HCMp2_integrate33_9fc6ae8b.png\" width=\"1440\"/> </a></p>\n<h5 class=\"mw-headline\" id=\"Rule-3\">Rule-3</h5>\n<p>If the approval is denied, the change will be moved to the \"Build and Test\" phase, define the \"During transition\" rule at the transition \"Approval Deployment\" as \"Build and Test\" to set the HCM approval status to \"REJECTED\".</p>\n<p>Example: <a class=\"image\" href=\"/file/images/9/92/HCM2/SMAX_HCMp2_integrate34.png\" title=\"/file/images/9/92/HCM2/SMAX_HCMp2_integrate34.png\"> <img alt=\"HCM2/SMAX HCMp2 integrate34.png\" data-file-height=\"104\" data-file-width=\"1441\" height=\"104\" src=\"../../../images/SMAX_HCMp2_integrate34_85af1171.png\" width=\"1441\"/> </a></p>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}