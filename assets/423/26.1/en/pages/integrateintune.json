{
  "title": "Integration Studio—Microsoft Intune integration",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p>You can integrate Service Management with Microsoft Intune. This integration enables you to import devices/endpoints from Intune into the SACM module. During the import, the system tries to identify the owner of the device to assign it to the correct user in Service Management. Once the owner is set, the user can see all the assigned devices in the Service Portal under “My Services and Assets”.</p><p>The integration can be scheduled to regularly import the data. The integration can be configured in a way to set devices not found for a period of time as “missed” in Service Management, so that the configuration manager can start a manual review process.</p><p>Furthermore, configuration managers or administrators can run remote actions against the imported Intune devices. For example, they can restart a device, lock it, or start a virus scan directly from the device record in Service Management.</p><div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\">When using remote actions to manage devices via Intune, it’s your responsibility to set the correct permissions in the Azure Portal to ensure the Intune integration is not misused for harmful actions.</div></div><span class=\"snippet-start\" data-sname=\"423-25.4-423-25.3-IntegrateJira|Intg_Disclaimer|N\"></span><div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\" data-reuse-section-begin=\"3f8dcb4f\" data-reuse-section-end=\"3f8dcb4f\">The integration use cases described in this document serve as examples to inspire and guide your integration efforts. However, they should not be considered as prescriptive or guaranteed solutions for your particular scenario. The examples may or may not be applicable for your license edition.</div>\n</div>\n<p><br/>\n</p><span class=\"snippet-end\" data-sname=\"423-25.4-423-25.3-IntegrateJira|Intg_Disclaimer|N\"></span><h2>Set up the integration</h2><p>As an example, the procedure below will set up the integration to import devices from Intune.</p><p>The business logic for the integration is defined by the predefined scenario template <i>Intune – import devices</i>, which imports the devices from Intune. You can create an integration scenario based on the scenario template, and then update some environment-specific or control parameters to fine-tune the system behavior.</p><h3>Prerequisites</h3><p>To set up the integration, make sure the following prerequisites are satisfied.</p><ul><li><p>You have an Intune license from Microsoft.</p></li><li><p>You have registered an app in the Azure Portal. The application ID is used in the Service Management endpoint to connect to the Graph API.</p></li><li><p>You have created a secret for the app. The secret key is used in the Service Management endpoint to connect to the Graph API.</p></li><li><p>You have assigned the following permissions to the app (assign Delegated permissions or Application permissions for OAuth 2.0's Authorization Code or Client Credentials flow, respectively).</p><ul><li><p><code>DeviceManagementManagedDevices.Read.All</code> (to import Device data)</p></li><li><p><code>DeviceManagementManagedDevices.ReadWrite.All, DeviceManagementManagedDevices.PrivilegedOperations.All</code> (to execute actions)</p></li></ul><p>Each action like reboot, shutdown etc. might require different permissions. For details, see the <a href=\"https://learn.microsoft.com/en-us/graph/api/resources/intune-devices-manageddevice?view=graph-rest-beta\" style=\"font-family: Inter;\" title=\"Microsoft Graph API documentation\">Microsoft Graph API documentation</a>.</p></li></ul><h3>Prepare an integration user</h3><p>Perform the following steps to prepare an integration user:</p><ol><li><p>Create an integration user. See <a href=\"/doc/423/26.1/createuser\" title=\"How to create an integration user\">How to create an integration user</a>.</p></li><li><p>Log in to the Agent Interface as the tenant admin.</p></li><li><p>Navigate to <strong>Administration</strong> &gt; <strong>Master Data</strong> &gt; <strong>People</strong>, locate the integration user, and then assign the proper roles to access the required modules.</p><p>At a minimum, the role should have the following permission.</p><div><a class=\"image\" href=\"/file/images/a/a0/OPB_Admin.png\" title=\"/file/images/a/a0/OPB_Admin.png\"><img alt=\"OPB_Admin.png\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/a/a0/OPB_Admin.png\" height=\"95\" hspace=\"0\" src=\"../../../images/OPB_Admin_23a7b359.png\" style=\"width: 800px; height: 95px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/></a></div><p>Alternatively, add the Tenant Admin role to grant general access.</p></li></ol><h3>Create an endpoint</h3><p>Create an endpoint using the Rest Executor 2.0 endpoint type:</p><ol><li><p>Log in to the agent interface as the tenant admin.</p></li><li>Navigate to <strong>Administration</strong> &gt; <strong>Utilities</strong> &gt; <strong>Integration</strong> &gt; <strong>Endpoints</strong>.</li><li><p>Click <strong>Add</strong>.</p></li><li><p>Select <strong>Rest Executor 2.0</strong> as the endpoint type, enter a name for the endpoint (for example, Intune), and then click <strong>Add</strong>. The system creates the endpoint.</p></li><li><p>Click <strong>Configure</strong> and complete the fields:</p><table border=\"1\" cellpadding=\"1\" cellspacing=\"1\"><thead><tr><th scope=\"col\">Field</th><th scope=\"col\">Value</th></tr></thead><tbody><tr><td colspan=\"2\"><strong>General configuration</strong></td></tr><tr><td>Agent</td><td>Select <strong>Agentless</strong> for a direct connection to the Graph API.</td></tr><tr><td>Authentication type</td><td>Select <strong>OAuth 2.0</strong></td></tr><tr><td>Protocol</td><td>Select <strong>https</strong>.</td></tr><tr><td>Base URL</td><td>Enter the base URL of the Graph API: <code>https://graph.microsoft.com</code>.</td></tr><tr><td>Certificate type</td><td>Leave it empty.</td></tr><tr><td>Certificate format</td><td>Leave it empty.</td></tr><tr><td>Server certificate</td><td>Leave it empty.</td></tr><tr><td>Enable email notification for expired token</td><td>Optional</td></tr><tr><td>Recipients</td><td>Optional</td></tr><tr><td colspan=\"2\"><strong>Get Token configuration</strong></td></tr><tr><td>Grant Type</td><td><p>Authorization Code or Client Credentials</p><p>The selection depends on your preferred authentication method. </p><ul><li><p><strong>Authorization Code</strong> requires a user/password to connect to the Graph API and the specified app. </p><p><strong>Note:</strong> If special authorizations are required, use the Authorization Code type. Then a user needs to log in. This user can get special Intune permissions granted if required.</p></li><li><p><strong>Client Credentials</strong> is designed for server-to-server communication. It connects to the specific app and uses the permissions assigned to the app.</p></li></ul></td></tr><tr><td>Client ID</td><td>The application ID.</td></tr><tr><td>Client Secret</td><td>The secret key for the app.</td></tr><tr><td>Authorization URL</td><td>Required only when <strong>Authorization Code</strong> is used. The URL can be found under Endpoints for the app in the Azure Portal.</td></tr><tr><td>Redirect URL</td><td>Automatically generated.</td></tr><tr><td>Token URL</td><td>The URL can be found under Endpoints for the app in the Azure Portal.</td></tr><tr><td>Scope</td><td><p>Enter: <code>.default</code>.</p><p>In case <strong>Authorization Code</strong> is used, enter <code>offline_access</code>.</p><p>See <a href=\"https://learn.microsoft.com/en-us/azure/active-directory/develop/scopes-oidc\" title=\"Scopes and permissions in the Microsoft identity platform\">Scopes and permissions in the Microsoft identity platform</a> for details.</p></td></tr><tr><td>State</td><td>Optional</td></tr><tr><td>Send client Id and secret</td><td>In body</td></tr></tbody></table><p>Example:</p><div><a class=\"image\" href=\"/file/images/c/ce/MSIntune003.png\" title=\"/file/images/c/ce/MSIntune003.png\"><img alt=\"MSIntune003.png\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/c/ce/MSIntune003.png\" height=\"524\" hspace=\"0\" src=\"../../../images/MSIntune003_6bbb8510.png\" style=\"width: 800px; height: 524px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/></a></div><div><a class=\"image\" href=\"/file/images/6/62/MSIntune005.png\" title=\"/file/images/6/62/MSIntune005.png\"><img alt=\"MSIntune005.png\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/6/62/MSIntune005.png\" height=\"658\" hspace=\"0\" src=\"../../../images/MSIntune005_a55dd57c.png\" style=\"width: 800px; height: 658px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/></a></div></li></ol><h3>Create an integration</h3><p>Perform the following steps to create an integration based on the Microsoft Graph connector. </p><ol><li><p>Navigate to <strong>Administration</strong> &gt; <strong>Utilities</strong> &gt; <strong>Integration</strong> &gt; <strong>Integration Studio</strong>. </p></li><li>Click <strong>New</strong>, enter the name of your integration, and then click <strong>Save</strong>. The system displays the Integration page.</li><li>In the Details section, configure the integration user you created for the current Service Management system and activate the integration.</li><li>In the Connector-Endpoint mappings section, click <strong>Add</strong> to add a mapping.</li><li>Select <strong>Graph</strong> (under <strong>Microsoft</strong>) as the connector, select the Graph endpoint that you created earlier, and then enter an alias for the mapping.</li><li>Click <strong>Save</strong>. </li></ol><h3>Configure the scenario</h3><p>Perform the following steps to add and configure a scenario using the predefined template:</p><ol><li><p>Click <strong>Add scenario</strong>. </p></li><li><p>Enter a name for the scenario. For example, enter <strong>Intune – Import devices</strong>.</p></li><li><p>In the <strong>Template</strong> field, select <strong>Intune – Import devices</strong> (under <strong>Microsoft Graph</strong>) from the list. </p><div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><p>Using templates will make the integration configuration easier than starting from scratch. If you don't select this option, you'll have to manually add your own logic, starting from a blank page.</p></div></div></li><li><p>Click <strong>Save</strong> to add the scenario. </p></li><li><p>Configure the parameters described below, and then click <strong>Save</strong>.</p></li></ol><h4>Parameters to consider before using the scenario</h4><p>In the <strong>Settings</strong> rule at the start of the <strong>process logic</strong> section, you can use the following parameters to control the behavior of the scenario.</p><ul><li><p><strong>importAll</strong> – If set to <code>true</code>, all devices are imported in each run of the scenario.</p></li><li><p><strong>lastSyncTime</strong> – The last time the scenario was run. If the scenario runs in scheduled mode, it is the time of the last run of the scheduler. If the scenario runs manually the time is the current time.</p></li><li><p><strong>filterQuery</strong> – The query used when <strong>importAll</strong> is set to false, which is a query with the last sync time.</p></li><li><p><strong>firstReconciliationQuery</strong> – The first reconciliation query against the Service Management device records. This query checks the device records for the Intune ID. The placeholder gets substituted with the correct Intune ID after the scenario is run.</p></li><li><p><strong>secondReconciliationQuery</strong> – The second reconciliation query against the hostname AND serial number. In case the first reconciliation query does not find any record, this query is used to identify existing devices in Service Management. The placeholders are substituted with the correct serial number and hostname after the scenario is run.</p></li><li><p><strong>intialPhaseforNewCIs</strong> – The starting phase for newly created devices.</p></li><li><p><strong>setMissingFlag</strong> – If set to true, the system checks which CIs have not been checked in Intunes for the duration defined in the <strong>numberOfDaysToSetMissingFlag </strong>parameter. In case the duration is breached, the missing flag in the devices is set to <code>true</code>.</p></li><li><p><strong>numberOfDaysToSetMissingFlag</strong> – The number of days before the missing flag is set in the device. This setting is only considered when the parameter <strong>setMissingFlag</strong> is set to true.</p></li></ul><h2>Use the scenario</h2><p>To use the scenario, we recommend executing it in the following sequence:</p><ol><li>Run it manually the first time, by clicking the <strong>Run scenario</strong> button in the Integration Studio, to import all devices into Service Management. Ensure the <strong>importAll</strong> parameter is set to <code>true</code>.</li><li>Schedule the scenario based on your preferred interval. Ensure the interval is big enough so that the scenario can finish before the next run starts. Also, make sure the <strong>importAll</strong> parameter is set to <code>false</code>.</li></ol><p>Scheduler:</p><div><a class=\"image\" href=\"/file/images/3/3d/MSIntune013.png\" title=\"/file/images/3/3d/MSIntune013.png\"><img alt=\"MSIntune013.png\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/3/3d/MSIntune013.png\" height=\"133\" hspace=\"0\" src=\"../../../images/MSIntune013_d050e6a4.png\" style=\"width: 800px; height: 133px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/></a></div><h2>Understand the integration</h2><p>The following describes the logic of the scenario rules so that you can customize the scenario as needed.</p><ol><li><p>The parameters described above.</p></li><li><p>The query parameter definition against the Microsoft Graph API.</p></li><li><p>The import and processing of the Intune devices.</p></li><li><p>The handling of the devices to set the missing flag.</p></li></ol><div><a class=\"image\" href=\"/file/images/b/bf/IntuneScnExample.png\" title=\"/file/images/b/bf/IntuneScnExample.png\"><img alt=\"IntuneScnExample.png\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/b/bf/IntuneScnExample.png\" height=\"591\" hspace=\"0\" src=\"../../../images/IntuneScnExample_b92c4003.png\" style=\"width: 800px; height: 591px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/></a></div><h3><span style=\"font-size: 16px;\">The query parameter definition against the MS Graph API (2) </span></h3><table border=\"1\" cellpadding=\"1\" cellspacing=\"1\"><thead><tr><th scope=\"col\">Query Parameter</th><th scope=\"col\">Comment</th></tr></thead><tbody><tr><td>top</td><td>The number of records to fetch per call.</td></tr><tr><td>select</td><td>The properties to get in the response.</td></tr><tr><td>filter</td><td>The query to execute against the graph API. The query depends on the <strong>importAll</strong> parameter to import either all records or only records which are checked in since the last run.</td></tr><tr><td>skiptoken</td><td>The skiptoken send as part of the response.</td></tr><tr><td>final</td><td>The query parameters prepared for the usage in the Integration Studio.</td></tr></tbody></table><p><span style=\"color: rgb(0, 0, 0); font-family: Roboto, sans-serif; font-size: 20px;\">The import and processing of the Intune devices (3)</span></p><p>The important parts in these rules are the reconciliation steps. The first reconciliation query is used on the rule <strong>Service Management: Try and find Device against the Intune ID</strong>. The second reconciliation query is used on the rule <strong>Service Management: Try and find Device against Intune SerialNumber and Hostname</strong>.</p><p>In case additional reconciliation logic is required, you may either modify the existing queries or create additional reconciliation rules.</p><p><span style=\"color: rgb(0, 0, 0); font-family: Roboto, sans-serif; font-size: 20px;\">The handling of the devices to set the missing flag (4)</span></p><p>This part of the scenario first gets the records that have not been updated in the period of time specified by the <strong>numberOfDaysToSetMissingFlag </strong>parameter. The rule to get those devices is called <strong>Service Management: find records which have not been updated</strong>.</p><p>Those records are then processed in batches of 100 to set the missing flag to true.</p></div><p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}