{
  "title": "Teams channel notification v1",
  "content": "<div class=\"mw-parser-output\">\n<div class=\"transcontent stn-begin--intro\"></div>\n<p>This version uses the built-in integration framework with basic configuration and monitoring possibilities.</p>\n<div>\n<div>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-important-icon\"></div><div class=\"admonition-content admonition-important-content\"><div><strong>Privacy notice </strong><br/>\nIf you enable this integration, the application will exchange information with Microsoft Teams. It remains at all times the Customer's sole responsibility to assess these specifications against the Customer's regulatory and business requirements.</div></div></div>\n</div>\n</div>\n<h2><a id=\"Set_up_the_integration\" name=\"Set_up_the_integration\" title=\"Set up the integration\"></a>Set up the integration</h2>\n<h3><a id=\"Connect_Service_Management_with_MS_Teams\" name=\"Connect_Service_Management_with_MS_Teams\" title=\"Connect Service Management with MS Teams\"></a>Connect Service Management with MS Teams</h3>\n<p>Perform the following steps:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to the agent interface as the tenant admin.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Administration </strong>&gt; <strong>Utilities </strong>&gt; <strong>Integration</strong>, and then select<strong> Integration Studio</strong> from the dropdown list on the top of the screen.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click<strong> Microsoft Teams</strong> on the left pane. </li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Read the privacy notice at the bottom of this screen before you continue. </li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the State section, click <strong>Active </strong>to activate the integration. </li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Configure the following settings:\n\t<ol start=\"1\" style=\"padding-left: 0px;\"><li style=\"--number-width: 21px; --number-spacing: 25px; margin-left: 49px; position: relative;\">Configure the Azure AD application settings, which you have noted down when registering the application:\n\t\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 52px; position: relative;\"><strong>Application (client) ID</strong></li><li style=\"margin-left: 52px; position: relative;\"><strong>Directory (tenant) ID</strong></li><li style=\"margin-left: 52px; position: relative;\"><strong>Client secret</strong></li></ul>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">In the <strong>Service Management user (UPN)</strong> field, enter the UPN of the dedicated Service Management user name that you have created in the prerequisites section.</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Click <strong>Submit</strong>. A pop-up window appears, reminding you that after you submit new Azure AD application settings, you need to grant consent to the integration again and reconnect Service Management to MS Teams. This is because each time you click <strong>Submit</strong>, the system clears existing MS Teams authentication tokens (if you have connected to MS Teams before) and needs to regenerate tokens based on the new Azure AD application settings.</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Click <strong>OK</strong> to confirm. Wait until you see the success message <strong>Activated the integration successfully!.</strong></li></ol>\n</li><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Authentication</strong> section, copy the link. </li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Grant consent to the integration as the MS Teams admin:\n\t<ol start=\"1\" style=\"padding-left: 0px;\"><li style=\"--number-width: 21px; --number-spacing: 25px; margin-left: 49px; position: relative;\">Open the link in a web browser, and then log in with a Teams admin account. </li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Review the requested permissions, and then click <strong>Accept</strong>.</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Wait until the browser displays a \"Permission granted\" message.</li></ol>\n</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Connect Service Management to Teams.\n\t<ol start=\"1\" style=\"padding-left: 0px;\"><li style=\"--number-width: 21px; --number-spacing: 25px; margin-left: 49px; position: relative;\">Click <strong>Connect to Microsoft Teams</strong>.</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">In the pop-up window, log in to MS Teams as the integration user (you must have created the Teams channels as this integration user). </li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Wait until the success message appears on the screen, confirming that you are connected to Teams. The message may look like: The connection with the endpoint was successful.</li></ol>\n</li></ol>\n<p> Next, configure one or more scenarios and create a business rule for each to start using the integration. </p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>If you set the integration to <strong>Inactive</strong>, the integration stops running, but the system saves your existing configurations. </div></div></div>\n<h3><a id=\"Use_the_integration\" name=\"Use_the_integration\" title=\"Use the integration\"></a>Use the integration</h3>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-tip-icon\"></div><div class=\"admonition-content admonition-tip-content\"><div> To use the integration, you need to configure one or more scenarios and set up a business rule for each scenario as described in the steps below. For instructions on how to configure a scenario and a business rule to set up the sample use cases, see the <em>How to set up sample use cases </em>section.</div></div></div>\n<h4><a id=\"Step_1_Configure_a_scenario_for_the_integration\" name=\"Step_1_Configure_a_scenario_for_the_integration\" title=\"Step 1. Configure a scenario for the integration\"></a>Step 1. Configure a scenario for the integration</h4>\n<p>A scenario specifies a team and channel that you've created in MS Teams to which the system will send notification messages and the field mappings to use for the notification messages of a record type (for example, Incident). You can configure as many scenarios as you like. The Teams channels configured in the scenarios can belong to the same team or to different teams. </p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-caution-icon\"></div><div class=\"admonition-content admonition-caution-content\"><div>Each scenario name must be unique and you must configure a different MS Teams channel for each scenario. </div></div></div>\n<p>To configure a scenario:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Microsoft Teams</strong> on the left-side pane, and then click <strong>Add scenario</strong> at the top left of the right-side pane.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Specify a name (for example, Major Incidents) for the scenario and click <strong>Save</strong>. The scenario details page opens.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the Title section, the system automatically populates the <strong>Name</strong> field with the scenario name you specified. You can still modify it if you like. </li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the Parameters section, do the following:\n\t<ol start=\"1\" style=\"padding-left: 0px;\"><li style=\"--number-width: 22px; --number-spacing: 26px; margin-left: 50px; position: relative;\">In the <strong>Team name</strong> and <strong>Channel name</strong> fields, enter the names of a team and channel that you have created.</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Optionally, select the <strong>Show user name in application</strong> check box. If you select this option, the Discussions tab of the corresponding record in the system will display the names of MS Teams users along with their reply messages in this format:<strong>(YYYY-MM-DD HH:MM:SS &lt;server time zone&gt; - &lt;user name&gt;): &lt;reply message&gt;</strong>. If you don't select this option, the system displays only the reply messages. </li></ol>\n</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the Mapping section, configure the field mappings. For details, see the <em>How-tos</em> section below.\n\t<div class=\"admonition\"><div class=\"admonition-icon admonition-tip-icon\"></div><div class=\"admonition-content admonition-tip-content\"><div>You can use the <strong>Reset to defaults</strong> button to populate the fields with system predefined values and make further edits if necessary. To delete the current scenario, use the <strong>Delete scenario</strong> button. </div></div></div>\n</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save</strong>. The screen displays a message, indicating that you have successfully saved the configuration.</li></ol>\n<h4><a id=\"Step_2_Create_a_business_rule\" name=\"Step_2_Create_a_business_rule\" title=\"Step 2. Create a business rule\"></a>Step 2. Create a business rule</h4>\n<p>Create a business rule for the record type to trigger the sending of notification messages to MS Teams, based on a scenario that you created in the previous step. </p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In Studio, open the record type. For example, open <strong>Incident</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>Processes and Rules</strong> tab.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Add a <strong>Call Integration Studio</strong> business rule under the desired section and save your changes.  </li></ol>\n<h4><a id=\"Step_3_Verify_the_integration\" name=\"Step_3_Verify_the_integration\" title=\"Step 3. Verify the integration\"></a>Step 3. Verify the integration</h4>\n<p>In this example, use the major incident procedure to verify the integration. </p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to Incident Management, open an existing incident record.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Make sure that the Major Incident checkbox is selected.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Update a field value in the record and save the change.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Check that a message about this incident record arrives at the Teams channel.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>Reply</strong> button for the message, and then send a reply. </li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go back to Incident Management, and check that your reply appears on the <strong>Discussions</strong> tab of the incident record, and the reply submitter is the dedicated Service Management user that you have configured. If you selected <strong>Show user name in application</strong>, your MS Teams user name should also appear on the <strong>Discussions</strong> tab.</li></ol>\n<h2><a id=\"How_tos\" name=\"How_tos\" title=\"How-tos\"></a>How-tos</h2>\n<p>This section provides instructions on how to configure field mapping, how to reactivate the integration, how to set up the sample use cases, and how to extend the integration. </p>\n<h3><a id=\"How_to_configure_field_mapping\" name=\"How_to_configure_field_mapping\" title=\"How to configure field mapping\"></a>How to configure field mapping</h3>\n<p>The MS Teams integration requires you to configure field mappings for each channel. This topic explains how to configure the field mappings. </p>\n<p>The integration supports up to 8 field mappings, four of which are fixed fields and the other are user-defined fields, as described in the following table. These field values constitute each message sent to the MS Teams channel. </p>\n<p>The following field mapping rules apply:</p>\n<table>\n<thead>\n<tr>\n<th>Property in Teams</th>\n<th>Description</th>\n<th>Note</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Subject</td>\n<td>Subject of the message </td>\n<td>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Required field</li><li style=\"margin-left: 28px; position: relative;\">You can't change the value of this field.</li></ul>\n</td>\n</tr>\n<tr>\n<td>Title</td>\n<td>Title of the message</td>\n<td>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Required field.</li><li style=\"margin-left: 28px; position: relative;\">Normally, you can use <strong>entity.DisplayLabel </strong>as its value.</li></ul>\n</td>\n</tr>\n<tr>\n<td>Timestamp</td>\n<td>A timestamp value</td>\n<td>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Optional field.</li><li style=\"margin-left: 28px; position: relative;\">This field is useful. You can map any Service Management time field to this field.</li></ul>\n</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Description of the message</td>\n<td>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Required field.</li><li style=\"margin-left: 28px; position: relative;\">Normally, you can use <strong>entity.Description</strong>, but you need to use function <strong>to_plain_text(content)</strong> to remove any html tags in the description content: <strong>to_plain_text(entity.Description)</strong>.</li><li style=\"margin-left: 28px; position: relative;\">Some record types don't use Description, for example, Problem uses Symptoms to describe a problem; be sure to use the right field for such a record type.</li></ul>\n</td>\n</tr>\n<tr>\n<td>Fact 1 label</td>\n<td colspan=\"1\" rowspan=\"8\">\n<p>The display labels and values of four user-defined fields.</p>\n</td>\n<td colspan=\"1\" rowspan=\"8\">\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">These are optional fields. </li><li style=\"margin-left: 28px; position: relative;\">You must enter the labels and values in pairs. </li></ul>\n</td>\n</tr>\n<tr>\n<td>Fact 1  value</td>\n</tr>\n<tr>\n<td>Fact 2 label</td>\n</tr>\n<tr>\n<td>Fact 2 value</td>\n</tr>\n<tr>\n<td>Fact 3 label</td>\n</tr>\n<tr>\n<td>Fact 3 value</td>\n</tr>\n<tr>\n<td>Fact 4 label</td>\n</tr>\n<tr>\n<td>Fact 4 value</td>\n</tr>\n</tbody>\n</table>\n<h4><a id=\"Variable_expression\" name=\"Variable_expression\" title=\"Variable expression\"></a>Variable expression</h4>\n<p>Use this syntax for a variable expression:<strong> entity.fieldName</strong>. Example: <strong>entiy.DisplayLabel</strong>. Here, <strong>entity</strong> can be any record type in Service Management. For example, when you configure Channel 1 to send Incident notification messages to an MS Teams channel, the field must be a property of Incident. Use a dot to separate the record type name and the field name.</p>\n<p>Currently, the integration supports entity link fields, and doesn't support array properties or many2many relationships. For example, you can use <strong>entity.Category.DisplayLabel</strong>, but can't use <strong>entity.DataDomains[0] &amp; entity.DeviceAffectedByProblem[0].DisplayLabel</strong>.</p>\n<h4><a id=\"String_constant\" name=\"String_constant\" title=\"String constant\"></a>String constant</h4>\n<p>You must enclose string constants in single quotation marks. Example: <strong>'Hello world'</strong>.</p>\n<h4><a id=\"Supported_functions\" name=\"Supported_functions\" title=\"Supported functions\"></a>Supported functions</h4>\n<p>You can use variables and string constants in any of the following functions:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><strong>concat(str1,str2,...)</strong>. This function concatenates all arguments into a single string.<br/>\n\tExample: <strong>concat('Hello' ,entity.DisplayLabel)</strong>.</li><li style=\"margin-left: 28px; position: relative;\"><strong>map(key_var,'k1|v1','k2|v2','k3|v3',...'kn|vn')</strong>. This function gets a matching value when key_var matches the key in the mapping.<br/>\n\tExample: <strong>map(entity.Priority, 'CriticalPriority|Critical', 'HighPriority|High', 'MediumPriority|Medium', 'LowPriority|Low')</strong>.</li><li style=\"margin-left: 28px; position: relative;\"><strong>format(long time, 'format', 'locale', 'timezone')</strong>. This function returns the formatted date according to the time and format entered. Specify <strong>long</strong> or <strong>short</strong> for the format parameter. The locale and timezone parameters are optional. If you omit them, the system uses the server's locale and timezone. <br/>\n\tExamples:\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\"><strong>format(entity.EmsCreationTime, 'long')</strong> returns a result like: <strong>April 16, 2021 at 9:50:27 AM CST</strong></li><li style=\"margin-left: 40px; position: relative;\"><strong>format(entity.EmsCreationTime, 'short')</strong> returns a result like: <strong>4/16/21, 1:50 AM</strong></li><li style=\"margin-left: 40px; position: relative;\"><strong>format(entity.EmsCreationTime, 'long','fr','Europe/Paris') </strong>returns a result like: <strong>19 avril 2021 à 07:33:45 CEST</strong> </li></ul>\n</li><li style=\"margin-left: 28px; position: relative;\"><strong>to_plain_text(content)</strong>. This function removes html tags from the content.<br/>\n\tExample: use <strong>to_plain_text('&lt;p&gt;hello&lt;/p&gt;')</strong> to return \"<strong>hello</strong>\".</li></ul>\n<h4><a id=\"Field_lengths\" name=\"Field_lengths\" title=\"Field lengths\"></a>Field lengths</h4>\n<p>The maximum field length for the following fields is 130 characters:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Fact 1 label</li><li style=\"margin-left: 28px; position: relative;\">Fact 2 label</li><li style=\"margin-left: 28px; position: relative;\">Fact 3 label</li><li style=\"margin-left: 28px; position: relative;\">Fact 4 label</li></ul>\n<h3><a id=\"How_to_reactivate_the_integration\" name=\"How_to_reactivate_the_integration\" title=\"How to reactivate the integration\"></a>How to reactivate the integration</h3>\n<p>You may have deactivated the MS Teams integration by clicking <strong>Inactive</strong> in the State section. To reactivate the integration, you must reconnect to MS Teams as described below.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the State section, click <strong>Active</strong>. Your existing integration settings appear. </li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Check that the integration settings are still valid.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Submit</strong>.<strong> </strong>Wait until the system returns a message indicating that the system has activated the integration successfully.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the Authentication section, click the link to authorize the integration if you haven't already done so before. </li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">The <strong>Connect to Microsoft Teams</strong> button now becomes active. Click this button, and then enter your MS Teams integration user credentials. The system displays a message stating that you have connected to MS Teams. </li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Check that the status icon next to <strong>Microsoft Teams</strong> on the left pane becomes green. Now, you have reactivated the integration.</li></ol>\n<h3><a id=\"How_to_set_up_the_sample_use_cases\" name=\"How_to_set_up_the_sample_use_cases\" title=\"How to set up the sample use cases\"></a>How to set up the sample use cases</h3>\n<p>The following are sample field mapping and business rule configurations required to set up certain the <em>sample use cases</em> section of this integration. </p>\n<p><strong>Major incident</strong></p>\n<p>You may want to configure the following field mappings to trigger the integration. </p>\n<table class=\"MsoTableGrid\" style=\"border-collapse:collapse; border:none\">\n<thead>\n<tr>\n<th scope=\"col\" style=\"border-width: 1px; border-style: solid; border-color: black; width: 170px; padding: 0in 7px;\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b>Field name</b></span></span></span></p>\n</th>\n<th scope=\"col\" style=\"border-bottom: 1px solid black; width: 431px; padding: 0in 7px; border-top: 1px solid black; border-right: 1px solid black; border-left: none;\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b>Example value</b></span></span></span></p>\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Title</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>concat('Major Incident - ', $entity.DisplayLabel)</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Description</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>to_plain_text($entity.Description)</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Timestamp</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>'Incident creation time: ' + format($entity.EmsCreationTime, 'long')</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 1 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Priority</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 1 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>map($entity.Priority, 'CriticalPriority|1-Critical', 'HighPriority|2-High', 'MediumPriority|3-Medium', 'LowPriority|4-Low')</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 2 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Status</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 2 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>map($entity.Status, 'Ready|Ready', 'InProgress|Work in progress', 'Pending|Pending customer', 'Suspended|Suspended','Complete|Solved')</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 3 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Affected Service</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 3 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>$entity.RegisteredForActualService.DisplayLabel</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 4 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Category</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 4 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>$entity.Category.DisplayLabel</span></span></span></span></span></p>\n</td>\n</tr>\n</tbody>\n</table>\n<p style=\"text-align: justify; margin-bottom: 11px;\">Also, in Studio, select the <strong>Incident</strong> record type, click <strong>Processes and Rules</strong>, under the <strong>After applying changes</strong> section, add a <strong>Call Integration Studio</strong> business rule that resembles the following.</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Parameter</th>\n<th scope=\"col\">Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Condition</td>\n<td><code>${entity.MajorIncident==true &amp;&amp; current_update.MajorIncident.IsChanged}</code></td>\n</tr>\n<tr>\n<td>Integration Type(Optional)</td>\n<td>Microsoft Teams</td>\n</tr>\n<tr>\n<td>Scenario Name</td>\n<td><code>Major Incident</code></td>\n</tr>\n</tbody>\n</table>\n<p style=\"text-align: justify; margin-bottom: 11px;\"><strong>Virtual CAB</strong></p>\n<p>You may want to configure a channel in the integration with the following field mapping to organize your virtual CAB meetings.</p>\n<table>\n<tbody>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:1px solid black; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b>Field name</b></span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:1px solid black; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b>Example value</b></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Title</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>concat('Pending approval - ', $entity.DisplayLabel)</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Description</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>to_plain_text($entity.Description)</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Timestamp</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>'Scheduled for: ' + format($entity.ScheduledStartTime, 'long')</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 1 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Priority</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 1 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>map($entity.Priority, 'CriticalPriority|1-Critical', 'HighPriority|2-High', 'MediumPriority|3-Medium', 'LowPriority|4-Low')</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 2 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Risk</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 2 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>map($entity.RiskAssessment, 'NoRisk|None', 'LowRisk|Low', 'SomeRisk|Some', 'ModerateRisk|Moderate','HighRisk|High','VeryHighRisk|Very High')</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 3 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Affected Service</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 3 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>$entity.AffectsActualService.DisplayLabel</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 4 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Owner Group</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 4 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>$entity.OwnedByGroup.Name</span></span></span></span></span></p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Also, add a business rule for the Change record type to trigger the integration. To do this:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to Studio, and select the <strong>Change</strong> record type.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Processes and Rules</strong> and then select the <strong>Normal</strong> flow.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select the transition from the <strong>Plan</strong> to the <strong>Approval plan</strong> phase, go to the \"During transition\" section and add a simple <strong>Call Integration Studio</strong> business rule that resembles the following.</li></ol>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Parameter</th>\n<th scope=\"col\">Value</th>\n</tr>\n<tr>\n<td>Integration Type(Optional)</td>\n<td>Microsoft Teams</td>\n</tr>\n<tr>\n<td>Scenario Name</td>\n<td><code>Virtual CAB</code></td>\n</tr>\n</thead>\n</table>\n<p><strong>Contract negotiations</strong></p>\n<p>You may want to configure a channel in the Integration with the following mapping to get informed about upcoming contract renewals.</p>\n<table class=\"MsoTableGrid\" style=\"border-collapse:collapse; border:none\">\n<thead>\n<tr>\n<th scope=\"col\" style=\"border-width: 1px; border-style: solid; border-color: black; width: 170px; padding: 0in 7px;\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b>Field name</b></span></span></span></p>\n</th>\n<th scope=\"col\" style=\"border-bottom: 1px solid black; width: 431px; padding: 0in 7px; border-top: 1px solid black; border-right: 1px solid black; border-left: none;\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b>Example value</b></span></span></span></p>\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Title</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>concat('Contract: ', $entity.DisplayLabel)</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Description</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>to_plain_text($entity.Description)</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Timestamp</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>'Expiration date: ' + format($entity.EndDate, 'long')</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 1 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Vendor</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 1 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>$entity.Vendor.DisplayLabel</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 2 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Contract type</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 2 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>$entity.ContractType</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 3 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Contract price</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 3 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>concat($entity.ContractPrice, ' ',$entity.Currency)</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 4 label</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Owner</span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:170px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fact 4 value</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:431px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>$entity.Administrator.Name</span></span></span></span></span></p>\n</td>\n</tr>\n</tbody>\n</table>\n<p>To send the contract details to MS Teams when a contract is about to expire, you may want to use the following example.</p>\n<p>First, add a Collaborate field:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to Studio.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select the <strong>Contract</strong> record type.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">On the Fields tab, add a new field named \"Collaborate\" of type Boolean.</li></ol>\n<p>Then, create a business rule:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>Processes and Rules</strong> tab.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>After applying changes</strong> section, add a <strong>Call Integration Studio</strong> business rule: \n\t<table>\n<thead>\n<tr>\n<th scope=\"col\">Parameter</th>\n<th scope=\"col\">Value</th>\n</tr>\n<tr>\n<td>Condition</td>\n<td><code>${entity.Collaborate_c==true&amp;&amp;current_update.Collaborate_c.IsChanged}}</code></td>\n</tr>\n<tr>\n<td>Integration Type(Optional)</td>\n<td>Microsoft Teams</td>\n</tr>\n<tr>\n<td>Scenario Name</td>\n<td><font face=\"monospace\">Contract Negotiation</font></td>\n</tr>\n</thead>\n</table>\n</li></ol>\n<p>You have the following options to set this field:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Put the field on the forms to allow users to manually set the \"Collaborate\" flag</li><li style=\"margin-left: 28px; position: relative;\">Create a business rule in the \"Per scheduler\" section to set the flag automatically when the contract is about to expire</li></ul>\n<h3><a id=\"How_to_trigger_actions_based_on_keywords_in_MS_Teams_replies\" name=\"How_to_trigger_actions_based_on_keywords_in_MS_Teams_replies\" title=\"How to trigger actions based on keywords in MS Teams replies\"></a>How to trigger actions based on keywords in MS Teams replies</h3>\n<p>The following gives an example of how to parse response messages from MS Teams with Service Management business rules. The example below is checking each MS Teams reply for a <strong>#solution</strong> string. If a reply starts with this string, the integration appends the reply to the Solution field of the Incident and sets a completion code for the Incident.</p>\n<p>This action moves the Incident to the Review phase automatically.</p>\n<p><strong>Example of an MS Teams reply</strong></p>\n<div><a class=\"image\" href=\"\"> <img alt=\"\" border=\"4\" file=\"/mediawiki/images/c/c6/SMAX_202105_teams_custom_action_keywords.png\" hspace=\"0\" src=\"../../../images/SMAX_202105_teams_custom_action_keywords_e0078f48.png\" style=\"width:705px;height:435px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:4px solid black;\" vspace=\"0\"/> </a></div>\n<p><strong>Result in Service Management</strong></p>\n<p>The solution entered in MS Teams is copied to the Solution field in Incident record in Service Management.</p>\n<p>To implement this action, perform the following steps in Service Management:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to Studio.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select a record type. In this example, select <strong>Incident</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Processes and Rules</strong>, and add a <strong>Set multiple fields</strong> business rule in the <strong>After Change</strong> section.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Configure the business rule with the following parameter values.\n\t<table class=\"MsoTableGrid\" style=\"margin-left:48px; border-collapse:collapse; border:none\" width=\"566\">\n<thead>\n<tr>\n<th scope=\"col\" style=\"border-width: 1px; border-style: solid; border-color: black; width: 81px; padding: 0in 7px;\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"text-justify:inter-ideograph\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b>Parameter</b></span></span></span></span></p>\n</th>\n<th scope=\"col\" style=\"border-bottom: 1px solid black; width: 485px; padding: 0in 7px; border-top: 1px solid black; border-right: 1px solid black; border-left: none; vertical-align: middle;\"><span style=\"font-size:11pt\"><span style=\"text-justify:inter-ideograph\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b>Value</b></span></span></span></span></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"border-bottom:1px solid black; width:81px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"text-justify:inter-ideograph\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Rule Type</span></span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:485px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"text-justify:inter-ideograph\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Set multiple fields</span></span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:81px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Condition</span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:485px; padding:0in 7px 0in 7px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span lang=\"EN-US\" style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>${current_update.Comments.IsChanged==true &amp;&amp; indexof(to_plain_text(extract_property(filter_comments(current_update.Comments.NewValue),'CommentBody')),'<span style=\"color:red\">#solution</span>')&gt;=0}</span></span></p>\n</td>\n</tr>\n<tr>\n<td rowspan=\"2\" style=\"border-bottom:1px solid black; width:81px; padding:0in 7px 0in 7px; height:32px; border-top:none; border-right:1px solid black; border-left:1px solid black\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"text-justify:inter-ideograph\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\">Fields</span></span></span></span></p>\n</td>\n<td style=\"border-bottom:1px solid black; width:485px; padding:0in 7px 0in 7px; height:32px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"text-justify:inter-ideograph\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Completion code </span></span></b></span></span></span></span></p>\n<p style=\"text-align:justify\"><span style=\"font-size:11pt\"><span style=\"text-justify:inter-ideograph\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>&lt;select an completion code&gt;</span></span></span></span></span></span></p>\n</td>\n</tr>\n<tr>\n<td style=\"border-bottom:1px solid black; width:485px; padding:0in 7px 0in 7px; height:73px; border-top:none; border-right:1px solid black; border-left:none\" valign=\"top\">\n<p><span style=\"font-size:11pt\"><span style=\"line-height:normal\"><span style=\"font-family:Calibri,sans-serif\"><b><span style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>Solution</span></span></b></span></span></span></p>\n<p><span lang=\"EN-US\" style=\"font-size:10.0pt\"><span style='font-family:\"Courier New\"'>${substring(extract_property(filter_comments (current_update.Comments.NewValue), 'CommentBody'),indexof(to_plain_text(extract_property(filter_comments(current_update.Comments.NewValue),'CommentBody')),'<span style=\"color:red\">#solution</span>')+9)}</span></span></p>\n</td>\n</tr>\n</tbody>\n</table>\n</li></ol>\n<h3><a id=\"How_to_set_up_custom_actions\" name=\"How_to_set_up_custom_actions\" title=\"How to set up custom actions\"></a>How to set up custom actions</h3>\n<p>The following describes how to implement two custom actions.</p>\n<h5><a id=\"Collaborate_in_MS_Teams\" name=\"Collaborate_in_MS_Teams\" title=\"Collaborate in MS Teams\"></a><strong>Collaborate in MS Teams</strong></h5>\n<p>This action enables users to open an MS Teams channel by clicking a button from the Service Management UI. </p>\n<p>First, perform these steps in MS Teams:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select the channel that you want to open directly from Service Management.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>More options</strong> icon for the channel, and then select <strong>Get link to channel </strong>to<strong> </strong>copy the link to a text file.</li></ol>\n<p>Then, perform these steps in Service Management Studio:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select a record type (for example, Incident).</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Custom actions</strong>, and then click <strong>New</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Specify the following field values for the new action:\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">Name: <strong>CollaborateinMSTeams</strong></li><li style=\"margin-left: 40px; position: relative;\">Display name: <strong>Collaborate in MS Teams</strong></li><li style=\"margin-left: 40px; position: relative;\">URL: insert the link to the MS Teams channel</li><li style=\"margin-left: 40px; position: relative;\">Icon: select an icon</li><li style=\"margin-left: 40px; position: relative;\">Position in record page: <strong>Show as primary</strong></li><li style=\"margin-left: 40px; position: relative;\">Position in grid page: <strong>Do not show</strong></li></ul>\n</li></ol>\n<p>Last, go to Application Settings in Service Management, enter <strong>teams.microsoft.com</strong> in the <strong>Authorized domains for navigation</strong> field. </p>\n<p>Now, you can verify the custom action: open an existing incident record, and then click the <strong>Collaborate in MS Teams</strong> button. </p>\n<h5><a id=\"Chat_with_an_End_User_in_MS_Teams\" name=\"Chat_with_an_End_User_in_MS_Teams\" title=\"Chat with an End User in MS Teams\"></a><strong>Chat with an End User in MS Teams</strong></h5>\n<p>Perform the following steps in Service Management:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In Studio, select a record type (for example, Incident).</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Custom actions</strong>, and then click <strong>New</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Specify the following field values for the new action:\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">Name: <strong>ChatEndUserMSTeams</strong></li><li style=\"margin-left: 40px; position: relative;\">Display name: <strong>Chat with end user</strong></li><li style=\"margin-left: 40px; position: relative;\">URL: <strong>https://teams.microsoft.com/l/chat/0/0?users=${entity.RequestedByPerson.Email}</strong>\n<p>This URL will start a chat in MS Teams with the user documented in the \"Reported By\" field in the Incident. The user must have an email address and be registered in your company's active directory.</p>\n</li><li style=\"margin-left: 40px; position: relative;\">Icon: select an icon</li><li style=\"margin-left: 40px; position: relative;\">Position in record type: <strong>Show as primary</strong></li><li style=\"margin-left: 40px; position: relative;\">Position in grid page: <strong>Do not show</strong></li></ul>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to Application Settings in Service Management, enter <strong>teams.microsoft.com</strong> in the <strong>Authorized domains for navigation</strong> field. </li></ol>\n<p>Now, you can open an existing incident record, and then click the <strong>Chat with end user</strong> button to verify the custom action.</p>\n<h2><a id=\"Limitations\" name=\"Limitations\" title=\"Limitations\"></a>Limitations</h2>\n<p>This integration has the following limitations:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">This integration doesn't support MS Teams reply messages that include attachments. </li><li style=\"margin-left: 28px; position: relative;\">This integration doesn't support the Dev2Prod process. After verifying the integration in the development system, you need to manually reconfigure the integration in production.</li><li style=\"margin-left: 28px; position: relative;\">When you export a tenant from Suite Administration, the configuration of this integration isn't exported.</li><li style=\"margin-left: 28px; position: relative;\">The integration doesn't support user options. You can't notify users with values captured in user options. </li></ul>\n<h2><a id=\"Troubleshooting\" name=\"Troubleshooting\" title=\"Troubleshooting\"></a>Troubleshooting</h2>\n<p>For troubleshooting information, see <a href=\"/doc/423/26.1/troubleshootmsteamsintegration\" title=\"Troubleshoot Microsoft Teams integration\">Troubleshoot Microsoft Teams integration</a>.</p>\n</div>",
  "modifiedon": "2025-12-01 18:13:55"
}