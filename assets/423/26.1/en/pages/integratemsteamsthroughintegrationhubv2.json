{
  "title": "Teams channel notification v2",
  "content": "<div class=\"mw-parser-output\">\n<div>\n<h2><a id=\"Overview\" name=\"Overview\" title=\"Overview\"></a>Overview</h2>\n<p>The Microsoft (MS) Teams integration version 2 takes advantage of all features of the Integration Studio framework and provides the following benefits:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Greater flexibility in configuring the integration.</li><li style=\"margin-left: 28px; position: relative;\">Allows customers to define their own adaptive cards that are sent directly to the MS Teams channel.</li></ul>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-important-icon\"></div><div class=\"admonition-content admonition-important-content\"><div><strong>Privacy notice</strong>\n<p>If you enable this integration, the application exchanges information with Microsoft Teams. It the customer’s responsibility to evaluate these specifications and ensure they meet the customer’s regulatory and business requirements.</p>\n</div></div></div>\n<h2><a id=\"Flavors\" name=\"Flavors\" title=\"Flavors\"></a>Flavors</h2>\n<div>This version of the MS Teams channel notification solution offers the following flavors for enabling notifications.</div>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><strong>Flavor 1</strong>: Subscription mode</li><li style=\"margin-left: 28px; position: relative;\"><strong>Flavor 2</strong>: Outgoing webhook mode</li></ul>\n<h3><a id=\"Subscription_mode\" name=\"Subscription_mode\" title=\"Subscription mode\"></a>Subscription mode</h3>\n<p>Microsoft allows customers to subscribe to specific resources, such as MS Teams channels. Once subscribed, Microsoft notifies the subscriber about changes to the resource.</p>\n<p>Using subscription mode ensures that when someone replies to a thread in a subscribed MS Teams channel, the message is sent to Service Management. The receiving scenario in Integration Studio then takes that reply and attaches it as a comment to the corresponding record</p>\n<p>In the case of MS Teams channels integration with Service Management, this means:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">When someone replies to a thread in the channel, the message is sent to Service Management.</li><li style=\"margin-left: 28px; position: relative;\">The receiving scenario in Integration Studio processes the reply and attaches the message as a comment to the record.</li></ul>\n<h3><a id=\"Outgoing_webhook_mode\" name=\"Outgoing_webhook_mode\" title=\"Outgoing webhook mode\"></a>Outgoing webhook mode</h3>\n<div>\n<p>MS Teams allows you to create an outgoing webhook for a team. To set up the webhook, the team owner assigns a name and a callback URL. The callback URL is the listener URL of a scenario in Integration Studio.</p>\n<p>To send a reply from an MS Teams channel back to Service Management: Users must type <strong>@&lt;name of the webhook&gt;</strong> followed by the message.</p>\n<p>This approach ensures the following:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Only messages that explicitly reference the webhook name are sent to Service Management.</li><li style=\"margin-left: 28px; position: relative;\">All other messages are not forwarded, unless the subscription mode is configured in parallel.</li></ul>\n</div>\n<div>The following sections explain how to set up the integration. Implement the option that is most suitable for your organization.</div>\n<h2 id=\"Create_an_endpoint\"><a id=\"Create_an_endpoint\" name=\"Create_an_endpoint\" title=\"Create an endpoint\"></a>Create an endpoint</h2>\n<p>Create an endpoint using the Rest Executor 2.0 endpoint type:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Administration &gt; Utilities &gt; Integration &gt; Endpoints</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Add</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select <strong>Rest Executor 2.0</strong> as the endpoint type, enter a name for the endpoint (for example, MS Teams), and click <strong>Add</strong>. The system creates the endpoint.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Configure</strong> and complete the following fields.\n\t<table>\n<thead>\n<tr>\n<th scope=\"col\">\n<div style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Field</div>\n</th>\n<th scope=\"col\">Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td colspan=\"2\"><strong>General configuration</strong></td>\n</tr>\n<tr>\n<td>Agent</td>\n<td>Select <strong>Agentless</strong> for a direct connection to the Graph API.</td>\n</tr>\n<tr>\n<td>Authentication type</td>\n<td>Select <strong>OAuth 2.0</strong></td>\n</tr>\n<tr>\n<td>Protocol</td>\n<td>Select <strong>https</strong>.</td>\n</tr>\n<tr>\n<td>Base URL</td>\n<td>Enter the base URL of the Graph API: <strong>https://graph.microsoft.com</strong>.</td>\n</tr>\n<tr>\n<td>Certificate type</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Certificate format</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Server certificate</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Enable email notification for expired token</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Recipients</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td colspan=\"2\"><strong>Get Token configuration</strong></td>\n</tr>\n<tr>\n<td>Grant Type</td>\n<td>\n<p>Authorization Code</p>\n</td>\n</tr>\n<tr>\n<td>Client ID</td>\n<td>The application ID (from the prerequisites step)</td>\n</tr>\n<tr>\n<td>Client Secret</td>\n<td>The client's secret value for the app. (from the prerequisites step)</td>\n</tr>\n<tr>\n<td>Authorization URL</td>\n<td>\n<p>The Authorization URL can be found under <strong>Endpoints</strong> for the app in the Azure Portal (use the v2 one).</p>\n<p>Add <code>&amp;prompt=login</code> at the end of the URL.</p>\n<p>Example: <strong>https://login.microsoftonline.com/&lt;Directory_Id&gt;/oauth2/v2.0/authorize?prompt=login</strong></p>\n</td>\n</tr>\n<tr>\n<td>Redirect URL</td>\n<td>Automatically generated.</td>\n</tr>\n<tr>\n<td>Token URL</td>\n<td>The URL can be found under <strong>Endpoints</strong> for the app in the Azure Portal (use the v2 one).</td>\n</tr>\n<tr>\n<td>Scope</td>\n<td>\n<p>Enter: <strong>https://graph.microsoft.com/.default offline_access</strong>.</p>\n</td>\n</tr>\n<tr>\n<td>State</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Send client Id and secret</td>\n<td>In body</td>\n</tr>\n</tbody>\n</table>\n</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Get token, </strong>complete the log in and consent process. If your endpoint configuration is correct, you will see the <b>Available </b>status in the <strong>Token status</strong> section after the process is finished.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save</strong>.</li></ol>\n<h2 id=\"Create_an_integration\"><a id=\"Create_an_integration\" name=\"Create_an_integration\" title=\"Create an integration\"></a>Create an integration</h2>\n<p>Perform the following steps to create an integration based on the Microsoft Graph connector.</p>\n<div>\n<div>\n<div>Create one dedicated integration for each record type.</div>\n</div>\n</div>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Administration </strong>&gt; <strong>Utilities </strong>&gt; <strong>Integration </strong>&gt; <strong>Integration Studio</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>New</strong>, enter the name of your integration, and click <strong>Save</strong>. The system displays the Integration page.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Details</strong> section, configure the integration user you created for the current Service Management system and activate the integration.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Connector-Endpoint mappings</strong> section, click <strong>Add</strong> to add a mapping.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select <strong>Graph</strong> (under <strong>Microsoft</strong>) as the connector, select the MS Teams endpoint created earlier, and enter an alias for the mapping.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save</strong>.</li></ol>\n<p>The manner in which the reply message is handled depends on the selected mode. Follow the instructions for the <strong>subscription mode</strong> or the <strong>outgoing webhook mode</strong>, based on your configuration.</p>\n<h3>Subscription mode</h3>\n<h4 id=\"Configure_the_scenario\"><a id=\"Configure_the_scenarios\" name=\"Configure_the_scenarios\" title=\"Configure the scenarios\"></a>Configure the scenarios</h4>\n<p>Perform the following steps to add and configure the scenarios for channel notifications and subscription handling. Use the predefined templates.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Add scenario</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter a name for the scenario. For example, enter \"<em>Major Incident Notification</em>\".</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Template</strong> field, select <strong>Teams - Send notification in channel</strong> (under <strong>Microsoft Graph</strong>) from the list. Using templates simplifies integration configuration compared to starting from scratch. If you do not use this option, you must manually add your logic, starting from a blank page.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save.</strong></li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>General </strong>section of the scenario, select <strong>Active</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Process logic</strong> section, locate the step<strong> MS Teams channel details</strong>, set the following parameters.\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\"><strong>TeamID</strong>: Enter the <strong>Team Id</strong> from your team in MS Teams.</li><li style=\"margin-left: 40px; position: relative;\"><strong>ChannelID</strong>: Enter the <strong>Channel Id</strong> (decoded) from your channel in MS Teams.</li><li style=\"margin-left: 40px; position: relative;\"><strong>InternalName</strong>: Enter your internal descriptive name for this channel. Do not use spaces and special characters in that name. This name is used as reference in the \"Stored data\" section to automatically subscribe to that channel in MS Teams.</li><li style=\"margin-left: 40px; position: relative;\"><strong>SubscriptionMode</strong>: Set to <strong>true</strong>, since you plan to run in the subscription mode.</li></ul>\n</li><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save.</strong></li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>Run</strong> button to let the scenario initialize.</li></ol>\n<div>Note the following:</div>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">To send messages into another MS Teams channel follow the steps 1 to 7 or copy the current scenario and change the settings described in item 5.</li><li style=\"margin-left: 28px; position: relative;\">To learn where to find the Team ID and Channel ID, see <a href=\"/doc/423/26.1/integratemsteamsthroughintegrationhubv2#Get_the_Team_ID\" title=\"How to\">How-tos</a> section.</li><li style=\"margin-left: 28px; position: relative;\">To learn how to change the out-of-the-box adaptive card to send different or additional details to MS Teams, see How-tos section.</li></ul>\n<div>\n<h4><a id=\"Set_up_subscription\" name=\"Set_up_subscription\" title=\"Set up subscription\"></a>Set up subscription</h4>\n<p>A subscription is required to ensure that messages entered in MS Teams are sent back to Service Management and attached to the corresponding ticket. Without this subscription, replies in MS Teams remain in the channel and do not update the ticket in Service Management.</p>\n<p>To setup the subscription perform the following steps. </p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Add scenario</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter a name for the scenario. For example, enter \"<em>Teams - Process replies (subscription)</em>\".</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Template</strong> field, select <strong>Teams - Process replies (subscription)</strong> (under <strong>Microsoft Graph</strong>) from the list.<br/>\n\tClick <strong>Save</strong></li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>General </strong>section of the scenario, select <strong>Active</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<ul style=\"padding-left: 0px;\"></ul>\n</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Listener</strong> section, create a listener.</li><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Process logic</strong> section, locate the step<strong> Settings.</strong></li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Set the <strong>UseMSTeamsUserNameInOTSM </strong>parameter to<strong> </strong><em>\"Select true to track your MS Teams user name on the <strong>Discussions/Comments</strong> capturing the replies made in MS Teams\".</em></li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save.</strong></li><li style=\"--number-width: 19px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>Run</strong> button to let the scenario initialize.\n\t<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>Each time the Listener URL changes, the scenario need to run again to ensure the subscription is created with the correct call back URL.</div></div></div>\n</li><li style=\"--number-width: 17px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Add scenario</strong>.</li><li style=\"--number-width: 19px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter a name for the scenario. For example, enter \"<em>Teams - Manage subscriptions</em>\".</li><li style=\"--number-width: 19px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Template</strong> field, select <strong>Teams - Manage subscriptions</strong> (under <strong>Microsoft Graph</strong>) from the list.</li><li style=\"--number-width: 19px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save.</strong></li><li style=\"--number-width: 19px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>General </strong>section of the scenario, select <strong>Active</strong>.</li><li style=\"--number-width: 19px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Listener</strong> section, create a listener.</li><li style=\"--number-width: 17px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save.</strong></li><li style=\"--number-width: 19px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>Run</strong> button to let the scenario initialize.</li></ol>\n<div>\n<div style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>Each time the Listener URL changes, the scenario need to run again to ensure the subscription is created with the correct call back URL.</div></div></div>\n<p><span id=\"cke_bm_108847C\" style=\"display: none;\"> </span></p>\n</div>\n<h4><a id=\"Schedule_subscription_refresh\" name=\"Schedule_subscription_refresh\" title=\"Schedule subscription refresh\"></a>Schedule subscription refresh</h4>\n<p>Microsoft subscriptions expire after a set time. If the subscription is not refreshed, notifications from MS Teams will stop. To ensure continuity of message flow from MS Teams to Service Management without manual intervention you must schedule the subscription refresh.</p>\n<p>Perform the following steps to schedule the scenario <strong>Teams - Manage subscriptions</strong><em>  </em>to refresh the subscription at Microsoft every 30 minutes.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to the scheduler and click <strong>Add.</strong></li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter a <strong>Name</strong>, select the <strong>Integration</strong> and the <strong>Scenario</strong> \"<em>Teams - Manage subscriptions\".</em></li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Next.</strong></li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select a <strong>Start date</strong>, set the <strong>Repeat Interval</strong> to 30 minutes, set end <strong>ending time</strong> to \"never\".</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Next</strong> and then click <strong>Save.</strong></li></ol>\n<h3>Outgoing webhook mode</h3>\n<h4>Configure the scenarios</h4>\n<p>Perform the following steps to add and configure the scenarios for channel notifications and subscription handling. Use the predefined templates.</p>\n<ol style=\"padding-left: 0px;\"></ol>\n<div>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Add scenario</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter a name for the scenario. For example, enter \"Major Incident Notification\".</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Template</strong> field, select <strong>Teams - Send notification in channel</strong> (under <strong>Microsoft Graph</strong>) from the list. Using templates simplifies integration configuration compared to starting from scratch. If you do not use this option, you must manually add your logic, starting from a blank page.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save.</strong></li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>General </strong>section, select <strong>Active</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Process logic</strong> section, locate the step<strong> MS Teams channel details</strong>, set the following parameters, and click <strong>Save</strong>.\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\"><strong>TeamID</strong>: Enter the <strong>Team Id</strong> from your team in MS Teams.</li><li style=\"margin-left: 40px; position: relative;\"><strong>ChannelID</strong>: Enter the <strong>Channel Id</strong> (decoded) from your channel in MS Teams.</li><li style=\"margin-left: 40px; position: relative;\"><strong>InternalName</strong>: Enter your internal descriptive name for this channel. Do not use spaces and special characters in that name. This name is used as reference in the <strong>Stored data</strong> section to automatically subscribe to that channel in MS Teams.</li><li style=\"margin-left: 40px; position: relative;\"><strong>SubscriptionMode</strong>: Set to <strong>false</strong>, since you plan to run in the subscription mode.</li></ul>\n</li><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save.</strong>\n<div>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-important-icon\"></div><div class=\"admonition-content admonition-important-content\"><div>To send messages into another MS Teams channel follow the steps 1 to 7 or copy the current scenario and change the settings described in item 5.</div></div></div>\n</div>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>\n<div>To learn where to find the Team ID and Channel ID please check the <a href=\"/doc/423/26.1/integratemsteamsthroughintegrationhubv2#Get_the_Team_ID\" title=\"How to\">How to</a> section below</div>\n<div>To learn how to change the out-of-the-box adaptive card to send different or additional details to MS Teams, please check the How to section</div>\n</div></div></div>\n</li></ol>\n<div>\n<h4><a id=\"Set_up_reply_handling\" name=\"Set_up_reply_handling\" title=\"Set up reply handling\"></a>Set up reply handling</h4>\n<p>Reply handling ensures that messages entered in MS Teams are sent back to Service Management and attached to the corresponding ticket. Without this setup, replies remain in MS Teams and do not update the ticket.</p>\n<p>To setup the reply handling perform the following steps. </p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Add scenario</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Enter a name for the scenario. For example, enter \"<em>Teams - Process replies (webhook)</em>\".</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Template</strong> field, select <strong>Teams - Process replies (webhook)</strong> (under <strong>Microsoft Graph</strong>) from the list.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save.</strong></li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>General </strong>section of the scenario, select <strong>Active</strong>.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Listener</strong> section, create a listener.</li><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>Process logic</strong> section, locate the step<strong> Settings</strong>, set the following parameter.\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\"><strong>UseMSTeamsUserNameInOTSM</strong>: Select true to track your MS Teams user name on the <strong>Discussions/Comments</strong> capturing the replies made in MS Teams.</li></ul>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save.</strong></li></ol>\n<div style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>Each time the Listener URL changes, copy the URL into the call back URL in the MS Teams webhook.</div></div></div>\n</div>\n</div>\n<h4><a id=\"Configure_the_outgoing_webhook_\" name=\"Configure_the_outgoing_webhook_\" title=\"Configure the outgoing webhook.\"></a>Configure the outgoing webhook.</h4>\n<p>Go to MS Teams to configure the outgoing webhook.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Ensure you have the correct permissions. You must be the team owner and must be allowed to add custom apps. If you do not see the webhook option, an MS Teams admin policy is likely blocking it. Check with your Teams admin to enable the option that allows users to use the webhook.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Open the Team channel where you want the webhook. Outgoing webhooks are created per team, not globally.</li></ol>\n<ul style=\"margin-left: 40px; padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Go to the Team where you want to add the webhook.</li><li style=\"margin-left: 28px; position: relative;\">Click the <strong>More options </strong>icon next to the team name.</li><li style=\"margin-left: 28px; position: relative;\">Select <strong>Manage team.</strong></li><li style=\"margin-left: 28px; position: relative;\">Go to the <strong>Apps </strong>tab.</li><li style=\"margin-left: 28px; position: relative;\">Click <strong>Create an outgoing webhook</strong> (usually bottom-left) and fill the form with the following information:\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\"><strong>Name</strong>: Whatever your webhook should be called in Teams. For example, Service Management.</li><li style=\"margin-left: 40px; position: relative;\">\n<p><strong>Callback URL</strong>: The listener URL from the scenario that will receive the POST requests. Append <code>&amp;teamid=&lt;your team id&gt;</code> to the listener URL.</p>\n</li><li style=\"margin-left: 40px; position: relative;\"><strong>Description</strong>: Optional.</li><li style=\"margin-left: 40px; position: relative;\"><strong>Profile picture</strong>: Optional.</li></ul>\n</li></ul>\n<div>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-important-icon\"></div><div class=\"admonition-content admonition-important-content\"><div>Messages sent via this method from MS Teams to Service Management cannot be verified against the HMAC signatur received from the MS Teams.</div></div></div>\n</div>\n</div>\n<h2><a id=\"Run_the_scenarios\" name=\"Run_the_scenarios\" title=\"Run the scenarios\"></a>Run the scenarios</h2>\n<div>\n<p>Create a business rule for the specified record type that triggers notification messages to MS Teams, based on the scenario you configured in the previous step.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In Studio, open the record type. For example, open <strong>Incident</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>Processes and Rules</strong> tab.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the <strong>After applying changes</strong> section, add a <strong>Call Integration Studio</strong> business rule.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select the integration and scenario to trigger.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\"><span>Save</span> your changes. </li></ol>\n</div>\n</div>\n</div>\n<h2><a id=\"How_tos\" name=\"How_tos\" title=\"How-tos\"></a><a id=\"How_to_s\" name=\"How_to_s\" title=\"How to's\"></a>How-tos</h2>\n<h3><a id=\"Get_the_Team_ID\" name=\"Get_the_Team_ID\" title=\"Get the Team ID\"></a>Get the Team ID</h3>\n<div>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Open <strong>Microsoft Teams</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to the <strong>Team</strong> you want.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>More options </strong>icon next to the team name.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Get link to team</strong>. You will get a link similar to the following: <code>https://teams.microsoft.com/l/team/19%3AXXXXXXXXXXXXXXXX%40thread.tacv2/conversations?groupId=aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee&amp;tenantId=ffffffff-gggg-hhhh-iiii-jjjjjjjjjjjj</code></li></ol>\n<p>Your Team ID is the<strong> <code inline=\"\">groupId</code></strong>. For example, <code>aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee</code>.</p>\n<h3><a id=\"Get_the_Channel_ID\" name=\"Get_the_Channel_ID\" title=\"Get the Channel ID\"></a>Get the Channel ID</h3>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to the <strong>Team</strong> you want.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>More options </strong>icon next to the <strong>Channel</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select <strong>Get link to channel</strong>. You will get a link similar to the following: <code>https://teams.microsoft.com/l/channel/19%3AXXXXXXXXXXXXXXXX%40thread.tacv2/General?groupId=aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee&amp;tenantId=ffffffff-gggg-hhhh-iiii-jjjjjjjjjjjj</code></li></ol>\n<p>Your Channel ID is the part after<strong> <code inline=\"\">/channel/</code> </strong>and before the next<strong> <code inline=\"\">/</code></strong>. For example, <code>19:XXXXXXXXXXXXXXX@thread.tacv2</code></p>\n<p>Verify that the Channel ID is decoded correctly. Refer to the examples below for incorrect and correct Channel ID decoding.</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><strong>Correct</strong>: <code>19:XXXXXXXXXXXXXXX@thread.tacv2</code></li><li style=\"margin-left: 28px; position: relative;\"><strong>Incorrect</strong>: <code>19%3AXXXXXXXXXXXXXXXX%40thread.tacv2</code></li></ul>\n<h3><a id=\"Modify_the_adaptive_card\" name=\"Modify_the_adaptive_card\" title=\"Modify the adaptive card\"></a>Modify the adaptive card</h3>\n<div>\n<div>The adaptive card is defined in the scenario <strong>Teams - Send notification in channel</strong>, in the <strong>Step 2 - Runtime data</strong> -&gt; <strong>AdaptiveCardTemplate</strong>. To modify the card, refer to the Microsoft's official documentation for <a href=\"https://adaptivecards.microsoft.com/designer\" title=\"Adaptive Card Designer\">Adaptive Card Designer</a>.</div>\n<p>The out of the box adaptive card resembles the following:</p>\n</div>\n<div><a class=\"image\" href=\"\"> <img alt=\"Adaptive Card - MS Teams channel notification\" src=\"../../../images/adaptiveCardOTSM_1ea78855.png\" style=\"width:506px;height:310px\"/> </a><br/>\n<br/>\nCopy the following JSON into the <strong>CARD PAYLOAD EDITOR</strong> field and modify the card as needed. After making your changes, copy the final JSON back into <strong>Step 2 – Runtime Data → AdaptiveCardTemplate</strong>.</div>\n<div>\n<pre><code class=\"language-json\">\n{\"type\":\"AdaptiveCard\",\"body\":[{\"type\":\"ColumnSet\",\"columns\":[{\"type\":\"Column\",\"width\":30,\"items\":[{\"type\":\"TextBlock\",\"text\":\"Title\",\"wrap\":true,\"weight\":\"Bolder\"}]},{\"type\":\"Column\",\"width\":70,\"items\":[{\"type\":\"TextBlock\",\"wrap\":true,\"text\":\"${Title}\"}]}]},{\"type\":\"ColumnSet\",\"columns\":[{\"type\":\"Column\",\"width\":30,\"items\":[{\"type\":\"TextBlock\",\"text\":\"Creation time\",\"wrap\":true,\"weight\":\"Bolder\"}]},{\"type\":\"Column\",\"width\":70,\"items\":[{\"type\":\"TextBlock\",\"wrap\":true,\"text\":\"${CreationTime}\"}]}]},{\"type\":\"ColumnSet\",\"columns\":[{\"type\":\"Column\",\"width\":30,\"items\":[{\"type\":\"TextBlock\",\"text\":\"Status\",\"wrap\":true,\"weight\":\"Bolder\"}]},{\"type\":\"Column\",\"width\":70,\"items\":[{\"type\":\"TextBlock\",\"text\":\"${Status}\",\"wrap\":true}]}],\"spacing\":\"Large\"},{\"type\":\"ColumnSet\",\"columns\":[{\"type\":\"Column\",\"width\":30,\"items\":[{\"type\":\"TextBlock\",\"text\":\"Service\",\"wrap\":true,\"weight\":\"Bolder\"}]},{\"type\":\"Column\",\"width\":70,\"items\":[{\"type\":\"TextBlock\",\"text\":\"${Service}\",\"wrap\":true}]}]},{\"type\":\"ColumnSet\",\"columns\":[{\"type\":\"Column\",\"width\":30,\"items\":[{\"type\":\"TextBlock\",\"text\":\"Category\",\"wrap\":true,\"weight\":\"Bolder\"}]},{\"type\":\"Column\",\"width\":70,\"items\":[{\"type\":\"TextBlock\",\"text\":\"${Category}\",\"wrap\":true}]}]},{\"type\":\"ColumnSet\",\"columns\":[{\"type\":\"Column\",\"width\":30,\"items\":[{\"type\":\"TextBlock\",\"text\":\"Priority\",\"wrap\":true,\"weight\":\"Bolder\"}]},{\"type\":\"Column\",\"width\":70,\"items\":[{\"type\":\"TextBlock\",\"text\":\"${Priority}\",\"wrap\":true}]}]},{\"type\":\"ColumnSet\",\"columns\":[{\"type\":\"Column\",\"width\":30,\"items\":[{\"type\":\"TextBlock\",\"text\":\"Description\",\"wrap\":true,\"weight\":\"Bolder\"}]},{\"type\":\"Column\",\"width\":70,\"items\":[{\"type\":\"TextBlock\",\"wrap\":true,\"spacing\":\"Medium\",\"text\":\"${Description}\",\"maxLines\":10}]}],\"spacing\":\"Large\"},{\"type\":\"ActionSet\",\"actions\":[{\"type\":\"Action.OpenUrl\",\"style\":\"positive\",\"title\":\"Open in Service Management\",\"url\":\"${URL}\"}]}],\"msteams\":{\"width\":\"Full\"},\"$schema\":\"http://adaptivecards.io/schemas/adaptive-card.json\",\"version\":\"1.6\"}</code></pre>\n</div>\n<p>The <strong><code>${&lt;FieldName&gt;}</code></strong> parameters are placeholders that are replaced with actual data in <strong>Step 11 – Common: Prepare Data and Adaptive Card</strong> of the scenario. Each placeholder corresponds to a separate key in Step 11, which is assigned a defined value.</p>\n<p>Note that the placeholder names in the adaptive card and the key names in Step 11 are case-sensitive</p>\n<div>\n<h2><a id=\"Set_up_the_sample_use_cases\" name=\"Set_up_the_sample_use_cases\" title=\"Set up the sample use cases\"></a>Set up the sample use cases</h2>\n</div>\n</div>\n<p>The following examples show the field mappings and business rule configurations required to set up the sample use cases in this integration.</p>\n<h3><a id=\"Major_incident\" name=\"Major_incident\" title=\"Major incident\"></a>Major incident</h3>\n<p>The Major incident use case enables agent users to work together on major incidents, helping resolve critical issues quickly. </p>\n<ul style=\"padding-left: 0px;\"></ul>\n<p>This use case demonstrates how to configure incident notification by adding a business rule to the Incident record type. The business rule triggers the integration when the specified conditions are met.</p>\n<p>To configure this use case, define the adaptive card as required for this channel notification, and complete the following steps:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to Studio</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select the <strong>Incident</strong> record type</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Processes and Rules</strong></li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to the <strong>After applying changes</strong> section and add a <strong>Call Integration Studio</strong> business rule. See the following sample:\n\t<table>\n<thead>\n<tr>\n<th scope=\"col\">Parameter</th>\n<th scope=\"col\">Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Condition</td>\n<td><code>${entity.MajorIncident==true &amp;&amp; current_update.MajorIncident.IsChanged}</code></td>\n</tr>\n<tr>\n<td>Integration</td>\n<td>&lt;Your Integration Name&gt;</td>\n</tr>\n<tr>\n<td>Scenario Name</td>\n<td>\n<p>&lt;Your Major Incident scenario name&gt;</p>\n</td>\n</tr>\n</tbody>\n</table>\n</li></ol>\n<h3><a id=\"Virtual_CAB\" name=\"Virtual_CAB\" title=\"Virtual CAB\"></a>Virtual CAB</h3>\n<p>The virtual CAB use case allows the system to notify Change Advisory Board (CAB) members about changes that are pending approval. </p>\n<p>This use case demonstrates how to configure a change notification by adding a business rule to the Change record type. The business rule triggers the integration when the specified conditions are met.</p>\n<p>To configure this use case, define the adaptive card as required for this channel notification and complete the following steps:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to Studio, and select the <strong>Change</strong> record type.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Processes and Rules</strong> and then select the <strong>Normal</strong> flow.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select the transition from the <strong>Plan</strong> to the <strong>Approval plan</strong> phase</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to the <strong>During transition</strong> section and add a <strong>Call Integration Studio</strong> business rule. See the following sample:\n\t<table>\n<thead>\n<tr>\n<th scope=\"col\">Parameter</th>\n<th scope=\"col\">Value</th>\n</tr>\n<tr>\n<td>Integration</td>\n<td>&lt;Your Integration Name&gt;</td>\n</tr>\n<tr>\n<td>Scenario Name</td>\n<td>\n<p>&lt;Your Major Incident scenario name&gt;</p>\n</td>\n</tr>\n</thead>\n</table>\n</li></ol>\n<h3><a id=\"Contract_negotiations\" name=\"Contract_negotiations\" title=\"Contract negotiations\"></a><strong>Contract negotiations</strong></h3>\n<p>The contract negotiations use case allows the system to notify upcoming contract renewals, you can configure a channel in the Integration to receive notification. </p>\n<p>This use case demonstrates how to configure a contract notification by adding a business rule to the Contract record type. The business rule triggers the integration when the specified conditions are met.</p>\n<p>To enable this use case, define the adaptive card as required for this channel notification and complete the following steps:</p>\n<p>Add a Collaborate field:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to Studio.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select the <strong>Contract</strong> record type.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">On the <strong>Fields </strong>tab, add a new field named <strong>Collaborate</strong> of type Boolean.</li></ol>\n<p>Create a business rule:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click the <strong>Processes and Rules</strong> tab.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to the <strong>After applying changes</strong> section and add a <strong>Call Integration Studio</strong> business rule. See the following sample:\n\t<table>\n<thead>\n<tr>\n<th scope=\"col\">Parameter</th>\n<th scope=\"col\">Value</th>\n</tr>\n<tr>\n<td>Condition</td>\n<td><code>${entity.Collaborate_c==true&amp;&amp;current_update.Collaborate_c.IsChanged}}</code></td>\n</tr>\n<tr>\n<td>Integration</td>\n<td>&lt;Your Integration Name&gt;</td>\n</tr>\n<tr>\n<td>Scenario Name</td>\n<td>\n<p>&lt;Your Major Incident scenario name&gt;</p>\n</td>\n</tr>\n</thead>\n</table>\n</li></ol>\n<p>You have the following options to set this field:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Put the field on the form to allow users to manually set the <strong>Collaborate</strong> flag.</li><li style=\"margin-left: 28px; position: relative;\">Create a business rule in the <strong>Per scheduler</strong> section to set the flag automatically when the contract is about to expire.</li></ul>\n</div>\n</div>",
  "modifiedon": "2025-11-21 13:22:36"
}