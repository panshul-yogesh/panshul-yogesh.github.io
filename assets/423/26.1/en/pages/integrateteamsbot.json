{
  "title": "Teams bot integration",
  "content": "<div class=\"mw-parser-output\">\n<p>It is now possible to use the Integration Studio as the bot engine for Microsoft Teams (MS Teams), leveraging the Integration Studio with the provided listener function. Once the MS Teams app/bot is created and published in your organization, the Integration Studio acts as the bot endpoint and can be used to handle a variety of use cases.  </p>\n<h2><a id=\"Use_cases\" name=\"Use_cases\" title=\"Use cases\"></a>Use cases</h2>\n<p>The MS Teams bot scenario templates that we provide can handle the following use cases.</p>\n<h3><a id=\"Interact_with_MS_Teams_Bot\" name=\"Interact_with_MS_Teams_Bot\" title=\"Interact with MS Teams Bot\"></a><span style=\"font-size: clamp(1.3125rem, 15.4737px + 1.15132vw, 1.75rem);\">Interact with MS Teams Bot</span></h3>\n<p>This template represents the bot <span class=\"nanospell-typo\">backend</span> and is the main template to handle all user messages in MS Teams (including questions, bot commands, user actions). MS Teams will push the messages to this template. Then the scenario analyzes and handles the messages accordingly. In this template, we implemented the use cases for handling the greeting message, raising a standard request, starting a Virtual Agent search, and opening service catalogue offerings.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>On <span class=\"nanospell-typo\">SaaS</span>, the bot supports answering user questions by using the Aviator. This requires the Aviator capability to be enabled and the <strong>Access Aviator</strong> permission to be assigned to end users. In on-premises environments or in <span class=\"nanospell-typo\">SaaS</span> tenants that don't have the Aviator capability enabled, the bot continues to answer questions using the classic Virtual Agent. For details about enabling the Aviator capability, see the <span class=\"nanospell-typo\">SaaS</span> documentation.</div></div></div>\n<h3><a id=\"Publish_hot_news_in_MS_Teams\" name=\"Publish_hot_news_in_MS_Teams\" title=\"Publish hot news in MS Teams\"></a>Publish hot news in MS Teams</h3>\n<p>This template handles the use case about hot news in the Knowledge Management module. Once the hot news is published, it's not only displayed in the Service Portal, but also pushed to MS Teams to the users who installed the bot. </p>\n<h3><a id=\"Send_request_notifications\" name=\"Send_request_notifications\" title=\"Send request notifications\"></a>Send request notifications </h3>\n<p>This template handles the use case to push request creation, update, and resolution notifications to the user in MS Teams. The user can then see the details and status of the request in MS Teams. The user can directly open the request in the Service Portal, mark the request as resolved, or add comments to the request.</p>\n<h2><a id=\"Technical_overview\" name=\"Technical_overview\" title=\"Technical overview\"></a>Technical overview</h2>\n<p>The following diagram illustrates the involved components for this integration.</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Teams’ Dev portal – Creates the MS Teams app and Bot.</li><li style=\"margin-left: 28px; position: relative;\">Teams’ Admin portal – Publishes the MS Teams app in your organization.</li><li style=\"margin-left: 28px; position: relative;\">Azure Bot Framework <span class=\"nanospell-typo\">API</span>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">Sends all the data entered by the user in MS Teams to the Listener of the integration.</li><li style=\"margin-left: 40px; position: relative;\">Receives the answers to the user’s questions from the BOT Logic in the integration.</li></ul>\n</li><li style=\"margin-left: 28px; position: relative;\">MS Graph <span class=\"nanospell-typo\">API</span> – Performs certain validations in the Azure ecosystem.</li><li style=\"margin-left: 28px; position: relative;\">MS Teams – User interface</li></ul>\n<div><a class=\"image\" href=\"\"> <img alt=\"architecture diagram\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/1/1d/MSTeamtBotOverview.PNG\" hspace=\"0\" src=\"../../../images/MSTeamtBotOverview_4823af1d.png\" style=\"width:800px;height:329px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a></div>\n<h2><a id=\"Configure_apps_in_MS_Teams_and_Azure\" name=\"Configure_apps_in_MS_Teams_and_Azure\" title=\"Configure apps in MS Teams and Azure\"></a>Configure <span class=\"nanospell-typo\">apps</span> in MS Teams and Azure</h2>\n<h3><a id=\"Create_a_bot_in_Microsoft_Teams\" name=\"Create_a_bot_in_Microsoft_Teams\" title=\"Create a bot in Microsoft Teams\"></a>Create a bot in Microsoft Teams </h3>\n<p>You must create a Bot in Microsoft Teams to integrate with the bot <span class=\"nanospell-typo\">backend</span> in Integration Studio.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to the Teams <a href=\"https://dev.teams.microsoft.com/\" title=\"Developer Portal\">Developer Portal</a>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Create a Bot:\n\t<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 21px; --number-spacing: 25px; margin-left: 49px; position: relative;\">Navigate to <strong>Tools &gt; Bot management</strong>.</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Click <strong>+ New Bot</strong>, provide a bot name of your choice, and then click <strong>Add</strong>.</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Open the bot that you created and click the <strong>Configure</strong> tab. </li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<p>Under <strong>Endpoint address</strong>, enter the listener <span class=\"nanospell-typo\">URL</span> generated from the Integration Studio scenario. You need to come back to this step once the listener <span class=\"nanospell-typo\">URL</span> is created in the Integration Studio. </p>\n<div><a class=\"image\" href=\"\"> <img alt=\"endpoint address config form\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/4/40/TeamsBotEndpoint.png\" hspace=\"0\" src=\"../../../images/TeamsBotEndpoint_3fffc0d6.png\" style=\"width:800px;height:345px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a></div>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Navigate to <strong>Channels</strong> and make sure that the Microsoft Teams channel is selected. </li></ol>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Generate client secret:\n\t<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 21px; --number-spacing: 25px; margin-left: 49px; position: relative;\">Navigate to <strong>Client secrets</strong> and click <strong>Add</strong> to add a client secret for your bot.</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Copy the value of the client secret from the <strong>New client secret generated</strong> dialog for later use as it is displayed only during this step. </li></ol>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Copy the Bot ID:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 22px; --number-spacing: 26px; margin-left: 50px; position: relative;\">\n<p>Navigate to <strong>Tools &gt; Bot management &gt; Bot ID. </strong></p>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<p>Copy the Bot ID and the Bot Name of the bot you created. You will need the ID and name later.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"BOT ID\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/a/ab/TeamsBotBotId.png\" hspace=\"0\" src=\"../../../images/TeamsBotBotId_1ddf7982.png\" style=\"width:800px;height:218px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a></div>\n</li></ol>\n</li></ol>\n<h3><a id=\"Add_the_app_to_MS_Teams\" name=\"Add_the_app_to_MS_Teams\" title=\"Add the app to MS Teams\"></a>Add the app to MS Teams</h3>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Download the MAX app from the <a href=\"https://marketplace.opentext.com/itom/content/smax-microsoft-teams-app-for-bot-integration\" title=\"ITOM Marketplace\"><span class=\"nanospell-typo\">ITOM</span> Marketplace</a>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to the MS Teams Developer Portal. </li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Import the app:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 21px; --number-spacing: 25px; margin-left: 49px; position: relative;\">\n<p>Navigate to <strong><span class=\"nanospell-typo\">Apps</span></strong>, and then click <strong>Import App</strong>.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Import app button\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/a/a3/TeamsBotImportApp.png\" hspace=\"0\" src=\"../../../images/TeamsBotImportApp_b3aa0137.png\" style=\"width:800px;height:204px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a></div>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">Import the MAX app.</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<p>After the app is imported, click <strong>Basic Information</strong> and copy the <strong>App ID</strong>. You need the App Id in the Integration Studio scenarios. </p>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<p>Click <strong>Basic Information</strong> -&gt; <strong>Application (client) ID.</strong></p>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<p>Enter the Bot ID copied in <em>Copy the Bot ID</em> step of the section <em>Create a bot in Microsoft Teams.</em></p>\n</li><li style=\"--number-width: 25px; --number-spacing: 29px; margin-left: 53px; position: relative;\">\n<div>\n<p>Click <strong>Save</strong>. </p>\n<a class=\"image\" href=\"\"> <img alt=\"App Id copy function\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/7/76/TeamsBotAppIDNew.png\" hspace=\"0\" src=\"../../../images/TeamsBotAppIDNew_dbd88474.png\" style=\"width:800px;height:572px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a></div>\n</li></ol>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>To <span class=\"nanospell-typo\">associa</span><span id=\"cke_bm_36506C\" style=\"display: none;\"> </span>te the Bot ID with the imported application, click <strong>App features</strong> &gt; <strong>Bot</strong>, and select the bot you created in the earlier step. </p>\n</li></ol>\n<div style=\"--number-width: 22px; --number-spacing: 26px; margin-left: 50px; position: relative;\"><a class=\"image\" href=\"\"> <img alt=\"Location of BOT button\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/6/6b/TeamsBotSelectApp.png\" hspace=\"0\" src=\"../../../images/TeamsBotSelectApp_6ec20903.png\" style=\"width:800px;height:225px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a></div>\n<ol start=\"5\" style=\"padding-left: 0px;\"><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Publish the app in your organization.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Publish bot menu\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/2/29/TeamsBotPublishApp.png\" hspace=\"0\" src=\"../../../images/TeamsBotPublishApp_c3ecc5a5.png\" style=\"width:800px;height:600px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a></div>\n</li></ol>\n<h3><a id=\"Approve_the_app\" name=\"Approve_the_app\" title=\"Approve the app\"></a>Approve the app</h3>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Log in to the Microsoft Teams Admin Center.</p>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Navigate to <strong>Teams <span class=\"nanospell-typo\">apps</span> &gt; Manage <span class=\"nanospell-typo\">Apps</span></strong>.</p>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Search for and select the MAX app.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Manage Apps menu\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/5/50/TeamsBotSelectMAX.png\" hspace=\"0\" src=\"../../../images/TeamsBotSelectMAX_54b1f5ef.png\" style=\"width:800px;height:508px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a></div>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Publish the app.</p>\n</li></ol>\n<h3><a id=\"Configure_the_MAX_Virtual_Agent_app_in_Azure_Portal\" name=\"Configure_the_MAX_Virtual_Agent_app_in_Azure_Portal\" title=\"Configure the MAX Virtual Agent app in Azure Portal\"></a>Configure the MAX Virtual Agent app in Azure Portal</h3>\n<div>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Log in to the <a href=\"https://portal.azure.com\" title=\"Azure Portal\">Azure Portal</a>.</p>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Navigate to <strong>App registrations</strong>.</p>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Locate and select the <strong>Max Virtual Agent</strong> app. This is the bot you created in the section titled <em>Create a bot in Microsoft Teams</em></p>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the Overview page, copy the <strong>Directory (tenant) ID</strong> value. You will need this in a later step.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Authentication </strong>and update the <strong>Supported Account Types</strong> setting.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<div>If the Supported account types field shows <strong>My organization only</strong>, click the <strong>My organization only</strong> link and change the setting to <strong>Accounts in this organizational directory only (Microsoft <span class=\"nanospell-typo\">Entra</span> ID tenant only – Single tenant)</strong>.</div>\n</li><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<div>Click <strong><span class=\"nanospell-typo\">API</span> permissions</strong> in the left pane, and then add the following <strong>Application permissions</strong>. Make sure you grant admin consent.</div>\n</li></ol>\n<ul style=\"margin-left: 40px; padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">\n<p>Chat.<span class=\"nanospell-typo\">ReadBasic</span>.All</p>\n</li><li style=\"margin-left: 28px; position: relative;\"><span class=\"nanospell-typo\">TeamsAppInstallation</span>.<span class=\"nanospell-typo\">ReadForUser</span>.All</li><li style=\"margin-left: 28px; position: relative;\">User.Read.All</li></ul>\n</div>\n<h2><a id=\"Configure_Service_Management\" name=\"Configure_Service_Management\" title=\"Configure Service Management\"></a>Configure Service Management</h2>\n<h3><a id=\"Prepare_an_integration_user\" name=\"Prepare_an_integration_user\" title=\"Prepare an integration user\"></a>Prepare an integration user</h3>\n<p>Perform the following steps to prepare an integration user:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Create an integration user. See <a href=\"/doc/423/26.1/createuser\" title=\"How to create a user\">How to create an integration user</a>.</p>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Log in to the Agent Portal as the tenant admin, navigate to <strong>Administration &gt; Master Data &gt; People</strong>, locate the integration user, and then assign the user a custom role with the following permissions: the <strong>On-Premise Bridge/Integration Administrator</strong> permission, the <strong>View</strong> permission for the Article, People, and Request record types.</p>\n<p>Alternatively, add the Tenant Admin role to grant general access.</p>\n</li></ol>\n<h3><a id=\"Create_an_endpoint_to_connect_to_the_MS_Graph_API\" name=\"Create_an_endpoint_to_connect_to_the_MS_Graph_API\" title=\"Create an endpoint to connect to the MS Graph API\"></a>Create an endpoint to connect to the MS Graph <span class=\"nanospell-typo\">API</span></h3>\n<p>Create an endpoint using the Rest Executor 2.0 endpoint type. </p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to the Agent Portal as the integration administrator.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Administration &gt; Utilities &gt; Integration &gt; Endpoints</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Add</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select Rest Executor 2.0 as the endpoint type, enter a name for the endpoint (for example, MS Graph), and then click <strong>Add</strong>. The system creates the endpoint.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Click <strong>Configure</strong> and complete the following fields.</p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\">\n<thead>\n<tr>\n<th scope=\"col\">Field</th>\n<th scope=\"col\">Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td colspan=\"2\"><strong>General configuration</strong></td>\n</tr>\n<tr>\n<td>Agent</td>\n<td>Select <strong><span class=\"nanospell-typo\">Agentless</span></strong> for a direct connection to the Graph <span class=\"nanospell-typo\">API</span>.</td>\n</tr>\n<tr>\n<td>Authentication type</td>\n<td>Select <strong><span class=\"nanospell-typo\">OAuth</span> 2.0</strong></td>\n</tr>\n<tr>\n<td>Protocol</td>\n<td>Select <strong><span class=\"nanospell-typo\">https</span></strong>.</td>\n</tr>\n<tr>\n<td>Base <span class=\"nanospell-typo\">URL</span></td>\n<td>Enter the base <span class=\"nanospell-typo\">URL</span> of the Graph <span class=\"nanospell-typo\">API</span>: <code>https://graph.microsoft.com</code></td>\n</tr>\n<tr>\n<td>Certificate type</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Certificate format</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Server certificate</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Enable email notification for expired token</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Recipients</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td colspan=\"2\"><strong>Get Token configuration</strong></td>\n</tr>\n<tr>\n<td>\n<p>Grant Type</p>\n</td>\n<td>\n<p>Select <strong>Client Credentials</strong></p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Client ID</p>\n</td>\n<td>\n<p>The App Id (Bot Id) of the bot. For details, refer to the<em> Copy the Bot ID</em> step in the section titled <em>Create a bot in Microsoft Teams</em>.</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Client Secret</p>\n</td>\n<td>\n<p>The secret for the app / bot. For details, refer to the <em>Generate client secret</em> step in the section titled <em>Create a bot in Microsoft Teams</em>.</p>\n</td>\n</tr>\n<tr>\n<td>Token <span class=\"nanospell-typo\">URL</span></td>\n<td>\n<p><code>https://login.microsoftonline.com/<em><strong>&lt;Directory Id (tenant Id) from Azure Portal&gt;</strong></em>/oauth2/v2.0/token.</code><br/>\n\t\t\t\tFor tenant Id details, refer to the section titled <em>Configure the MAX Virtual Agent app in Azure Portal.</em></p>\n</td>\n</tr>\n<tr>\n<td>Scope</td>\n<td>\n<p><code>.default offline_access</code></p>\n<p>See the <a href=\"https://learn.microsoft.com/en-us/azure/active-directory/develop/scopes-oidc\" title=\"Microsoft documentation\">Microsoft documentation</a> for details.</p>\n</td>\n</tr>\n<tr>\n<td>Send client Id and secret</td>\n<td>In body</td>\n</tr>\n</tbody>\n</table>\n</li></ol>\n<h3><a id=\"Create_an_endpoint_to_connect_to_the_Azure_Bot_Framework_API\" name=\"Create_an_endpoint_to_connect_to_the_Azure_Bot_Framework_API\" title=\"Create an endpoint to connect to the Azure Bot Framework API\"></a>Create an endpoint to connect to the Azure Bot Framework <span class=\"nanospell-typo\">API</span></h3>\n<p>Create an endpoint using the Rest Executor 2.0 endpoint type. </p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to the Agent Portal as the integration administrator.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Navigate to <strong>Administration &gt; Utilities &gt; Integration &gt; Endpoints</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Add</strong>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select Rest Executor 2.0 as the endpoint type, enter a name for the endpoint (for example, MS Bot), and then click <strong>Add</strong>. The system creates the endpoint.</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Click <strong>Configure</strong> and complete the following fields.</p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\">\n<thead>\n<tr>\n<th scope=\"col\">Field</th>\n<th scope=\"col\">Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td colspan=\"2\"><strong>General configuration</strong></td>\n</tr>\n<tr>\n<td>Agent</td>\n<td>Select <strong><span class=\"nanospell-typo\">Agentless</span></strong> for a direct connection to the Azure Bot Framework <span class=\"nanospell-typo\">API</span>.</td>\n</tr>\n<tr>\n<td>Authentication type</td>\n<td>Select <strong><span class=\"nanospell-typo\">OAuth</span> 2.0</strong></td>\n</tr>\n<tr>\n<td>Protocol</td>\n<td>Select <strong><span class=\"nanospell-typo\">https</span></strong>.</td>\n</tr>\n<tr>\n<td>Base <span class=\"nanospell-typo\">URL</span></td>\n<td>\n<p>Enter the base <span class=\"nanospell-typo\">URL</span> of the Azure Bot Framework <span class=\"nanospell-typo\">API</span>: <code>https://smba.trafficmanager.net/<em>teams</em>/</code></p>\n<p>See the <a href=\"https://learn.microsoft.com/en-us/azure/bot-service/rest-api/bot-framework-rest-connector-api-reference?view=azure-bot-service-4.0#base-uri\" title=\"Microsoft documentation\">Microsoft documentation</a> for details on how to get the base <span class=\"nanospell-typo\">URL</span> for the Azure Bot Framework.</p>\n</td>\n</tr>\n<tr>\n<td>Certificate type</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Certificate format</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Server certificate</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Enable email notification for expired token</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td>Recipients</td>\n<td>Optional</td>\n</tr>\n<tr>\n<td colspan=\"2\"><strong>Get Token configuration</strong></td>\n</tr>\n<tr>\n<td>\n<p>Grant Type</p>\n</td>\n<td>\n<p>Select <strong>Client Credentials</strong>.</p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Client ID</p>\n</td>\n<td>The App Id (Bot Id) of the bot. For details, refer to the <em>Copy the Bot ID</em> step in the section titled <em>Create a bot in Microsoft Teams</em>.</td>\n</tr>\n<tr>\n<td>\n<p>Client Secret</p>\n</td>\n<td>The secret for the app / bot. For details, refer to the <em>Generate client secret</em> step in the section titled <em>Create a bot in Microsoft Teams</em>.</td>\n</tr>\n<tr>\n<td>Token <span class=\"nanospell-typo\">URL</span></td>\n<td><code>https://login.microsoftonline.com/<strong>&lt;Directory Id (tenant Id) from Azure Portal&gt;</strong>/oauth2/v2.0/token</code></td>\n</tr>\n<tr>\n<td>Scope</td>\n<td>\n<p><code>https://api.botframework.com/.default</code></p>\n<p>See the <a href=\"https://learn.microsoft.com/en-us/azure/active-directory/develop/scopes-oidc\" title=\"Microsoft documentation\">Microsoft documentation</a> for details.</p>\n</td>\n</tr>\n<tr>\n<td>Send client Id and secret</td>\n<td>In body</td>\n</tr>\n</tbody>\n</table>\n</li></ol>\n<h3><a id=\"Create_an_integration\" name=\"Create_an_integration\" title=\"Create an integration\"></a>Create an integration</h3>\n<p>Create an integration and define your business logic for the MS Teams bot integration.</p>\n<p>The MS Teams bot integration uses the Microsoft Graph and Azure Bot Framework connectors and has the following pre-defined templates:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Interact with MS Teams Bot</li><li style=\"margin-left: 28px; position: relative;\">Send news notification</li><li style=\"margin-left: 28px; position: relative;\">Send request notification</li></ul>\n<p>To take advantage of all use cases, you need to set up all scenarios. However, to start chatting with the bot in MS Teams, only the Interact with MS Teams Bot scenario is required. This template contains the logic to handle the messages entered in MS Teams. This scenario is configured with a listener to which MS Teams sends the messages.</p>\n<p>In the following steps, you'll create an integration with the pre-defined templates.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Navigate to <strong>Administration</strong> &gt; <strong>Utilities</strong> &gt; <strong>Integration</strong> &gt; <strong>Integration Studio</strong>. </p>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>New</strong>, enter the name of your integration, and then click <strong>Save</strong>. The system displays the Integration page.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the Details section, configure the integration user you created for the current Service Management system and activate the integration.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">In the Connector-Endpoint mappings section, click <strong>Add</strong> to add the following mappings.\n\t<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">Select <strong>Graph</strong> (under <strong>Microsoft</strong>) as the connector, select the MS Graph endpoint that you created earlier, and then enter an alias for the mapping.</li><li style=\"margin-left: 40px; position: relative;\">Select <strong>Azure Bot Framework Connector <span class=\"nanospell-typo\">API</span></strong> (under <strong>Microsoft</strong>) as the connector, select the MS Bot endpoint that you created earlier, and then enter an alias for the mapping.</li></ul>\n</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Click <strong>Save</strong>. </li></ol>\n<h3><a id=\"Configure_the_scenario\" name=\"Configure_the_scenario\" title=\"Configure the scenario\"></a>Configure the scenario</h3>\n<p>We recommend starting with the out-of-the-box scenario for this integration.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>You need to configure the <strong>Interact with MS Teams Bot</strong> scenario first, and then configure the following scenarios (which are optional): <strong>Send News Notification</strong>, and <strong>Send Request Notification</strong>.</div></div></div>\n<p>Perform the following steps to add the scenario to handle messages received from MS Teams:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Click <strong>Add scenario</strong>. </p>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Enter a name for the scenario. For example, enter <strong>Interact with MS Teams</strong>.</p>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>In the <strong>Template</strong> field, select <strong>Interact with MS Teams Bot</strong> from the list.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>Using templates will make the integration configuration easier than starting from scratch. If you don't select this option, you'll have to manually add your own logic, starting from a blank page.</div></div></div>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Make sure <strong>Enable Listener</strong> is selected. <br/>\n<br/>\n\tThis is required only for the <strong>Interact with MS Teams Bot</strong> scenario. The Send News Notification, and Send Request Notification scenarios don't require you to enable a listener.</p>\n</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Click <strong>Save</strong> to add the scenario. </p>\n</li><li style=\"--number-width: 12px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Configure the parameters described below, and then click <strong>Save</strong>.</p>\n<p>The table describes the parameters that you can modify to control the behavior of the scenarios. These parameters are located in the <strong>Settings</strong> rule at the start of the <strong>Process logic</strong> section. Modify them before you run the integration.<br/>\n\t </p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 700px;\">\n<thead>\n<tr>\n<th scope=\"col\">Scenario name</th>\n<th scope=\"col\">Options to be considered before using the scenario </th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\n<p>Interact with MS Teams Bot</p>\n</td>\n<td>\n<p><strong>Settings rule (optional):</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">BotId</span></strong>: The MS Teams App Id. For details, refer to the section titled <em>Add the app to MS Teams.</em></li><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">UserVerificationField</span>:</strong> The property to identify the users in Service Management. By default, it's <strong>Email</strong>. </li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong><span class=\"nanospell-typo\">MaxResultsByNormalSearch</span>:</strong> The maximum number of search results posted to MS Teams.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>Increasing this number might impact performance. The returned results are taken from the top until the number is reached.</div></div></div>\n</li><li style=\"margin-left: 28px; position: relative;\">\n<p><strong><span class=\"nanospell-typo\">SourceRequestForm</span>:</strong> <span style=\"background-color: transparent;\">This parameter determines the system behavior when the user clicks the <strong>Create standard request</strong> button on the card displayed in response to the <em>hi</em> or <em>restart</em> command. Possible values:</span></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 40px; position: relative;\">\n<p><span style=\"background-color: transparent;\">'</span><span style=\"background-color: transparent;\">Teams': Display the Create Request card in Teams so that the user can directly create a request in Teams.</span></p>\n</li><li style=\"margin-left: 40px; position: relative;\">\n<p><span style=\"background-color: transparent;\">'Portal': Open the Create standard request form in the Service Portal based on the default offering.</span></p>\n</li></ul>\n</li></ul>\n<p><strong>Define prompt rule (optional):</strong></p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><strong>greet:</strong> The greeting message displayed when the <em>hi</em> or <em>restart</em> command is sent to the bot.</li><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">failGetSuggestions</span>:</strong> Error message when the system encounters errors during the execution of virtual agent-related actions.</li><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">noResultFound</span>:</strong> The message displayed when the bot can't find the answer to the user's question.</li><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">sessionWarn</span>:</strong> (Aviator only) The warning message displayed when the answer provided by the bot is not based on the conversation context because of conversation session expiration.</li><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">failRequestOperation</span>:</strong> Error message when the system encounters errors during the execution of request handling actions.</li><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">truncateWarn</span>:</strong> (Aviator only) The message displayed when the relevant conversation context is truncated.</li><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">restartWarn</span>:</strong> The message displayed when the <em>restart</em> command is sent to the bot.</li><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">tipsExplain</span>:</strong> The headline of the Tips card that is displayed when the <em>help</em> command is sent to the bot.</li></ul>\n</td>\n</tr>\n<tr>\n<td>Send news notification</td>\n<td>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">PageSize</span>: </strong>You can optionally change the number of users to whom you want to send news notifications each time (default: 100). </li></ul>\n</td>\n</tr>\n<tr>\n<td>\n<p>Send request notification</p>\n</td>\n<td>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\"><strong><span class=\"nanospell-typo\">RequestURLTemplate</span>:</strong> The <span class=\"nanospell-typo\">URL</span> of the request.</li></ul>\n</td>\n</tr>\n</tbody>\n</table>\n</li></ol>\n<ul style=\"padding-left: 0px;\"></ul>\n<h2><a id=\"Use_the_scenarios\" name=\"Use_the_scenarios\" title=\"Use the scenarios\"></a>Use the scenarios</h2>\n<h3>Interact with MS Teams Bot</h3>\n<p>This scenario is triggered ONLY from MS Teams via the listener. To use the listener <span class=\"nanospell-typo\">URL</span> as an endpoint in the MS Teams bot:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Log in to the MS Teams Developer Portal.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Access the bot created in the section titled <em>Create a bot in Microsoft Teams</em>.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Copy the Integration Studio listener <span class=\"nanospell-typo\">URL</span> into the <strong>Endpoint address</strong> field.</li></ol>\n<h3><a id=\"Send_news_notification\" name=\"Send_news_notification\" title=\"Send news notification\"></a>Send news notification</h3>\n<p>This scenario is triggered by a business rule in Studio.</p>\n<p>Perform the following configuration to push hot news to the users who installed the bot in MS Teams.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to Studio.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select the Article record type.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Add a business rule <strong>Call Integration Engine</strong> in the <strong>During transition</strong> section to trigger the integration based on your requirements. The example below might not be sufficient for your use cases.</li></ol>\n<p>Example:</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Workflow 2\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/b/ba/TeamsBotHotNews.png\" hspace=\"0\" src=\"../../../images/TeamsBotHotNews_1607b1cf.png\" style=\"width:800px;height:315px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a></div>\n<h3><a id=\"Send_request_notification\" name=\"Send_request_notification\" title=\"Send request notification\"></a>Send request notification</h3>\n<p>This scenario can be triggered when a new request is created. The scenario will then push a request creation notification to users in MS Teams.</p>\n<p>To activate this notification, perform the following steps. </p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Go to Studio.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Select the Request record type</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Add a business rule <strong>Call Integration Engine</strong> in the <strong>After applying changes</strong> section to trigger the integration based on your requirements.<br/>\n\tAdd conditions to the rule to implement the business logic of the use cases.</li></ol>\n<p>The following shows the conditions for some example use cases. The conditions might not be sufficient for your use cases.</p>\n<p><strong>Examples</strong></p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\">\n<thead>\n<tr>\n<th scope=\"col\">\n<p>Use case</p>\n</th>\n<th scope=\"col\">\n<p>Condition</p>\n</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\n<p>Sends a message to the Teams bot when the request is created or it is moved to the Accept, Close or Abandon phase</p>\n</td>\n<td>\n<p><code>${current_update.<span class=\"nanospell-typo\">PhaseId</span>.<span class=\"nanospell-typo\">IsChanged</span> &amp;&amp; (entity.<span class=\"nanospell-typo\">PhaseId</span>=='Log' || entity.<span class=\"nanospell-typo\">PhaseId</span>=='Accept'||entity.<span class=\"nanospell-typo\">PhaseId</span>=='Close'||entity.<span class=\"nanospell-typo\">PhaseId</span>=='Abandon')}</code></p>\n</td>\n</tr>\n<tr>\n<td>\n<p>Sends a message to the Teams bot when an agent user adds a comment for the request.</p>\n</td>\n<td>\n<p><code>${extract_property (filter_comments(comments_added(current_update.Comments.<span class=\"nanospell-typo\">OldValue</span>, current_update.Comments.<span class=\"nanospell-typo\">NewValue</span>), '<span class=\"nanospell-typo\">CommentTo</span>', 'User','Offset',1), '<span class=\"nanospell-typo\">CommentTo</span>')=='User'&amp;&amp; (current_update.<span class=\"nanospell-typo\">PhaseId</span>.<span class=\"nanospell-typo\">NewValue</span> !='Log' || current_update.<span class=\"nanospell-typo\">PhaseId</span>.<span class=\"nanospell-typo\">NewValue</span> !='Accept' || current_update.<span class=\"nanospell-typo\">PhaseId</span>.<span class=\"nanospell-typo\">NewValue</span> !='Close' || current_update.<span class=\"nanospell-typo\">PhaseId</span>.<span class=\"nanospell-typo\">NewValue</span> !='Abandon')}</code></p>\n</td>\n</tr>\n</tbody>\n</table>\n<div><a class=\"image\" href=\"\"> <img alt=\"Configure business rule Send request notification scenario\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/d/de/BR_Configuration.png\" hspace=\"0\" src=\"../../../images/BR_Configuration_3acf82e1.png\" style=\"width: 800px; height: 531px; margin: 0px; border: 0px solid black;\" vspace=\"0\"/> </a></div>\n<h2><a id=\"Limitations\" name=\"Limitations\" title=\"Limitations\"></a>Limitations</h2>\n<p>Currently, the following are not supported: </p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Display embedded pictures or attachments from knowledge articles or ticket descriptions directly in MS Teams</li><li style=\"margin-left: 28px; position: relative;\">Select user options of Service or Support Offerings directly in MS Teams</li><li style=\"margin-left: 28px; position: relative;\">The bot is designed as a personal bot. Installing the bot for Teams/Channels requires additional configurations in the Integration Studio scenario <strong>Interact with MS Teams bot</strong>.</li></ul>\n</div>",
  "modifiedon": "2025-11-18 10:56:38"
}