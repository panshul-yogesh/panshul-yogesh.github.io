{
  "title": "Create Application Load Balancer for integration",
  "content": "<div class=\"mw-parser-output\">\n<p>To enable Service Management and the containerized UD/UCMDB to work together on AWS, we recommend that you configure an internal Application Load Balancer (ALB) between the Ingress service of Service Management and the Ingress service of UD/UCMDB. This best practice enables you to isolate internal integration from external access.<br/>\n<br/>\nThe diagram below depicts how the integration ALB sets up the connection between Service Management and UD/UCMDB:<br/>\n<br/>\n<a class=\"image\" href=\"\"> <img alt=\"ALB for the connection between Service Management and UD/UCMDB\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/b/b6/ALBForCmsInteg.png\" height=\"406\" hspace=\"0\" src=\"../../../images/ALBForCmsInteg_f2663263.png\" style=\"width:800px;height:406px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\" width=\"800\"/> </a></p>\n<p>Here are the details of the ports:</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Type</th>\n<th scope=\"col\">Component</th>\n<th scope=\"col\">Example</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Ingress listener port for integration</td>\n<td>Service Management</td>\n<td>2443</td>\n</tr>\n<tr>\n<td>Ingress listener port for integration</td>\n<td>UD/UCMDB</td>\n<td>3443</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"Prerequisites\">Prerequisites</h2>\n<h3 id=\"Prepare_a_certificate\">Prepare a certificate</h3>\n<p>A certificate for the Application Load Balancer will be used to achieve the integration between Service Management and UD/UCMDB. The certificate can be generated by <b>AWS Certificates Manager</b>, which is recommended by AWS. Before creating and configuring an ALB, you need to prepare a new certificate using one of the following methods:<br/>\n<strong>Note</strong>: The target domain name (CN name) of the certificate must be the domain or full name of the FQDN you will bind with the ALB in a later step.</p>\n<h4 id=\"Request_a_certificate\">Request a certificate</h4>\n<ol>\n<li>Log in to the AWS Management Console in your target region.</li>\n<li>Navigate to <b>Services</b> &gt; <b>Certificate Manager</b>.</li>\n<li>Click <b>Request a certificate</b>.</li>\n<li>Select <b>Request a public certificate</b> and click <b>Request a certificate</b>.</li>\n<li>Specify your target domain name. You can use an asterisk (*) to request a wildcard certificate to protect several sites in the same domain. For example, <b>*.testsma-ng.org.</b></li>\n<li>Click <b>Next</b>.</li>\n<li>Select <b>DNS validation</b> or <b>Email validation</b> according to your permission.</li>\n<li>Click <b>Review</b> and then click <b>Confirm and request</b>.</li>\n<li>Click <b>Continue</b>.</li>\n<li>Finish the certificate validation based on the method you just selected. For more information, see <a href=\"https://docs.aws.amazon.com/console/acm/validation\" rel=\"nofollow\" target=\"1\" title=\"docs.aws.amazon.com/console/acm/validation\">https://docs.aws.amazon.com/console/acm/validation</a>.</li>\n</ol>\n<h4 id=\"Import_a_certificate\">Import a certificate</h4>\n<ol>\n<li>Log in to the AWS Management Console in your target region.</li>\n<li>Navigate to <b>Services</b> &gt; <b>Certificate Manager</b>.</li>\n<li>Click <b>Import a certificate</b>.</li>\n<li>For <b>Certificate body</b>, paste the PEM-encoded certificate.</li>\n<li>For <b>Certificate private key</b>, paste the PEM-encoded, unencrypted private key that matches the certificate's public key. <br/>\n<b>Important:</b> Currently, services integrated with AWS Certificate Manager support only the <code>RSA_1024</code> and <code>RSA_2048</code> algorithms.</li>\n<li>(Optional) For <b>Certificate chain</b>, paste the PEM-encoded certificate chain.</li>\n<li>Click <b>Next &gt; Review and import &gt; Import.</b></li>\n</ol>\n<h2 id=\"Target_groups\">Create an Ingress for integration between UD/UCMDB and Service Management </h2>\n<p>AWS Application Load Balancer is used to serve end users to access the suite from web browsers. You need to create an Application Load Balancer for integration and add a listener to the ALB for UD/UCMDB and Service Management respectively during the creation.</p>\n<h3>Step 1: Create an Ingress for UD/UCMDB integration</h3>\n<p>To create an Ingress for UD/UCMDB integration, follow these steps:</p>\n<ol>\n<li>Save the content below as <code>cms-integration-ingress.yaml</code>:\n\n\t<pre>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: \"cms-integration-ingress\"\n  namespace: &lt;ucmdb_namespace&gt;\n  annotations:\n    alb.ingress.kubernetes.io/scheme: internal\n    alb.ingress.kubernetes.io/group.name: &lt;integration_alb_name&gt;\n    alb.ingress.kubernetes.io/listen-ports: '[{\"HTTPS\": 3443}]'\n    alb.ingress.kubernetes.io/backend-protocol: HTTPS\n    alb.ingress.kubernetes.io/healthcheck-protocol: HTTPS\n    alb.ingress.kubernetes.io/healthcheck-port: traffic-port\n    alb.ingress.kubernetes.io/healthcheck-path: /cms\n    alb.ingress.kubernetes.io/success-codes: 200-399\n    alb.ingress.kubernetes.io/target-type: instance\n    alb.ingress.kubernetes.io/load-balancer-attributes: idle_timeout.timeout_seconds=180\n    alb.ingress.kubernetes.io/certificate-arn: &lt;certificate_arn&gt;\n    alb.ingress.kubernetes.io/security-groups: &lt;security_groups&gt;\n    alb.ingress.kubernetes.io/ssl-policy: ELBSecurityPolicy-TLS13-1-2-Res-2021-06\n    kubernetes.io/ingress.class: alb\n  labels:\n    app: cms-integration-ingress\nspec:\n  ingressClassName: alb\n  tls:\n  - hosts:\n    - &lt;integration_hostname&gt;\n  rules:\n    - host:\n      http:\n        paths:\n          - backend:\n              service:\n                name: \"itom-ingress-controller-svc\"\n                port: \n                  number: &lt;ingress_controller_port&gt;\n            path: /*\n            pathType: ImplementationSpecific\n</pre>\n<p>Replace the following with the actual values:</p>\n<ul>\n<li><code>&lt;ucmdb_namespace&gt;</code>: the unique namespace of the UD/UCMDB deployment. For example, <strong>ucmdb-prod</strong>.</li>\n<li><code>&lt;integration_alb_name&gt;</code>: specify the name of the ALB to be created.\n\t\t<div class=\"admonition\"><div class=\"admonition-icon admonition-important-icon\"></div><div class=\"admonition-content admonition-important-content\"><div>The name must consist of <strong>lower case</strong> alphanumeric characters, '-', or '.', and must start and end with an alphanumeric character. </div></div></div>\n</li>\n<li><code>&lt;certificate_arn&gt;</code>: the<a href=\"https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html\" title=\" resource name\"> resource name</a> of the prepared certificate. For example, <em>arn:aws:acm:region:123456789012:certificate/12345678-1234-1234-1234-123456789012</em>. See details in the<i> Prerequisites </i>section above.</li>\n<li><code>&lt;integration_hostname&gt;</code>: the FQDN you've allocated for integration. For example, <em>www.example-integration.com</em>.</li>\n<li><code>&lt;security_groups&gt;</code>: the prepared Security Group ID that the ALB belongs to. The security group should be the same as the one in <strong>smax-integration-ingress.yaml </strong>(in the later step). To allow the traffic from the integration ALB, make sure that you also add the Security Group ID in an inbound rule for the UD/UCMDB node cluster.</li>\n<li><code>&lt;ingress_controller_port&gt;</code>: The port number of the Ingress controller for the UD/UCMDB deployment. Use the port number that you set in the <b>itom-ingress-controller.nginx.service.httpsPort</b> parameter in your <strong>my-values.yaml </strong>file. For example, <strong>30443</strong>.</li>\n</ul>\n</li>\n<li>Run the following command to apply the saved YAML file:\n\t<pre>kubectl create -f cms-integration-ingress.yaml\n</pre>\n</li>\n</ol>\n<h3>Step 2: Create an Ingress for Service Management integration</h3>\n<p>To create an Ingress for Service Management integration, follow these steps:</p>\n<ol>\n<li>Save the content below as <code>smax-integration-ingress.yaml</code>:\n\n\t<pre>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: \"sma-integration-ingress\"\n  namespace: &lt;itsma_namespace&gt;\n  annotations:\n    alb.ingress.kubernetes.io/scheme: internal\n    alb.ingress.kubernetes.io/group.name: &lt;integration_alb_name&gt;\n    alb.ingress.kubernetes.io/listen-ports: '[{\"HTTPS\": 2443}]'\n    alb.ingress.kubernetes.io/backend-protocol: HTTPS\n    alb.ingress.kubernetes.io/healthcheck-protocol: HTTPS\n    alb.ingress.kubernetes.io/healthcheck-port: traffic-port\n    alb.ingress.kubernetes.io/healthcheck-path: /healthz\n    alb.ingress.kubernetes.io/success-codes: 200-399\n    alb.ingress.kubernetes.io/target-type: instance\n    alb.ingress.kubernetes.io/load-balancer-attributes: idle_timeout.timeout_seconds=180\n    alb.ingress.kubernetes.io/certificate-arn: &lt;certificate_arn&gt;\n    alb.ingress.kubernetes.io/security-groups: &lt;security_groups&gt;\n    alb.ingress.kubernetes.io/ssl-policy: ELBSecurityPolicy-TLS13-1-2-Res-2021-06\n  labels:\n    app: sma-integration-ingress\nspec:\n  ingressClassName: alb\n  tls:\n  - hosts:\n    - &lt;integration_hostname&gt;\n  rules:\n    - host: \n      http:\n        paths:\n          - backend:\n              service: \n                name: \"itom-ingress-controller-svc\"\n                port: \n                  number: 443\n            path: /*\n            pathType: ImplementationSpecific\n</pre>\n<p>Replace the following with the actual values:</p>\n<ul>\n<li><code>&lt;itsma_namespace&gt;</code>: the unique namespace of the Service Management deployment. For example, <strong>itsma</strong>.</li>\n<li><code>&lt;integration_alb_name&gt;</code>: enter the name of the same ALB that you specify in<strong> cms-integration-ingress.yaml</strong>.\n\t\t<div class=\"admonition\"><div class=\"admonition-icon admonition-important-icon\"></div><div class=\"admonition-content admonition-important-content\"><div>The name must consist of <strong>lower case</strong> alphanumeric characters, '-', or '.', and must start and end with an alphanumeric character. </div></div></div>\n</li>\n<li><code>&lt;certificate_arn&gt;</code>: the<a href=\"https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html\" title=\" resource name\"> resource name</a> of the prepared certificate. For example, <em>arn:aws:acm:region:123456789012:certificate/12345678-1234-1234-1234-123456789012</em>. See details in the<i> Prerequisites </i>section above.</li>\n<li><code>&lt;integration_hostname&gt;</code>: the FQDN you've allocated for integration. For example, <em>www.example-integration.com</em>.</li>\n<li><code>&lt;security_groups&gt;</code>: the security groups that the ALB belongs to. The inbound rule should allow the traffic to pass. The security group should be the same as the one in <strong>cms-integration-ingress.yaml</strong>. To allow the traffic from the integration ALB, make sure that you also add the Security Group ID in an inbound rule for the Service Management node cluster.</li>\n</ul>\n</li>\n<li>Run the following command to apply the saved YAML file:\n\t<pre>kubectl create -f smax-integration-ingress.yaml\n</pre>\n</li>\n</ol>\n<h2 id=\"Bind_an_FQDN_with_Application_Load_Balancer\">Bind an FQDN with the integration ALB</h2>\n<p>After you create and configure the integration ALB, you need to bind an FQDN with this ALB. The FQDN is the same as the <code>&lt;integration_hostname&gt; </code>setting that you configured in <strong>cms-integration-ingress.yaml </strong>and <strong>smax-integration-ingress.yaml</strong> in the previous step. See <a href=\"/doc/423/26.1/eksbootstrapcdf#Bind_an_FQDN_with_Application_Load_Balancer\" title=\"Bind FQDN with ALB\">Bind FQDN with ALB</a>. <br/>\nYou will need the following URLs when configuring integration between Service Management and UD/UCMDB.</p>\n<ul>\n<li>URL for UD/UCMDB to access SMAX:  <code>https://</code>&lt;FQDN&gt;<code>:2443</code></li>\n<li>UCMDB Gateway URL:  <code>https://</code>&lt;FQDN&gt;<code>:3443/</code>cms-gateway</li>\n</ul>\n<p>&lt;FQDN&gt; is the one that you bind with the integration ALB in this step.</p>\n<p><strong>Tip</strong>: You need the UCMDB Gateway URL (<code>https://</code>&lt;FQDN&gt;<code>:3443/</code>cms-gateway) when enabling the Native SACM and SAM solutions. See <a _ngcontent-c23=\"\" href=\"/doc/423/26.1/enablenativesacminsma\" title=\"Enable Native SACM in Service Management\">Enable Native SACM in Service Management</a> and <a _ngcontent-c23=\"\" href=\"/doc/423/26.1/enablesaminsmax\" title=\"Enable the SAM capability\">Enable the SAM capability</a>. <br/>\n<span id=\"cke_bm_1190C\" style=\"display: none;\"> </span></p>\n<h2>Update integration parameters in my-values.yaml</h2>\n<p>After binding an FQDN with the integration ALB, follow these steps to update integration parameters in <strong>my-values.yaml</strong>:</p>\n<ol>\n<li>\n<p>Update the following parameters in <strong>my-values.yaml </strong>and save the file:</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Parameter</th>\n<th scope=\"col\">Action</th>\n<th scope=\"col\">Example</th>\n</tr>\n<tr>\n<td>global.idm.idmServiceUrl</td>\n<td>Change the URL to the IdM URL of the Ingress created for Service Management integration including the Service Management listening port 2443.</td>\n<td><em>https://www.example-integration.com:2443/idm-service</em></td>\n</tr>\n<tr>\n<td>cmsgateway.deployment.smax.host</td>\n<td>Set it to the FQDN you've allocated for Service Management internal integration. Use the value that you use for <code>&lt;integration_hostname&gt; </code>in the <strong>smax-integration-ingress.yaml</strong> file.</td>\n<td><em>www.example-integration.com</em></td>\n</tr>\n<tr>\n<td>cmsgateway.deployment.smax.port</td>\n<td>Set it to the Service Management listening port (2443) of the Ingress created for Service Management integration.</td>\n<td>2443</td>\n</tr>\n<tr>\n<td>cmsgateway.deployment.sam.context</td>\n<td>The FQDN of the load balancer for accessing the SAM APIs. The value of this parameter is the same as that of the <strong>cmsgateway.deployment.smax.host</strong> parameter.</td>\n<td><em>www.example-integration.com</em></td>\n</tr>\n<tr>\n<td>cmsgateway.deployment.sam.port</td>\n<td>Set it to the Service Management listening port (2443) of the Ingress created for Service Management integration.</td>\n<td>2443</td>\n</tr>\n<tr>\n<td>caCertificates</td>\n<td>\n<p>Use the content (base-64 encoded) of the certificate requested from <b>AWS Certificates Manager </b>for the integration ALB<b>. </b></p>\n<p>If the internal integration FQDN domain is the same as the Service Management external FQDN domain, the <code>caCertificates.smax.crt</code> that's already in <strong>my-values.yaml</strong> can be reused and no action is needed; otherwise, you need to log in to a machine that can access the internal integration FQDN to get the certificate from a browser by following the instructions in <a href=\"/doc/423/26.1/getsuitecacertificate\" title=\"Get the suite CA certificate\">Get the suite CA certificate</a>.</p>\n</td>\n<td></td>\n</tr>\n</thead>\n</table>\n</li>\n<li>\n<p>Run the following command to apply your changes:</p>\n<pre>helm upgrade &lt;<em>UD/UCMDB RELEASE NAME</em>&gt; &lt;<em>UD/UCMDB CHART FILE</em>&gt; --namespace &lt;<em>UD/UCMDB NAMESPACE</em>&gt; -f &lt;<em>VALUES YAML FILE</em>&gt;</pre>\n<p>Where,</p>\n<ul>\n<li><code>&lt;<em>UD/UCMDB RELEASE NAME</em>&gt; </code>is the release name of the UD/UCMDB deployment that you specified when installing UD/UCMDB.</li>\n<li><code>&lt;<em>UD/UCMDB CHART FILE</em>&gt;</code> is the tar file containing the UD/UCMDB installation charts.</li>\n<li><code>&lt;<em>UD/UCMDB NAMESPACE</em>&gt;</code> is the unique namespace of the UD/UCMDB deployment.</li>\n<li><code>&lt;<em>VALUES YAML FILE</em>&gt;</code> is your custom <strong>my-v</strong><b>alues.yaml </b>file with properties configured for the UD/UCMDB deployment. </li>\n</ul>\n<p>For example:</p>\n<pre>helm upgrade ucmdb-prod UCMDB_Helm_Chart-2x.x/ucmdb-helm-charts/charts/ucmdb-1.xx.x-xxx+2x.x.x.tgz --namespace ucmdb-prod -f my-values.yaml</pre>\n</li>\n</ol>\n</div>",
  "modifiedon": "2025-10-24 08:51:12"
}