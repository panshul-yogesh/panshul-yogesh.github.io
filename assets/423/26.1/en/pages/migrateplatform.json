{
  "title": "Migrate the suite to a new deployment platform",
  "content": "<div class=\"mw-parser-output\">\n<div></div>\n<p>This topic describes a general solution to migrating the SMA suite from one deployment platform to another.</p>\n<p>SMA can be deployed on-premises and on public cloud platforms such as AWS, Azure, and GCP. No matter which platform the suite was initially deployed on, you can migrate it to a new supported platform. For example, you are currently running an on-premises setup of SMA, and you can choose to move it to a public cloud to save the costs of hardware and software maintenance. Another typical scenario is where your suite is running on a public cloud platform, and you plan to migrate it to another public cloud with a better cost-saving offer or for aligning the company strategy. </p>\n<h2>Limitations</h2>\n<p>This solution has the following limitations:</p>\n<ul>\n<li><strong>Version limited</strong>:\n\n\t<ul>\n<li>The SMA version in the source system must be the same as in the target.</li>\n<li>The Kubernetes version in the source system must be the same as in the target.</li>\n<li>Migration from on-premises to cloud platforms must be performed on the SMA 2020.08 or newer versions.</li>\n<li>The classic AWS deployment has been obsoleted since 2020.02; therefore, you can migrate from a classic AWS deployment to an EKS deployment only on the SMA 2019.11 version (see <a href=\"/doc/423/2019.11/migratetoeksn\" title=\"Migrate to EKS\">Migrate to EKS</a>).</li>\n</ul>\n</li>\n<li><strong>Data not included</strong>:\n\t<p>Customized Kubernetes configurations, including replicas, liveness, and readiness will not be migrated.</p>\n</li>\n</ul>\n<h2>SMA platform migration solution</h2>\n<p>The entire process to migrate the suite from a source platform to a target platform is as follows:</p>\n<h3>1. Set up the target system</h3>\n<p>Set up a fresh new environment on the target platform by following the installation guide for your deployment platform.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>  The target system should use the same <code>{EXTERNAL_ACCESS_HOST}</code> (FQDN) as the source system, but do <strong>NOT</strong> bind the <code>{EXTERNAL_ACCESS_HOST}</code> with the load balancer until the target system is ready (see the <em>Switch the traffic to the target system </em>section). During the installation, you need to access the <code>{EXTERNAL_ACCESS_HOST}</code> from your browser; as a workaround, you can add the following line to your local machine's hosts file:\n\n<pre>&lt;target_LOADBALANCER_ip&gt; &lt;EXTERNAL_ACCESS_HOST&gt;</pre>\n</div></div></div>\n<h3>2. Stop the suite in the target system</h3>\n<ol start=\"1\">\n<li>Navigate to the <code>$CDF_HOME/scripts</code> directory on the control plane node (on-premises environment) or the <code>OMT_External_K8s_2x.x-xxx/scripts</code> directory on the bastion node (cloud environment), and run the following command to stop the suite pods in the suite namespace:\n\n\t<pre>./cdfctl.sh runlevel set -l DOWN -n &lt;namespace&gt;</pre>\n<p>Where: <code>&lt;namespace&gt;</code> is the suite namespace (for example: <code>itsma-pxh5s</code>), and the last character in <code>runlevel set -l</code> is a lowercase letter <b>L</b>.</p>\n</li>\n<li>\n<p>Wait for 10 to 15 minutes to allow the suite pods to be stopped. You can run the following command to watch the suite pod status:</p>\n<pre>watch kubectl get pods -n &lt;namespace&gt;</pre>\n<p>This command will refresh the display of the suite pod status every two seconds.</p>\n<p><b>Note</b>: All of the suite pods must be stopped except the following ones (which must keep running): <code>itom-ingress-controller-xxxxx</code>, and <code>itom-throttling-controller-xxxxx</code>.</p>\n</li>\n</ol>\n<h3>3. Migrate the storage data from the source system to the target system</h3>\n<p>Use your preferred tools and methods to migrate the storage data from the source system to the target system. Contact the <strong>SMA Product Management</strong> team if you need any help.</p>\n<p>The data in the following folders needs to be migrated.</p>\n<ul>\n<li>    &lt;Smart Analytics NFS volume&gt;/license/idol</li>\n<li>    &lt;Smart Analytics NFS volume&gt;/config</li>\n<li>    &lt;Smart Analytics NFS volume&gt;/data/idol/stx/agentstore</li>\n<li>    &lt;global NFS volume&gt;/certificate/imported</li>\n<li>    &lt;global NFS volume&gt;/certificate/idm </li>\n<li>    &lt;global NFS volume&gt;/data/idm </li>\n<li>    &lt;global NFS volume&gt;/certificate/samlmeta</li>\n<li>    &lt;global NFS volume&gt;/certificate/ca-trust/samlKeystore.jks </li>\n<li>    &lt;global NFS volume&gt;/data/ucmdb</li>\n<li>    &lt;global NFS volume&gt;/certificate/ucmdb</li>\n<li>    &lt;global NFS volume&gt;/license/ucmdb </li>\n<li>    &lt;global NFS volume&gt;/va/projects   </li>\n<li>    &lt;global NFS volume&gt;/share1</li>\n<li>    &lt;global NFS volume&gt;/share2 </li>\n</ul>\n<p class=\"Admonition_Tip\"><span class=\"autonumber\">Note </span>that there are huge volumes of data in the <code>&lt;global NFS volume&gt;/share1</code> and <code>&lt;global NFS volume&gt;/share2 </code>folders, which will take a long time to migrate.</p>\n<h3>4. Migrate the PostgreSQL databases from the source system to the target system</h3>\n<p>Use your preferred tools and methods to migrate the database data from the source system to the target system. Contact the <strong>SMA Product Management</strong> team if you need any help.</p>\n<p>The following databases need to be migrated. You might not have all the databases in the list below, in which case you can migrate only the ones existing in your source environment.</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-caution-icon\"></div><div class=\"admonition-content admonition-caution-content\"><div>Do <strong>NOT</strong> migrate any database not listed here; otherwise, the target system will crash.</div></div></div>\n<ul>\n<li>maas_admin, maas_template</li>\n<li>xservices_ems, xservices_mng, xservices_rms, xie, scheduler, carbon</li>\n<li>bo_ats, bo_user, bo_config, bo_license</li>\n<li>smartadb, idm, autopassdb</li>\n<li>dnd, oo, oodesigner, sam, cgro</li>\n</ul>\n<h3>5. Start the suite in the target system</h3>\n<ol start=\"1\">\n<li>\n<p>Navigate to the <code>$CDF_HOME/scripts</code> directory on the control plane node (on-premises environment) or the <code>OMT_External_K8s_2x.x-xxx/scripts</code> directory on the bastion node (cloud environment), and run the following command to start the suite pods:</p>\n<pre>./cdfctl.sh runlevel set -l UP -n &lt;namespace&gt;</pre>\n</li>\n<li>\n<p>Wait until the suite pods are restarted. You can run the following command to watch the suite pod status:</p>\n<pre>watch kubectl get pods -n &lt;namespace&gt;</pre>\n</li>\n<li>Perform a full reindex as instructed in <a href=\"/doc/423/26.1/fullreindex\" title=\"Full reindex\">Full reindex</a>.</li>\n</ol>\n<h3>6. Switch the traffic to the target system</h3>\n<p>To route the traffic to the target system, bind <code>{EXTERNAL_ACCESS_HOST}</code> with the IP address of the load balancer in the target system.</p>\n</div>",
  "modifiedon": "2025-10-24 08:51:12"
}