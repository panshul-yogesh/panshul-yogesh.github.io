{
  "title": "Use case: OPB endpoints of Design and Deploy",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>This document covers the use case for the following On-Premises Bridge (OPB) endpoint types of Design and Deploy:</p>\n<ul>\n<li>LDAP Query: Fetch values from the LDAP server.</li>\n<li>JDBC Query: Fetch data from a database server.</li>\n<li>File system: Fetch the content from a file.</li>\n<li>REST Executor 1.0: Fetch the data made available in a REST API. </li>\n</ul>\n<p><strong>Note</strong>: The response size limit currently is 128 KB.</p>\n<p>Use case: Eve, as a Service Designer, can make use of the data provided by the above OPB endpoints in a dynamic list property. For this, she needs the OPB endpoints configured in Agent Portal. After configuring an endpoint, she can use the same in dynamically listing the data in the configuration option properties of service design.</p>\n<p>The following user roles are involved in this use case:</p>\n<table style=\"width:500px\">\n<thead>\n<tr>\n<th scope=\"col\">User role</th>\n<th scope=\"col\">Responsibilities</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Tenant Admin</td>\n<td>Configure OPB endpoints</td>\n</tr>\n<tr>\n<td>Service Designer</td>\n<td>Create configuration option dynamic list properties in service design using OPB endpoints</td>\n</tr>\n<tr>\n<td>Service Portal User</td>\n<td>Request for a cloud service offering from the Service Portal</td>\n</tr>\n</tbody>\n</table>\n<h2>Prerequisites</h2>\n<p>Ensure to complete the following prerequisites:</p>\n<ul>\n<li>Install and add an OPB Agent</li>\n<li>Configure OPB endpoints</li>\n</ul>\n<h3>Install and add an OPB Agent</h3>\n<p><strong>Install an OPB Agent on-premises</strong></p>\n<p>To use the DND endpoints, you need to download and install the latest OPB agent.</p>\n<ul>\n<li>For Windows, refer to <a href=\"/doc/423/26.1/opbinstall#Download_and_install_the%C2%A0%3Cspan_class=%22SAW_Variablesopb%22%3EOn-Premises_Bridge%3C/span%3E_Agent\">Download and install the OPB (Windows)</a>.</li>\n<li>For Linux, refer to <a href=\"/doc/423/26.1/opbinstalllinux#Download_and_install_the_On-Premises_Bridge_Agent\">Download and install the OPB Agent (Linux)</a>.</li>\n</ul>\n<p><strong>Add an agent</strong></p>\n<ul>\n<li>For Windows, refer to <a href=\"/doc/423/26.1/opbinstall#Add_an_agent\">Add an agent (Windows)</a>.</li>\n<li>For Linux, refer to <a href=\"/doc/423/26.1/opbinstalllinux#Add_an_agent\">Add an agent (Linux)</a>.</li>\n</ul>\n<h3>Configure OPB endpoints</h3>\n<p>Perform the following tasks in the given order to configure the OPB endpoints.</p>\n<ol>\n<li>Specify endpoint credentials using Endpoint Credentials Manager in OPB agent server.</li>\n<li>Add an endpoint in Agent Portal.</li>\n<li>Configure an endpoint in Agent Portal.</li>\n</ol>\n<h4><strong>Specify endpoint credentials using Endpoint Credentials Manager on OPB agent server</strong></h4>\n<ul>\n<li>For Windows:  See <a href=\"/doc/423/26.1/opbinstall#How_to_specify_credentials_using_a_command_line_tool\">How to specify credentials (Windows)</a></li>\n<li>For Linux: See <a href=\"/doc/423/26.1/opbinstalllinux#How_to_specify_credentials_using_a_command_line_tool\">How to specify credentials (Linux)</a></li>\n</ul>\n<div class=\"Admonition_Important\">\n<p><strong>Important: </strong></p>\n<ul>\n<li>When specifying the credentials, select the respective endpoint types listed below:\n\t<ul>\n<li>JDBC: <code>JDBC Query</code></li>\n<li>LDAP: <code>LDAP Query</code></li>\n<li>File system: <code>File System</code></li>\n<li>REST API: <code><font face=\"monospace\">REST Executor Domain 1.0</font></code></li>\n</ul>\n</li>\n<li>For File System, do not leave the user and password fields blank. You can even specify dummy values as these are mandatory values and are required when configuring the endpoint.</li>\n</ul>\n</div>\n<p>Different versions of the LDAP support different types of <code>securityAuthentication</code>, consumed in the Javascript as shown in the below examples:</p>\n<table style=\"width:500px\">\n<thead>\n<tr>\n<th scope=\"col\">Value</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>none</td>\n<td>Use no authentication (anonymous).<br/>\n\t\t\tIn the Credentials Manager, you can provide dummy values for credentials, as these are mandatory values.</td>\n</tr>\n<tr>\n<td>simple</td>\n<td>Simple user name and password authentication. In the Credentials Manager, provide the user name and password.</td>\n</tr>\n</tbody>\n</table>\n<h4>Add an endpoint in Agent Portal</h4>\n<ol>\n<li>From the main menu, select <strong>Administration &gt; Utilities &gt; Integration</strong>. Click the <strong>Endpoints</strong> tab.</li>\n<li>Click <strong>Add</strong>.</li>\n<li>Enter the endpoint details.\n\t<table style=\"width:500px\">\n<thead>\n<tr>\n<th scope=\"col\">Field</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Endpoint type</td>\n<td>Select the appropriate endpoint type.</td>\n</tr>\n<tr>\n<td>Endpoint name</td>\n<td>Enter a name for the endpoint.</td>\n</tr>\n<tr>\n<td>Running on agent</td>\n<td>Select an agent from the drop-down list which was created as part of adding an agent.</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>Click <strong>Add</strong>.</li>\n</ol>\n<h4>Configure an endpoint in Agent Portal</h4>\n<ol>\n<li>For SSL-based communication related to JDBC, LDAP, and Rest Executor endpoints, ensure you have imported the certificate authority (CA certificate) to OPB trust store, into the following path: <code>&lt;OPB installed path&gt;/product/util/3rd-party/jre/lib/security/cacerts</code> using the syntax below:\n\n\t<ol start=\"1\">\n<li>Run the following command to import the CA certificate: <code>&lt;OPB installed path&gt;/product/util/3rd-party/jre/bin/keytool -importcert -keystore</code>  <code>&lt;OPB installed path&gt;/product/util/3rd-party/jre/lib/security/cacerts -alias \"&lt;&lt;certificate alias&gt;&gt;\" -file /&lt;&lt;myjdbcservercert&gt;&gt;.cer</code>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width: 500px;\">\n<tbody>\n<tr>\n<td><code>&lt;certificate alias&gt;</code></td>\n<td>Replace this value with the certificate alias of your choice.</td>\n</tr>\n<tr>\n<td><code>&lt;myjdbcservercert&gt;</code></td>\n<td>Replace this value with the certificate path as per your Linux environment.<br/>\n\t\t\t\t\tExample: /certs/pigeons-ad.cloudwars.in.cer</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>Run the following command to restart the OPB agent: <code>&lt;Agent_installation_directory&gt;/bin/OpbAgent.bat restart</code></li>\n</ol>\n</li>\n<li>From the main menu, select <strong>Administration &gt; Utilities &gt; Integration</strong>.</li>\n<li>Click the <strong>Endpoints</strong> tab.</li>\n<li>Select the endpoint you want to configure and click <strong>Configure</strong>. The <b>Endpoint Configuration</b> dialog box opens.</li>\n<li>Enter the endpoint details:\n\t<ol start=\"1\">\n<li><strong>JDBC Query</strong>\n<table style=\"width:500px\">\n<thead>\n<tr>\n<th scope=\"col\">Field</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>JDBC URL</td>\n<td>JDBC URL Examples:<br/>\n<code>jdbc:postgresql://&lt;host_name&gt; or &lt;ip_address&gt;:5432/mydb</code><br/>\n<code>jdbc:oracle:thin:@//&lt;host_name&gt; or &lt;ip_address&gt;:1521:XE<br/>\n\t\t\t\t\tjdbc:sqlserver://&lt;host_name&gt; or &lt;ip_address&gt;:1433/mydb</code><br/>\n\t\t\t\t\t </td>\n</tr>\n<tr>\n<td>Credentials</td>\n<td>Endpoint credentials (created as part of the task <strong>Specify endpoint credentials using Endpoint Credentials Manager on OPB agent server</strong> above).</td>\n</tr>\n</tbody>\n</table>\n<p>Note that only Postgres with SSL is supported.<br/>\n\t\tFor Oracle and SQL servers, ensure that you have copied the JDBC driver <code>.jar</code> file of the respective database to <code>&lt;OPB installed path&gt;/product/domain/jdbc-query/lib</code>  and restarted the OPB agent service.</p>\n</li>\n<li><strong>LDAP Query</strong>\n<table style=\"width:500px\">\n<thead>\n<tr>\n<th scope=\"col\">Field</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>LDAP URL</td>\n<td>\n<p>Specify the LDAP URL in the following format if the LDAP is SSL enabled: ldap(s)://&lt;host_name&gt; or &lt;ip_address&gt;:&lt;port&gt;.</p>\n<p>Example for SSL-based URL: <code>ldaps://&lt;host_name&gt; or &lt;ip_address&gt;:636</code></p>\n<p><span style=\"background-color: transparent;\">Example for non-SSL URL: </span><code style=\"background-color: transparent;\">ldap://&lt;host_name&gt; or &lt;ip_address&gt;:389</code></p>\n<p>For SSL-based URLs, u<span style=\"background-color: transparent;\">se only FQDN in the URL.</span></p>\n</td>\n</tr>\n<tr>\n<td>Credentials</td>\n<td>Endpoint credentials (created as part of the <strong>Specify endpoint credentials using Endpoint Credentials Manager on OPB agent server</strong> task above).</td>\n</tr>\n</tbody>\n</table>\n\t\tYou can use the attribute filter to bring only the mentioned attributes in response, to limit the LDAP response size.  For information, refer to the sample LDAP endpoint Javascript provided below.<br/>\n\t\t </li>\n<li><strong>File system: </strong>\n<table style=\"width:500px\">\n<thead>\n<tr>\n<th scope=\"col\">Field</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>File base path</td>\n<td>\n<p>The base path of the file from which you want the system to read the data.</p>\n<p>This is only applicable to the files physically available in the OPB agent server.</p>\n<p>The file can reside anywhere on the system.</p>\n<p>Examples:</p>\n<ul>\n<li>Linux: /usr/tmp</li>\n<li>Windows: C:\\Temp</li>\n</ul>\n</td>\n</tr>\n<tr>\n<td>Credentials</td>\n<td>Endpoint credentials (created as part of the <strong>Specify endpoint credentials using Endpoint Credentials Manager on OPB agent server</strong> task above).</td>\n</tr>\n</tbody>\n</table>\n\t\tThe file system endpoint supports read operations only.</li>\n<li><strong>REST Executor 1.0</strong>\n<table style=\"width:500px\">\n<thead>\n<tr>\n<th scope=\"col\">Field</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Location</td>\n<td>Enter the URL of the remote server to which you want to direct the REST call, including the protocol, host, port, and root context, if any.<br/>\n\t\t\t\t\tExample: <code>https://mydomain:port/&lt;my_context&gt;</code></td>\n</tr>\n<tr>\n<td>Credentials</td>\n<td>Endpoint credentials (created as part of the <strong>Specify endpoint credentials using Endpoint Credentials Manager on OPB agent server</strong> task above).</td>\n</tr>\n</tbody>\n</table>\n</li>\n</ol>\n</li>\n<li>Save the changes.</li>\n</ol>\n<h2>Use the endpoint in Service Design</h2>\n<p>You can use the endpoints in a Service Design to populate the dynamic values. For information on creating dynamic options properties, see <a href=\"/doc/423/26.1/configuredynamicentrylist\">Configure parameters for dynamic properties list</a></p>\n<p>For information on creating Configuration Options, see <a href=\"/doc/423/26.1/mgmtconssdsubsoptionpropcreate\">Create configuration option properties</a>. Select or create the Javascript that will determine the values that should be presented to a user in the Service Portal. <br/>\nWhen configuring the parameter, ensure you use the <code>ESMEndpoint(&lt;endpoint_name&gt;)</code> as shown in the sample scripts below.</p>\n<p>The value within '&lt;&gt;' in the sample files below represents the endpoint name with which you created the OPB endpoint.</p>\n<h3>Sample Javascript of JDBC endpoint</h3>\n<pre>var availableValues = [];\nvar client = new SQLClient(new ESMEndpoint('&lt;<strong>jdbc_endpoint</strong>&gt;'));\nvar response = client.call('SELECT name FROM mytable', []);\nvar obj = JSON.parse(response.body);\nobj.forEach(function(obj) {\n    var availableRow = {\n        'value': obj.name,\n        'displayName': obj.name\n    };\n    availableValues.push(availableRow);\n});</pre>\n<h3>Sample Javascript of LDAP endpoint</h3>\n<pre>var client = new LDAPClient();\n\nvar request = {\n    protocol: 'ldap',\n    securityAuthentication: 'none',\n    strategy: new ESMEndpoint(\"&lt;<strong>LDAP_endpoint</strong>&gt;\"),\n        readTimeout: '10000',\n    connectTimeout: '10000',\n    params: {\n        userSearchBase: 'dc=example,dc=com',\n        userSearchFilter: '(&amp;(objectClass=person)(givenname=consumer))',\n        // For each row in response, bring only attributes mentioned in 'attributeFilter'\n        // In case of multiple attributes, use comma delimiter\n        attributeFilter: 'givenName, displayName'\n    },\n    searchControls: {\n        scope: 'SUBTREE_SCOPE',\n        timeLimit: 1000\n    }\n};\nvar response = client.call(request);\ndebug(response);\n\nvar availableValues = [];\nfor(var row in response.data) {\n\n    var availableRow = {\n        'displayName' : response.data[row].get('uid'),\n        'value' : response.data[row].get('uid') + ', ' + response.data[row].get('mail')\n    };\n\n    availableValues.push(availableRow);\n}\n</pre>\n<h3 style=\"font-size: 20px;\"><span style=\"font-family: Roboto, sans-serif; color: rgb(0, 0, 0);\">Sample Javascript of file system endpoint</span></h3>\n<pre>var file = new FileStorage(new ESMEndpoint(\"&lt;<strong>file_esm_endpoint</strong>&gt;\"));\ncontent = file.readAll(\"fileSubDirectory/sample.txt\");\n\nvar availableValues = [\n    {\n        'displayName': content,\n        'value': content\n    }];</pre>\n<h3>Sample <span style=\"font-size:20px\"><span style=\"color:#000000\"><span style=\"font-family:Roboto, sans-serif\">Javascript of</span></span></span> REST executor 1.0 endpoint</h3>\n<pre>var request = {\n    UriSuffix: '/user/passwd',\n    method: 'GET',\n    strategy : new ESMEndpoint('&lt;<strong>my_rest_api_endpoint</strong>&gt;'),\n    params: {\n        my: 'param',\n        another: 'param'\n    },\n    headers: {\n        'Content-Type': 'application/json',\n        'My-Header': 'someValue'\n    },\n    data: 'some body message'\n};\nvar response = HTTPClient.call(request);\n\nvar responseBody;\nif (response.error) {\n    responseBody = \"error: \"+response.error;\n} else {\n    responseBody = \"ok: \"+response.body;\n}\n\navailableValues = [{\n        'value': responseBody,\n        'displayName': 'Response body',\n        'description': 'Another value',\n        'initialPrice': '23',\n        'recurringPrice': '3'\n    },\n    {\n        'value': response.status,\n        'displayName': 'Status',\n        'description': 'Response Status',\n        'initialPrice': '23',\n        'recurringPrice': '3'\n    },\n    {\n        'value': response.statusCode,\n        'displayName': 'Status code',\n        'description': 'Response Status Code',\n        'initialPrice': '23',\n        'recurringPrice': '3'\n    }];</pre>\n<p>For more sample Javascript files, see the <code>.js</code> files available on the <b>Configuration options </b>tab<b>. </b></p>\n<h2>Related topics</h2>\n<ul>\n<li>For information on using SMA endpoints, see <a href=\"/doc/423/26.1/opbuseendpoints\">Use endpoints</a></li>\n<li>For information on how to import a certificate, see <a href=\"/doc/423/26.1/opbinstalllinux#How_to_import_certificates_into_OPB\">How to import certificates into OPB</a></li>\n<li>For information on creating Configuration Options, see <a href=\"/doc/423/26.1/mgmtconssdsubsoptionpropcreate\">Create configuration option properties</a></li>\n<li>For information on creating dynamic options properties, see <a href=\"/doc/423/26.1/configuredynamicentrylist\">Configure parameters for dynamic properties list</a></li>\n<li>For information on how to add or edit a service design, see <a href=\"/doc/423/26.1/mgmtconssdviewall\">Service Designer</a></li>\n<li>For information on how to add and manage scripts, see <a href=\"/doc/423/26.1/managescripts\" style=\"\">Manage scripts</a></li>\n</ul>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}