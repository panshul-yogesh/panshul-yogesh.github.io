{
  "title": "OO Central pod restarts when the environment is idle",
  "content": "<div class=\"mw-parser-output\">\n<div>Kubernetes restarts the OO Central pod even when the system is idle or under load. This is due to the pod not responding to Kubernetes health probes in time, leading to a restart.</div>\n<div>\n<h2><a id=\"Cause\" name=\"Cause\" title=\"Cause\"></a>Cause</h2>\n<p>The root cause is that the Java memory allocation for the OO Central application is too close to the total memory available for the pod. Any fluctuations in Java memory usage cause the system to hit memory limits, prompting Kubernetes to restart the pod to ensure stability.</p>\n<h3><a id=\"Understanding_memory_requests_and_limits\" name=\"Understanding_memory_requests_and_limits\" title=\"Understanding memory requests and limits\"></a>Understanding memory requests and limits</h3>\n<p>In Kubernetes, each pod has two important memory configurations: memory requests and memory limits. These control how much memory a pod can use and how Kubernetes manages resources.</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Memory requests: This is the minimum amount of memory that Kubernetes guarantees for the pod. Kubernetes will reserve this amount of memory for the pod, ensuring it always has access to at least this much.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Memory limits: This is the maximum amount of memory a pod can use. If the pod tries to exceed this limit, Kubernetes may stop or restart the pod to prevent it from using too much memory and affecting other pods in the cluster.</li></ol>\n<p>For example, in a 5-tenant configuration, the memory request is set to 5120Mi (5GB), and the memory limit is also 5120Mi. In a 15-tenant configuration, the memory request is set to 23040Mi (23GB), and the memory limit is the same.</p>\n<h3><a id=\"Java_memory_allocation_for_the_application\" name=\"Java_memory_allocation_for_the_application\" title=\"Java memory allocation for the application\"></a>Java memory allocation for the application</h3>\n<p>Java memory is allocated separately for the OO Central application and is managed within the pod. If Java memory usage is too close to the total pod memory, fluctuations can cause Kubernetes to restart the pod.<br/>\nFor example, in a 5-tenant configuration, the default Java memory allocation is 4092Mi (~4GB). In a 15-tenant configuration, the Java memory allocation is 18432Mi (~18GB).</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>These values are just examples and should be adapted according to your load, environment, or resource needs.</div></div></div>\n<h2><a id=\"Solution\" name=\"Solution\" title=\"Solution\"></a>Solution</h2>\n<p>The solution is to adjust memory allocations.</p>\n<h3><a id=\"Idle_system_no_load_\" name=\"Idle_system_no_load_\" title=\"Idle system (no load)\"></a>Idle system (no load)</h3>\n<p>If the system is idle, increasing the pod memory (requests and limits) will prevent Kubernetes from restarting the pod.<br/>\nRun the following Helm command:</p>\n<pre>helm upgrade -n &lt;oo_namespace&gt; &lt;oo_helm_release&gt; --set oocentral.deployment.cpuRequest=1000 --set oocentral.deployment.cpuLimit=2000 --set oocentral.deployment.initMemory=3072 --set oocentral.deployment.maxMemory=3072 --set oocentral.deployment.resources.requests.memory=5120 --set oocentral.deployment.resources.limits.memory=5120 -f &lt;oo_values_yaml&gt; &lt;oo_chart.tgz&gt;</pre>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>These values should be adjusted according to your specific needs.</div></div></div>\n<p>For a system with 5 tenants, increase the pod memory to:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Memory request: 6144Mi (6GB)</li><li style=\"margin-left: 28px; position: relative;\">Memory limit: 8192Mi (8GB)</li><li style=\"margin-left: 28px; position: relative;\">CPU limit / CPU request / Java initial memory / Java maximum memory remain the same</li></ul>\n<h3><a id=\"System_under_load\" name=\"System_under_load\" title=\"System under load\"></a>System under load</h3>\n<p>If the system is under load, both the pod and Java memory of the application must be increased to handle the workload.<br/>\nRun the following Helm command:</p>\n<pre>helm upgrade -n &lt;oo_namespace&gt; &lt;oo_helm_release&gt; --set oocentral.deployment.cpuRequest=1000 --set oocentral.deployment.cpuLimit=2000 --set oocentral.deployment.initMemory=3072 --set oocentral.deployment.maxMemory=3072 --set oocentral.deployment.resources.requests.memory=5120 --set oocentral.deployment.resources.limits.memory=5120 -f &lt;oo_values_yaml&gt; &lt;oo_chart.tgz&gt;\n</pre>\n<p>For a 5-tenant configuration, increase the pod and Java memory to:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Pod memory request: 8192Mi (8GB)</li><li style=\"margin-left: 28px; position: relative;\">Pod memory limit: 10240Mi (10GB)</li><li style=\"margin-left: 28px; position: relative;\">Java initial memory: 6144Mi (6GB)</li><li style=\"margin-left: 28px; position: relative;\">Java maximum memory: 8192Mi (8GB)</li><li style=\"margin-left: 28px; position: relative;\">CPU limit and CPU request remain the same</li></ul>\n<p>Take the following steps:</p>\n<ol style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Get the OO namespace. Run the following command to get the namespace of the OO Central installation:\n\n\t<pre><code>helm get ns</code></pre>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Get the OO release name. Run this command to find the release name for the OO Central pod:\n\t<pre><code>helm get release -n &lt;oo_namespace&gt;</code></pre>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">Run the following command to get the <strong>values.yaml</strong> file from the previous OO deployment.\n\t<pre><code>helm get values &lt;oo_install_name&gt; -n &lt;oo_namespace&gt; &gt; /path/to/previous_deployment_values.yaml</code></pre>\n</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">\n<p>Run the Helm upgrade command.<br/>\n\tOnce you have both the namespace and release name, use the provided Helm upgrade command to increase the memory settings as needed.</p>\n</li></ol>\n</div>\n<div>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>The values used in the example command are the default values provided by the OO chart, and they must be supplied together. This requirement prevents configuration inconsistencies, especially because autoscaling behavior depends on these parameters.</div></div></div>\n</div>\n</div>",
  "modifiedon": "2025-12-15 10:12:02"
}