{
  "title": "Perform tasks for a PostgreSQL upgrade",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>Follow the instructions below to upgrade your PostgreSQL database server.</p>\n<h2>Upgrade self-hosted PostgreSQL</h2>\n<p>Perform the following steps.</p>\n<h3>Install the new version of the PostgreSQL server</h3>\n<p>Install the new version of the PostgreSQL server with the <strong>postgresql-contrib</strong> module. </p>\n<h3>Upgrade database data</h3>\n<p>Upgrade database data to the new version.</p>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-tip-icon\"></div>\n<div class=\"admonition-content admonition-tip-content\">We recommend that you use the pg_upgrade command to perform the upgrade. If you haven't installed the <strong>postgresql-contrib</strong> module on the new PostgreSQL server, the pg_upgrade command will fail.</div>\n</div>\n<h3>Upgrade the pg_trgm extension</h3>\n<p>To upgrade the pg_trgm extension, run the following SQL commands with the database superuser.</p>\n<pre>\\c xservices_ems;\n\nALTER EXTENSION \"pg_trgm\" UPDATE;</pre>\n<p>To check that you have upgraded the extension successfully, run the following command.</p>\n<pre>select * from pg_available_extensions where default_version=installed_version and name='pg_trgm';</pre>\n<p>If the default_version is the same as the installed_version, the extension upgrade was a success. </p>\n<h3>Optimizer statistics</h3>\n<p>The pg_upgrade command doesn't transfer optimizer statistics. Consider running the following command (using PostgreSQL 15 for example) with the OS <strong>postgres</strong> user to rerun the optimizer statistics. </p>\n<pre>/usr/pgsql-15/bin/vacuumdb --all --analyze-in-stages</pre>\n<h2>Upgrade managed PostgreSQL</h2>\n<p>Perform the following tasks to upgrade a managed PostgreSQL instance, such as an instance of RDS, or Azure Flexible Server. </p>\n<h3>Upgrade PostgreSQL</h3>\n<p>Upgrade PostgreSQL to the new version. </p>\n<h3>Upgrade the pg_trgm extension</h3>\n<p> To upgrade the pg_trgm extension, run the following SQL commands with the database superuser.</p>\n<pre>\\c xservices_ems;\n\nALTER EXTENSION \"pg_trgm\" UPDATE;</pre>\n<p>To check that you have upgraded the extension successfully, run the following command:</p>\n<pre>select * from pg_available_extensions where default_version=installed_version and name='pg_trgm';</pre>\n<p>If the default_version is the same as the installed_version, the extension upgrade was a success. </p>\n<h3>Check the SSL parameter after upgrading RDS to PostgreSQL 15 or later</h3>\n<p>For PostgreSQL for RDS, note that the default <strong>rds.force_ssl</strong> parameter is set to 1 (on) for PostgreSQL version 15 (or later), which means PostgreSQL must use an SSL connection. If your application uses non-TLS, you need to set the <strong>rds.force_ssl</strong> parameter to 0 in the parameter group.</p>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}