{
  "title": "Prepare external databases for OO on OpenShift",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>You must use separate PostgreSQL databases instances for the suite and OO for these reasons:</p>\n<ul>\n<li>The PostgreSQL instance size increases more than the size of the other databases.</li>\n<li>There are unknown issues and risks if the suite and OO share the same PostgreSQL database.</li>\n</ul>\n<p>Note that:</p>\n<ul>\n<li>It's strongly recommended to host the database server on a <b>physical machine</b>, and it should be an independent server without other applications running on it.</li>\n<li>If the database server machine is a virtual machine, the resource must be a dedicated database server.</li>\n<li>Set the database servers to the same time zone, daylight savings settings, and time as the OO servers.</li>\n<li>Make sure the OO installation server is in the same LAN as the database servers (without a proxy and firewalls between them). Otherwise, this may impact your system's performance.</li>\n<li>Set the machine's system resources where you install PostgreSQL database according to the on-premises deployment sizing guide.</li>\n</ul>\n<h2>Install the PostgreSQL database</h2>\n<p>You can use a PostgreSQL database server for OO Containerized. Please see the PostgreSQL documentation for installation details. </p>\n<h2>Configure the database server</h2>\n<h3>Configure the PostgreSQL database server</h3>\n<ol>\n<li>\n<p>(Optional) Enable TLS connections for the database server.</p>\n<p>Both SSL modes (<code>verify-full</code> and <code>verify-ca</code>) are supported. For details, see the PostgreSQL documentation.</p>\n</li>\n<li>\n<p>Configure the following parameters in the <b>postgresql.conf</b> file.</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Parameter</th>\n<th scope=\"col\">Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>effective_cache_size</code></td>\n<td>7.5 GB</td>\n</tr>\n<tr>\n<td><code>maintenance_work_mem</code></td>\n<td>256 MB</td>\n</tr>\n<tr>\n<td><code>max_connections</code></td>\n<td>1400</td>\n</tr>\n<tr>\n<td><code>shared_buffers</code></td>\n<td>4.5 GB</td>\n</tr>\n<tr>\n<td><code>work_mem</code></td>\n<td>300 MB</td>\n</tr>\n<tr>\n<td><code>listen_addresses</code></td>\n<td>'*'</td>\n</tr>\n</tbody>\n</table>\n<p>The default value of the <code>listen_addresses</code> parameter is \"<code>localhost</code>\", which means only localhost can connect to the PostgreSQL instance. You need to set <code>listen_addresses</code> = '*' to allow remote connections.<br/>\n\tIf you are sharing the database server with the rest of the suite components, make sure that the OO database requirements are added to the suite's database configuration options.</p>\n</li>\n<li>\n<p>Configure encoding and locale. Make sure that the PostgreSQL instance uses the following encoding and locale settings:</p>\n<pre>Encoding: UTF8\nLC_COLLATE: en_US.UTF-8\nLC_CTYPE: en_US.UTF-8</pre>\n</li>\n</ol>\n<h3>Create OO database users and database names</h3>\n<p>In the OO application, the following components require databases:</p>\n<ul>\n<li>OO Central</li>\n<li>OO Session Manager</li>\n<li>OO Controller</li>\n<li>OO Scheduler</li>\n<li>AutoPass License Service (AutoPass)</li>\n</ul>\n<p>In the production environment, you must use external databases for the OO application. Enter the database users and database names during OO installation using the Helm parameters. </p>\n<p>The databases must be empty so that OO will initialize them during installation. The table below shows example database information prepared for the following components:</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Service</th>\n<th scope=\"col\">Database User</th>\n<th scope=\"col\">Database Name</th>\n<th scope=\"col\">Schema </th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>OO Central</td>\n<td><code>oocentraldbuser</code></td>\n<td><code>oocentraldb</code></td>\n<td><code>oo_cen_core</code></td>\n</tr>\n<tr>\n<td>OO Session Manager</td>\n<td><code>oosessionmanagerdbuser</code></td>\n<td><code>oosessionmanagerdb</code></td>\n<td><code>public</code></td>\n</tr>\n<tr>\n<td>OO Controller</td>\n<td><code>oocontrollerdbuser</code></td>\n<td><code>oocontrollerdb</code></td>\n<td><code>public</code></td>\n</tr>\n<tr>\n<td>OO Scheduler</td>\n<td><code>ooschedulerdbuser</code></td>\n<td><code>ooschedulerdb</code></td>\n<td><code>oo_sch_core</code></td>\n</tr>\n<tr>\n<td>AutoPass</td>\n<td><code>aplsdbuser</code></td>\n<td><code>aplsdb</code></td>\n<td><code>public</code></td>\n</tr>\n</tbody>\n</table>\n<p>Below are sample SQL commands for creating a user and a database for a service for the PostgreSQL database:</p>\n<ol>\n<li>\n<p>Log in to your database server with the administrator credentials.</p>\n<pre><code>psql -h &lt;host&gt; -p &lt;port&gt; -U &lt;PostgreSQL admin&gt;</code></pre>\n</li>\n<li>\n<p>Run the following commands to create the databases and the users, by substituting the exemplified database names, database users, and their respective passwords of each component with the desired values.<br/>\n<strong>OO Central: </strong></p>\n<pre><code>CREATE ROLE oocentraldbuser LOGIN ENCRYPTED PASSWORD 'oocentraldbuserPass' NOSUPERUSER INHERIT CREATEDB CREATEROLE;\nCREATE DATABASE oocentraldb WITH owner=oocentraldbuser;\nGRANT CREATE ON DATABASE oocentraldb TO oocentraldbuser;</code></pre>\n<p><strong>OO Session Manager:</strong> </p>\n<pre><code>CREATE ROLE oosessionmanagerdbuser LOGIN ENCRYPTED PASSWORD 'oosessionmanagerdbuserPass';\nCREATE DATABASE oosessionmanagerdb WITH owner=oosessionmanagerdbuser;\nGRANT CREATE ON DATABASE oosessionmanagerdb TO oosessionmanagerdbuser;</code></pre>\n<p><strong>OO Controller:</strong> </p>\n<pre><code>CREATE ROLE oocontrollerdbuser LOGIN ENCRYPTED PASSWORD 'oocontrollerdbuserPass';\nCREATE DATABASE oocontrollerdb WITH owner=oocontrollerdbuser;\nGRANT CREATE ON DATABASE oocontrollerdb TO oocontrollerdbuser;</code></pre>\n<p><strong>OO Scheduler: </strong></p>\n<pre><code>CREATE ROLE ooschedulerdbuser LOGIN ENCRYPTED PASSWORD 'ooschedulerPass';\nCREATE DATABASE ooschedulerdb WITH owner=ooschedulerdbuser;\nGRANT CREATE ON DATABASE ooschedulerdb TO ooschedulerdbuser;</code></pre>\n<p><strong>AutoPass:</strong> </p>\n<pre><code>CREATE ROLE \"aplsdbuser\" LOGIN ENCRYPTED PASSWORD 'aplsdbuserPass' NOSUPERUSER INHERIT;\nGRANT \"aplsdbuser\" TO postgres;\nCREATE DATABASE \"aplsdb\"; \nALTER DATABASE \"aplsdb\" OWNER TO \"aplsdbuser\";\nGRANT ALL ON SCHEMA \"public\" TO \"aplsdbuser\";</code></pre>\n<p><strong>Grant CONNECT to all database users to their respective databases</strong>: </p>\n<pre><code>GRANT CONNECT ON DATABASE oocentraldb TO oocentraldbuser;\nGRANT CONNECT ON DATABASE oosessionmanagerdb TO oosessionmanagerdbuser;\nGRANT CONNECT ON DATABASE oocontrollerdb TO oocontrollerdbuser;\nGRANT CONNECT ON DATABASE ooschedulerdb TO ooschedulerdbuser;\nGRANT CONNECT ON DATABASE aplsdb TO aplsdbuser;</code></pre>\n</li>\n</ol>\n<div></div>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}