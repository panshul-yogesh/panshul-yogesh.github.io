{
  "title": "Prepare persistent volumes and claims for OO (AKS)",
  "content": "<div class=\"mw-parser-output\">\n<p>OO Containerized installation requires below Persistent Volumes (PVs) and Persistent Volume Claims (PVCs). PVs are pieces of storage relevant to Azure File Share volumes, and PVCs are requests for a piece of storage on a volume. </p>\n<p>Currently, OO uses persistent storage by providing the names of the required PVCs at OO install time via Helm parameters. This means that you must create both PVs and PVCs upfront.</p>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Component</th>\n<th scope=\"col\">Azure File Share volume name</th>\n<th scope=\"col\">Description</th>\n<th scope=\"col\">Example Directory path</th>\n<th scope=\"col\">Size</th>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-config-vol</code></td>\n<td>Stores OO configuration files.</td>\n<td><code>/var/vols/itom/oo/oo_config_vol</code></td>\n<td>~ 1 GB</td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-data-vol</code></td>\n<td>Stores OO, OO deployed AutoPass, and OO deployed Vault generated data.</td>\n<td><code>/var/vols/itom/oo/oo_data_vol</code></td>\n<td>~ 1 GB</td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-logs-vol</code></td>\n<td>Stores logs generated by the OO components, except RAS logs which are stored in a different volume.</td>\n<td><code>/var/vols/itom/oo/oo_logs_vol</code></td>\n<td>1-5 GB</td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-data-export-vol</code></td>\n<td>\n<p>OO runs a Kubernetes <strong>cron job</strong> for purging OO database with a retention period set to 375 days (default value). </p>\n<p>All the database data that's marked for purge gets exported first and exposed in this volume before purging. </p>\n</td>\n<td><code>/var/vols/itom/oo/oo_data_export_vol</code></td>\n<td>50-90 GB<br/>\n<br/>\n<em>See note below</em></td>\n</tr>\n<tr>\n<td>OO</td>\n<td><code>oo-ras-logs-vol</code></td>\n<td>Stores OO RAS logs. </td>\n<td><code>/var/vols/itom/oo/oo_ras_logs_vol</code></td>\n<td>1-5 GB</td>\n</tr>\n</thead>\n</table>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>\n<p>The \"OO Database Maintenance and Export\" Kubernetes <strong>cron job</strong> uses the <em>oo-data-export-vol </em> volume. </p>\n<p>Two factors directly influence the size of the <em>oo-data-export-vol </em>volume:</p>\n<ol start=\"1\" style=\"padding-left: 0px;\"><li style=\"--number-width: 10px; --number-spacing: 24px; margin-left: 36px; position: relative;\">The complexity of the flows that OO runs.<br/>\n\tOO flows that work with &gt; 1 GB worth of data per flow context, are considered \"heavy\" flows and this data will end up in the Amazon Elastic File System. Adjust the volumes depending on the number of flows that you run.</li><li style=\"--number-width: 13px; --number-spacing: 24px; margin-left: 36px; position: relative;\">The number of tenants.<br/>\n\tMore tenants means more data in the Database. This data gets exported in this Amazon Elastic File System volume. (more tenants means bigger <em>oo-data-export-vol </em>volume size)</li></ol>\n</div></div></div>\n<h2><a id=\"Configure_persistent_volumes\" name=\"Configure_persistent_volumes\" title=\"Configure persistent volumes\"></a>Configure persistent volumes</h2>\n<p>Edit and use the below sample PV templates to create the OO Persistent volumes using the command: </p>\n<pre><code>kubectl create -f /path/to/each/volume/sample_template.yaml</code></pre>\n<p><strong>oo-config-volume</strong>:</p>\n<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: oo-config-volume\nspec:\n  accessModes:\n    - ReadWriteMany\n  capacity:\n    storage: 1Gi\n  azureFile:\n    secretName: azure-secret\n    shareName: &lt;path_to_oo_volume&gt;/&lt;provide_config_volume_folder_name&gt;\n    secretNamespace: &lt;namespace_where_oo_is_going_to_be_installed&gt;\n  mountOptions:\n  - dir_mode=0775\n  - uid=&lt;system_user_id&gt;\n  - gid=&lt;system_group_id&gt;\n  - mfsymlinks\n  - nobrl\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: oo-default\n  volumeMode: Filesystem\n</code></pre>\n<p><strong>oo-data-volume</strong>:</p>\n<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: oo-data-volume\nspec:\n  accessModes:\n    - ReadWriteMany\n  capacity:\n    storage: 10Gi\n  azureFile:\n    secretName: azure-secret\n    shareName: &lt;path_to_oo_volume&gt;/&lt;provide_data_volume_folder_name&gt;\n    secretNamespace: &lt;namespace_where_OO_is_going_to_be_installed&gt;\n  mountOptions:\n  - dir_mode=0775\n  - uid=&lt;system_user_id&gt;\n  - gid=&lt;system_group_id&gt;\n  - mfsymlinks\n  - nobrl\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: oo-default\n  volumeMode: Filesystem</code></pre>\n<p><strong>oo-logs-volume</strong>:</p>\n<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: oo-logs-volume\nspec:\n  accessModes:\n    - ReadWriteMany\n  capacity:\n    storage: 20Gi\n  azureFile:\n    secretName: azure-secret\n    shareName: &lt;path_to_oo_volume&gt;/&lt;provide_log_volume_folder_name&gt;\n    secretNamespace: &lt;namespace_where_OO_is_going_to_be_installed&gt;\n  mountOptions:\n  - dir_mode=0775\n  - uid=&lt;system_user_id&gt;\n  - gid=&lt;system_group_id&gt;\n  - mfsymlinks\n  - nobrl\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: oo-default\n  volumeMode: Filesystem\n\n</code></pre>\n<p><strong>oo-ras-logs-vol</strong>:</p>\n<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: oo-ras-logs-volume\nspec:\n  accessModes:\n    - ReadWriteMany\n  capacity:\n    storage: 15Gi\n  azureFile:\n    secretName: azure-secret\n    shareName: &lt;path_to_oo_volume&gt;/&lt;provide_RAS_log_volume_folder_name&gt;\n    secretNamespace: &lt;namespace_where_OO_is_going_to_be_installed&gt;\n  mountOptions:\n  - dir_mode=0775\n  - uid=&lt;system_user_id&gt;\n  - gid=65000\n  - mfsymlinks\n  - nobrl\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: oo-default\n  volumeMode: Filesystem</code></pre>\n<p><strong>oo-data-export-vol</strong>:</p>\n<pre><code>apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: oo-data-export-volume\nspec:\n  accessModes:\n    - ReadWriteMany\n  capacity:\n    storage: 2Gi\n  azureFile:\n    secretName: azure-secret\n    shareName: &lt;path_to_oo_volume&gt;/&lt;provide_data_export_volume_folder_name&gt;\n    secretNamespace: &lt;namespace_where_OO_is_going_to_be_installed&gt;\n  mountOptions:\n  - dir_mode=0775\n  - uid=&lt;system_user_id&gt;\n  - gid=&lt;system_group_id&gt;\n  - mfsymlinks\n  - nobrl\n  persistentVolumeReclaimPolicy: Retain\n  storageClassName: oo-default\n  volumeMode: Filesystem</code></pre>\n<h2><a id=\"Create_OO_PVC\" name=\"Create_OO_PVC\" title=\"Create OO PVC\"></a>Create OO PVC</h2>\n<p>Edit and use the below sample PVC templates to create OO PVC using the command: </p>\n<pre><code>kubectl create -f /path/to/each/pvc/sample_template.yaml</code></pre>\n<p><strong>oo-config-pvc</strong>:</p>\n<pre><code>apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: oo-config-pvc\n  namespace: &lt;namespace_where_oo_is_going_to_be_installed&gt;\nspec:\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 2Gi\n  storageClassName: oo-default\n  volumeName: oo-config-volume\n</code></pre>\n<p><strong>oo-data-pvc</strong>:</p>\n<pre><code>apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: oo-data-pvc\n  namespace: &lt;namespace_where_oo_is_going_to_be_installed&gt;\nspec:\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 5Gi\n  storageClassName: oo-default\n  volumeName: oo-data-volume\n</code></pre>\n<p><strong>oo-logs-pvc</strong>:</p>\n<pre><code>apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: oo-logs-pvc\n  namespace: &lt;namespace_where_oo_is_going_to_be_installed&gt;\nspec:\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 20Gi\n  storageClassName: oo-default\n  volumeName: oo-logs-volume\n</code></pre>\n<p><strong>oo-ras-logs-pvc</strong>:</p>\n<pre><code>apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: oo-ras-logs-pvc\n  namespace: &lt;namespace_where_oo_is_going_to_be_installed&gt;\nspec:\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 15Gi\n  storageClassName: oo-default\n  volumeName: oo-ras-logs-volume</code></pre>\n<p><strong>oo-data-export-pvc</strong>:</p>\n<pre><code>apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: oo-data-export-pvc\n  namespace: &lt;namespace_where_oo_is_going_to_be_installed&gt;\nspec:\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 2Gi\n  storageClassName: oo-default\n  volumeName: oo-data-export-volume</code></pre>\n</div>",
  "modifiedon": "2025-10-24 08:51:12"
}