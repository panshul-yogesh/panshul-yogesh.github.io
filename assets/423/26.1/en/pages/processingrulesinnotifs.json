{
  "title": "Processing rules in notifications",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><div></div>\n<p>The message body of a notification template can contain processing rules that embed data in the email sent to a recipient when the notification event occurs. For example, you might want to do one of the following:</p>\n<ul>\n<li>Insert the avatar image of the email sender and the email recipient into the message, for personalization.</li>\n<li>Embed in the email the URL to a record.</li>\n<li>Hide the record name from users who don't have permission to view that record type.</li>\n<li>Make a statement conditional on a Boolean expression.</li>\n<li>Add a mailto option for the recipients to start an email conversation with Service Management.</li>\n</ul>\n<h2 class=\"mw-headline\" id=\"Avatar_rule\">Avatar rule</h2>\n<p>When the avatar rule runs, Service Management uses a person identifier (personId) to locate the linked avatar for that user. For example, you would insert <code>${:current_user.Id}</code> to identify the email sender. The avatar becomes a parameter in the rule. Service Management can locate and attach the avatar image file to the message. The HTML image reference in the notification causes the actual avatar image to appear in the formatted email message.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td><code>&lt;%=avatar(person id)%&gt;</code></td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Replaces the rule with the avatar for the user identified by the person identifier.</td>\n</tr>\n<tr>\n<td>Examples</td>\n<td>\n<p><code>&lt;%=avatar(${:current_user.Id})%&gt;</code></p>\n<p><code>&lt;%=avatar(${questionOwner})%&gt;</code></p>\n</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"Create_URL_rule\">Create URL rule</h2>\n<p>A similar rule creates a URL to reference data. When you embed the URL to the associated record, the user can easily open that record.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td><code>&lt;%=create_url(relative url)%&gt;</code></td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Replaces a relative URL with a full URL to a record.</td>\n</tr>\n<tr>\n<td>Example</td>\n<td><code>&lt;%=create_url(/ess/question/${questionId})%&gt;</code></td>\n</tr>\n</tbody>\n</table>\n<p>You can embed the URL using the <b>Create_url</b> rule in one of the following ways:</p>\n<ul>\n<li>Enter the rule directly in the text editor.</li>\n<li>Click the <b>link</b> <a class=\"image\" href=\"/file/images/d/db/2018.08_Helpcenter/Resources/Images/Icons/LinkURL.png\" title=\"/file/images/d/db/2018.08_Helpcenter/Resources/Images/Icons/LinkURL.png\"> <img alt=\"LinkURL.png\" data-file-height=\"22\" data-file-width=\"29\" height=\"22\" src=\"../../../images/LinkURL_6c41a207.png\" width=\"29\"/> </a> button in the editor toolbar and enter the rule in the <b>Link</b> dialog box. (Select the blank protocol option.) For more information, see <a href=\"/doc/423/26.1/notifications#CreateTemplate\" title=\"SMAX:25.1/Notifications\">How to create a notification template</a>, in the step describing how to embed a URL in the message.</li>\n</ul>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">\n<p>When you add a URL using the <b>link</b> button, you can edit the text of the link and the URL remains active. When you add a URL using directly in the text editor, the link can't be edited. It appears in the message as you entered it.</p>\n</div>\n</div>\n<h2>Approval queue URL rule</h2>\n<p>This rule generates a URL that points to the approval queue of the target recipient.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td><code>&lt;%=approval_queue_url(person id)%&gt;</code></td>\n</tr>\n<tr>\n<td>Description</td>\n<td>\n<p>Generates a URL that directs to the pending approval tasks of the recipient.</p>\n<p>If the recipient is an agent user, the URL points to the agent UI, for example:</p>\n<pre>https://&lt;hostname&gt;:&lt;port&gt;/home/approval?TENANTID=&lt;tenantId&gt;</pre>\n<p>If the recipient is a portal user, the URL points to the portal UI, for example:</p>\n<pre>https://&lt;hostname&gt;:&lt;port&gt;/saw/ess/approval?TENANTID=&lt;tenantId&gt;</pre>\n</td>\n</tr>\n<tr>\n<td>Example</td>\n<td><code>&lt;%=approval_queue_url(${:current_recipient.Id})%&gt;</code></td>\n</tr>\n</tbody>\n</table>\n<p>You can embed URLs in your emails using <strong>Approval queue URL</strong> rule in one of the following ways:</p>\n<ul>\n<li>Enter the rule directly in the text editor.</li>\n<li>Click the <b>link</b> <a class=\"image\" href=\"/file/images/d/db/2018.08_Helpcenter/Resources/Images/Icons/LinkURL.png\" title=\"/file/images/d/db/2018.08_Helpcenter/Resources/Images/Icons/LinkURL.png\"> <img alt=\"LinkURL.png\" data-file-height=\"22\" data-file-width=\"29\" height=\"22\" src=\"../../../images/LinkURL_6c41a207.png\" width=\"29\"/> </a> button in the editor toolbar and enter the rule in the <b>Link</b> dialog box. (Select the blank protocol option.) For more information, see <a href=\"/doc/423/26.1/notifications#CreateTemplate\" title=\"SMAX:25.1/Notifications\">How to create a notification template</a>, in the step describing how to embed a URL in the message.</li>\n</ul>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">\n<p>When you add a URL using the <b>link</b> button, you can edit the text of the link and the URL remains active. When you add a URL using directly in the text editor, the link can't be edited. It appears in the message as you entered it.</p>\n</div>\n</div>\n<h2 class=\"mw-headline\" id=\"Hide_record_name_rule\">Hide record name rule</h2>\n<p>In cases where a user doesn't have permission to view a record type, this rule hides the record name from such a user.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td><code>&lt;%=task_parent_name(person Id, entity type, entity Id, entity name)%&gt;</code></td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Hides the record name if the user doesn't have permission to view records of that type.</td>\n</tr>\n<tr>\n<td>Example</td>\n<td>\n<pre>&lt;%=task_parent_name(${:current_recipient.Id},${:entity.ParentEntityType},${:entity.ParentEntityId},${:entity.ParentDisplayLabelKey})%&gt;</pre>\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">\n<p>This rule is intended for use with task notifications only. It's included in such notification templates out-of-the-box.</p>\n</div>\n</div>\n<h2 class=\"mw-headline\" id=\"Conditional_statement_rule\">Conditional statement rule</h2>\n<p>You can define a rule to display a message only when a condition is satisfied. You can define a single message, which is displayed only when the condition is true, or two messages, one displayed for a true condition value and the other for a false condition value.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td>\n<p>Format 1:<code>&lt;%=conditional_statement(&lt;Boolean expression&gt;, 'Message')%&gt;</code></p>\n<p>Format 2: <code>&lt;%=conditional_statement(&lt;Boolean expression&gt;, 'Message_true', 'Message_false')%&gt;</code></p>\n</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>\n<p>In Format 1, the message is displayed when the Boolean expression is true. A blank string is displayed when the Boolean expression is false.</p>\n<p>In Format 2, the first message is displayed when the Boolean expression is true. The second message is displayed when the Boolean expression is false.</p>\n</td>\n</tr>\n<tr>\n<td>Example</td>\n<td><code>&lt;%=conditional_statement(${:entity.Priority=='HighPriority'}, 'High priority record')%&gt;</code></td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-important-icon\"></div>\n<div class=\"admonition-content admonition-important-content\">\n<ul>\n<li>Do not modify the following out-of-the-box templates listed below. If you insist to customize these templates, you can contact support.</li>\n<li>Do not apply these templates in other scenarios. The following templates are designed for email integration only.</li>\n</ul>\n</div>\n</div>\n<h3 class=\"mw-headline\">Show related knowledge rule</h3>\n<p>This rule is used to display the related knowledge articles according to the email received from the user.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td><code>&lt;%=showRelatedKnowledge(email subject, email contents, email sender, CreationSourceEmail)%&gt;</code></td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Search and display the related knowledge articles s according to the email received from the user.</td>\n</tr>\n<tr>\n<td>Example</td>\n<td><code>&lt;%=showRelatedKnowledge(${email.subject},${email.body},${userId},CreationSourceEmail)%&gt;</code></td>\n</tr>\n</tbody>\n</table>\n<h3 class=\"mw-headline\" id=\"Create_URL_rule\">Show related offering rule</h3>\n<p>This rule is used to display the related offerings according to the email received from the user.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td><code>&lt;%=showRelatedOffering(email subject, email contents, email sender,email address)%&gt;</code></td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Search and display the related offerings according to the email received from the user.</td>\n</tr>\n<tr>\n<td>Example</td>\n<td><code>&lt;%=showRelatedOffering(${email.subject},${email.body},${userId},${email.address})%&gt;</code></td>\n</tr>\n</tbody>\n</table>\n<h3>Show button rule</h3>\n<p>This rule is used to display a button only when a condition is satisfied.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td><code>&lt;%=show_button(configured condition)%&gt;</code></td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Display the button according to the configured condition. In the following example, the \"MARK AS SOLVED\" button is only displayed for the <a href=\"/doc/423/26.1/publicrequests\" title=\"public requests\">public requests</a> shared with the users.</td>\n</tr>\n<tr>\n<td>Example</td>\n<td><code>&lt;%=show_button(MARK AS SOLVED,${:entity.RequestType},${:entity.PublicScope},${:entity.Type},${:entity.Id},${:current_recipient.Id},${:current_recipient.Email},${:entity.DisplayLabel})%&gt;</code></td>\n</tr>\n</tbody>\n</table>\n<h3>Create record link rule</h3>\n<p>This rule is used to show a message with a clickable link.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td><code>&lt;%=create_record_link(</code>resource bundle key that defined in notification_metadata_messages<code>, </code>relative url of the link<code>, </code>text on link<code>)%&gt;</code></td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Display the message with a clickable link.</td>\n</tr>\n<tr>\n<td>Example</td>\n<td><code>&lt;%=create_record_link(ArticleNotifyAuthorPhaseChangeTemplateBody.phase_move,/saw/Article/${:entity.Id},${:entity.Type} ${:entity.Id}: ${:entity.DisplayLabel},${oldPhase},${:entity.PhaseId},${:current_user.Name})%&gt;</code></td>\n</tr>\n</tbody>\n</table>\n<p><strong>Note</strong>: The create_view_record_link and create_enhanced_record_link functions are for internal use only. Do not use them in your custom templates. </p>\n<h3>Show delegated user rule</h3>\n<p>This rule is used to show a message with the delegated user information.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td>&lt;%=active_delegates_names(message,${:entity.Assignee.Id},${:entity.ParentEntityType})%&gt;</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>\n<p>Display a message showing the information of the user to whom the approvals are delegated.</p>\n<p>If you don't specify the first parameter, the OOTB message \"This approval has been delegated to: <em>&lt;delegated user name&gt;</em>\" will be used. If no delegated user is configured in Service Portal, the message will be empty.</p>\n<p>For more information about how to delegate approvals to another user, see <a href=\"/doc/423/26.1/delegateapprovals\" title=\"Delegate approvals\">Delegate approvals</a>.</p>\n</td>\n</tr>\n<tr>\n<td>Example</td>\n<td>\n<ul>\n<li>&lt;%=active_delegates_names(,${:entity.Assignee.Id},${:entity.ParentEntityType})%&gt;\n\t\t\t\t<p>In this case, the \"This approval has been delegated to: <em>&lt;delegated user name&gt;</em>\" will be used.</p>\n</li>\n</ul>\n<ul>\n<li>&lt;%=active_delegates_names(“Please send your requests to ”,${:entity.Assignee.Id},${:entity.ParentEntityType})%&gt;\n\t\t\t\t<p>In this case, the \"Please send your requests to <em>&lt;delegated user name&gt;</em>\" message will be used.</p>\n</li>\n</ul>\n</td>\n</tr>\n</tbody>\n</table>\n<h2 class=\"mw-headline\" id=\"Avatar_rule\">Get the display name of an SLT target type</h2>\n<p>This rule is to get the display name of an SLT target type based on the recipient's locale setting.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td>&lt;%=slt_target_type_l10n(${sltTargetType})%&gt;</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Get the display name of an SLT target type based on the customer's locale setting.</td>\n</tr>\n<tr>\n<td>Examples</td>\n<td>&lt;%=slt_target_type_l10n(Fulfillment)%&gt;</td>\n</tr>\n</tbody>\n</table>\n<h2 class=\"mw-headline\" id=\"Avatar_rule\">Adjust the format of date and time based on the recipient's locale setting</h2>\n<p>This rule is to adjust the format of the date and time based on the recipient's locale setting.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td>&lt;%=format(${sltTargetDate})%&gt;</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Adjust the format of the date and time based on the recipient's locale setting.</td>\n</tr>\n<tr>\n<td>Examples</td>\n<td>&lt;%=format(1663318556519)%&gt;</td>\n</tr>\n</tbody>\n</table>\n<h2>Include a mailto option</h2>\n<p>Use the <strong>create_mailto</strong> rule to include a mailto option in the notification. A mailto option is a clickable hyperlink, associated with a pre-filled response message that you can embed in the notification. When the user clicks the mailto link, the system automatically creates an email message by using the user's default email client. The email body contains the pre-filled response. The email's recipient is automatically populated with the email address configured in the default email endpoint used by the email integration. The user can then directly send the email, which will be processed by the email integration.</p>\n<p>The <strong>create_mailto</strong> rule is applicable only if you have email integration configured. To set up email integration, see <a href=\"/doc/423/26.1/emailintegration\" title=\"Configure email integration\">Configure email integration</a>.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td>\n<p><code>&lt;%=create_mailto(RESPONSE_TYPE,${:entity.Type},${:entity.Id},${:entity. RequestedForPerson.Id},${:entity.RequestedForPerson.Email},${:entity. DisplayLabel})%&gt;</code></p>\n<p>Where <code>RESPONSE_TYPE</code> can be one of these values: <code>ACCEPT_REQUEST</code>, <code>REJECT_REQUEST</code>, <code>APPROVE_REQUEST</code>, <code>DENY_REQUEST</code>, <code>ADD_COMMENT</code>, <code>PROVIDE_INFO</code>.</p>\n</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Add a mailto option to the notification.</td>\n</tr>\n<tr>\n<td>Examples</td>\n<td>\n<p><strong>create_mailto</strong> rule to accept a service request on a Service Management notification:</p>\n<p><code>&lt;%=create_mailto(ACCEPT_REQUEST,${:entity.Type},${:entity.Id},${:entity. RequestedForPerson.Id},${:entity.RequestedForPerson.Email},${:entity. DisplayLabel})%&gt;</code></p>\n<p>For more examples, see <a href=\"/doc/423/26.1/emailintegration#(Optional)_Set_up_notification_templates_for_email_integration\" title=\"Generate a reply email\">Generate a reply email</a>.</p>\n</td>\n</tr>\n</tbody>\n</table>\n<h2>Show error message</h2>\n<p>This rule is related with the <strong>create_mailto</strong> rule. When the system encounters errors while processing the pre-filled response generated by the <strong>create_mailto</strong> rule, you can use this rule to display the error message and explain why the request-related operation failed.</p>\n<p>Note that by default, the system displays a hyperlink along with the error message. The user can click the link to open the corresponding request on the Service Portal. To prevent the system from displaying the hyperlink, enter <strong>true</strong> as the last parameter of this rule.</p>\n<table>\n<tbody>\n<tr>\n<td>Syntax</td>\n<td>\n<p><code>&lt;%=show_error_message(${errorCode},${entityType},${entityId},${entityDisplayLabel},display_request_link)%&gt;</code></p>\n</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Display the error message for the corresponding error.</td>\n</tr>\n<tr>\n<td>Examples</td>\n<td>\n<p><code>&lt;%=show_error_message(${errorCode},${entityType},${entityId},${entityDisplayLabel},true)%&gt;</code></p>\n</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"Related_topics\">Related topics</h2>\n<ul>\n<li><a href=\"/doc/423/26.1/notifications\" title=\"SMAX:25.1/Notifications\">Notifications</a></li>\n<li><a href=\"/doc/423/26.1/explanginnotifs\" title=\"SMAX:25.1/ExpLangInNotifs\">Expression Language in notifications</a></li>\n</ul>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}