{
  "title": "Prometheus pod is in \"Pending\" state after you upgrade OMT",
  "content": "<div class=\"mw-parser-output\"><span class=\"snippet-start\" data-sname=\"423-25.4-423-25.3-PrometheusPodPendingAfterUpgrade||N\"></span><p class=\"mw-empty-elt\">\n</p><p>After you upgrade OMT, the Prometheus pod stays in the \"Pending\" state. </p>\n<h2>Cause</h2>\n<p>This issue occurs because the <code>prometheus-operator </code>Helm chart was originally installed with a release name that wasn't “cdf-prometheus.”  Therefore, the chart’s dynamic rules created the Persistent Volume Claim for Prometheus with the wrong name.</p>\n<div>\n<h2>Solution</h2>\n<ol>\n<li>Run the following command to find the PVC name. Make a note of the returned value.\n\t<pre><code>kubectl get pvc -n $CDF_NAMESPACE | grep 'prometheus-0' |awk '{print $1}'|xargs</code></pre>\n</li>\n<li>Run the following command to find the PV name. Update the command with the value that you found in step 1. Make a note of the returned value.\n\t<pre><code>kubectl get pv | grep &lt;PVC_name&gt;| awk '{print $1}'| xargs</code></pre>\n</li>\n<li>Run the following command to delete the PVC. Update the command with the value that you found in step 1.\n\t<pre><code>kubectl delete pvc -n $CDF_NAMESPACE &lt;PVC_name&gt;</code></pre>\n</li>\n<li>Run the following command to reset the PV’s status. Update the command with the value that you found in step 2. \n\t<pre><code>kubectl patch pv &lt;PV_name&gt; -p '{\"spec\":{\"claimRef\":null}}'</code></pre>\n</li>\n<li>Run the following command to delete the Prometheus pod:\n\t<pre><code>kubectl delete pod -n $CDF_NAMESPACE &lt;prometheus_pod_in_pending_state&gt;</code></pre>\n</li>\n<li>Wait for the pod to restart.</li>\n</ol>\n</div>\n<p><br/>\n</p>\n<p class=\"mw-empty-elt\"></p><span class=\"snippet-end\" data-sname=\"423-25.4-423-25.3-PrometheusPodPendingAfterUpgrade||N\"></span><p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}