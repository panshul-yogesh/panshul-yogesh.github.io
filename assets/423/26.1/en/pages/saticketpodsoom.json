{
  "title": "smarta-smart-ticket-task pod crashes with the out-of-memory error",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>The <code>smarta-smart-ticket-task</code> pod may crash due to the out-of-memory error coming from the compressed class space.</p>\n<p>When it happens, the pod status resembles the following:      </p>\n<pre>kubectl get po -A -w | grep task                                                                                       \nitsma-eks     smarta-smart-ticket-task-6cdb84f776-xhvwl            1/2     Running     2 (56s ago)      6h14m</pre>\n<p>Also, the log of the smarta-smart-ticket-task pod displays the content like this:</p>\n<pre>.......\nTerminating due to java.lang.OutOfMemoryError: Compressed class space</pre>\n<h2>Cause</h2>\n<p> The default size for the Compressed Class Metadata Space is not enough and needs to be tuned.</p>\n<h2>Solution</h2>\n<p>To fix this issue, run the following commands in the Kubernetes master or bastion:</p>\n<pre>itsma_namespace=`kubectl get namespace |grep itsma | cut -f1 -d \" \"`\nkubectl patch deployment smarta-smart-ticket-task --type=json -p='[{\"op\": \"add\",\"path\": \"/spec/template/spec/containers/1/env/30\",\"value\": {\"name\": \"COMPRESSED_CLASS_SPACE_SIZE\",\"value\": \"64M\"}}]' -n ${itsma_namespace}\nkubectl rollout status deployment smarta-smart-ticket-task -n $itsma_namespace</pre>\n<p>After this, the pod should be back to normal.</p>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}