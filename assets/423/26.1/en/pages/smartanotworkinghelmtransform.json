{
  "title": "Smart Analytics doesn't work properly in helm transformation",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>If you transform the suite from a classic deployment to a helm deployment, these issues might occur:</p>\n<ul>\n<li>The <strong>smarta-stx-category</strong> and <strong>smarta-stx-agentstore</strong> pods keep restarting during the training of smart tickets.</li>\n<li>The <strong>smarta-installer</strong> pod fails to start and there's an error in the log indicating that the pod can't mount the \"count\" file.</li>\n</ul>\n<h2>Cause</h2>\n<p>The permission to access the NFS file folder is incorrect.</p>\n<h2>Solution</h2>\n<p id=\"Change_the_owner_of_certain_storage_folders\" tabindex=\"-1\">To solve this issue, you need to change the owner of certain storage folders by following these steps:</p>\n<ol>\n<li>Log in to the NFS server.</li>\n<li>Run the following commands for each smart analytics volume:\n\t<pre>    cd &lt;smartanalytics-volume&gt;\n    find . -maxdepth 5 -type d -user root -group &lt;GID&gt; | wc -l\n</pre>\n<p>Where:</p>\n<ul>\n<li>\n<p><em>&lt;GID&gt;</em> is the <strong>SYSTEM_GROUP_ID</strong> value defined in the <strong>install.properties</strong> file, which has a default value of <strong>1999</strong>.</p>\n</li>\n<li>\n<p><em>&lt;smartanalytics-volume&gt;</em> is the export path of the suite's smart analytics volume. There are three paths:</p>\n<ul>\n<li>\n<p>/var/vols/itom/data/itsma-logging-volume-pvc-xxxxxx</p>\n</li>\n<li>\n<p>/var/vols/itom/data/itsma-data-volume-pvc-xxxxxx</p>\n</li>\n<li>\n<p>/var/vols/itom/data/itsma-config-volume-pvc-xxxxxx</p>\n</li>\n</ul>\n</li>\n</ul>\n<p> The following is an example:</p>\n<pre>    cd /var/vols/itom/data/itsma-logging-volume-pvc-xxxxxx/idol\n    find . -maxdepth 5 -type d -user root -group 1999 | wc -l\n\n    cd /var/vols/itom/data/itsma-data-volume-pvc-xxxxxx/idol\n    find . -maxdepth 5 -type d -user root -group 1999 | wc -l\n\n    cd /var/vols/itom/data/itsma-config-volume-pvc-xxxxxx/idol\n    find . -maxdepth 5 -type d -user root -group 1999 | wc -l\n</pre>\n</li>\n<li>If the return value from step 2 is equal to zero (0), skip this step. <br/>\n\tIf the return value from step 2 is greater than zero (0), run the following commands for each smart analytics volume:<br/>\n<strong>Note:</strong> You need to insert \"<code>sudo</code>\" before \"<code>chown</code>\" if the result in step 3 shows \"operation not permitted\" or other permission-related errors.\n\t<pre>    cd &lt;smartanalytics-volume&gt;\n    find . -maxdepth 5 -type d -user root -group &lt;GID&gt; | xargs chown &lt;UID&gt;:&lt;GID&gt; -c \n</pre>\n<p>Where:</p>\n<ul>\n<li>\n<p><em>&lt;UID&gt;</em>and <em>&lt;GID&gt;</em> are the <strong>SYSTEM_USER_ID</strong> and <strong>SYSTEM_GROUP_ID</strong> values defined in the <strong>install.properties</strong> file, respectively (both have a default value of <strong>1999</strong>).</p>\n</li>\n<li>\n<p><em>&lt;smartanalytics-volume&gt;</em> is the export path of the suite's smart analytics volume. There are three paths:</p>\n<ul>\n<li>\n<p>/var/vols/itom/data/itsma-logging-volume-pvc-xxxxxx</p>\n</li>\n<li>\n<p>/var/vols/itom/data/itsma-data-volume-pvc-xxxxxx</p>\n</li>\n<li>\n<p>/var/vols/itom/data/itsma-config-volume-pvc-xxxxxx</p>\n</li>\n</ul>\n</li>\n</ul>\n<p> The following is an example:</p>\n<pre>    cd /var/vols/itom/data/itsma-logging-volume-pvc-xxxxxx/idol\n    find . -maxdepth 5 -type d -user root -group 1999 | xargs chown 1999:1999 -c\n\n    cd /var/vols/itom/data/itsma-data-volume-pvc-xxxxxx/idol \n    find . -maxdepth 5 -type d -user root -group 1999 | xargs chown 1999:1999 -c\n\n    cd /var/vols/itom/data/itsma-config-volume-pvc-xxxxxx/idol \n    find . -maxdepth 5 -type d -user root -group 1999 | xargs chown 1999:1999 -c\n</pre>\n</li>\n</ol>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">You may have missed this section before the upgrade and later the <strong>smarta-XXX-con-N</strong>, <strong>smarta-XXX-dah-N</strong>, <strong>smarta-XXX-dih-XXX</strong>, and <strong>smarta-stx-XXXXX</strong> pods fail to start during the system upgrade process. To solve this issue, run the following commands to restart the installer pod again.\n\n<pre>kubectl scale deploy smarta-installer -n itsma-XXXX --replicas 0\nkubectl scale deploy smarta-installer -n itsma-XXXX --replicas 1\n</pre>\n</div>\n</div>\n<div></div>\n<div></div>\n<div></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}