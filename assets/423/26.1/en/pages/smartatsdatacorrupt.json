{
  "title": "IDOL data corrupts",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p><br/>\nIf Smart Analytics fails or doesn't work as expected, we suggest that you check the statuses of content pods to verify whether IDOL data is corrupted.</p>\n<h2 class=\"mw-headline\" id=\"Cause\">Cause</h2>\n<p>A possible cause of this issue is that IDOL is shut down forcibly or unexpectedly.</p>\n<h2 class=\"mw-headline\" id=\"Solution\">Solution</h2>\n<ol>\n<li>\n<p>Log in to a control plane node of the suite and then run the <code>kubectl get pods --all-namespaces | grep smarta | grep con</code> command to display a list of the IDOL content pods. For example,</p>\n<table class=\"sortable\">\n<tbody>\n<tr>\n<th>NAMESPACE</th>\n<th>NAME</th>\n<th>READY</th>\n<th>STATUS</th>\n<th>RESTARTS</th>\n<th>AGE</th>\n</tr>\n<tr>\n<td>itsma1</td>\n<td>smarta-saw-con-0</td>\n<td>1/1</td>\n<td>Running</td>\n<td>0</td>\n<td>1d</td>\n</tr>\n<tr>\n<td>itsma1</td>\n<td>smarta-saw-con-1</td>\n<td>1/1</td>\n<td>Running</td>\n<td>0</td>\n<td>1d</td>\n</tr>\n<tr>\n<td>itsma1</td>\n<td>smarta-sawarc-con-0</td>\n<td>0/1</td>\n<td>Running</td>\n<td>12</td>\n<td>2h</td>\n</tr>\n<tr>\n<td>itsma1</td>\n<td>smarta-sawarc-con-1</td>\n<td>1/1</td>\n<td>Running</td>\n<td>0</td>\n<td>1d</td>\n</tr>\n<tr>\n<td>itsma1</td>\n<td>smarta-sawmeta-con-0</td>\n<td>1/1</td>\n<td>Running</td>\n<td>0</td>\n<td>1d</td>\n</tr>\n<tr>\n<td>itsma1</td>\n<td>smarta-sawmeta-con-1</td>\n<td>1/1</td>\n<td>Running</td>\n<td>0</td>\n<td>1d</td>\n</tr>\n<tr>\n<td>...</td>\n<td>...</td>\n<td>...</td>\n<td>...</td>\n<td>...</td>\n<td>...</td>\n</tr>\n</tbody>\n</table>\n<p>Take <b>smarta-sawarc-con-0</b> in the above table as an example. The READY column displays 0/1. The RESTARTS column displays 12, which indicates that the system has tried to restart this pod for many times. In this case, the pod is most likely in data corruption.</p>\n</li>\n<li>Follow the following steps to recover IDOL only if you encounter the same issue as mentioned above. Otherwise, you need to find another solution.\n\t<div class=\"Admonition_Warning\">\n<p><b>Warning:</b> The following procedure will delete all the files of the crushed IDOL content and do the reindexing.</p>\n</div>\n<ol>\n<li>Get the StatefulSet name and the pod number under it. Take the pod <b>smarta-sawarc-con-0</b> as an example. Run the command <code>kubectl get sts -n &lt;namespace&gt; | grep smarta-sawarc-con</code> to get the StatefulSet name. Run the command <code>kubectl get sts &lt;StatefulSet name&gt; -n &lt;namespace&gt; -o=jsonpath='{.spec.replicas}'</code> to get the number of pods under this StatefulSet. You will need this number in a later step.</li>\n<li>Run the command <code>kubectl scale sts &lt;StatefulSet name&gt; --replicas=0 -n &lt;namespace&gt;</code> to stop the pod.</li>\n<li>\n<p>Find the data file directory of the content pod. Refer to the following table for some pods and the corresponding data directories on the NFS server.</p>\n<table class=\"sortable\">\n<tbody>\n<tr>\n<th><b>Pod name</b></th>\n<th><b>Data file directory</b></th>\n</tr>\n<tr>\n<td>smarta-saw-con-0</td>\n<td>&lt;NFS folder&gt;/itsma-smarta-saw-con-0/smarta-saw-con-0</td>\n</tr>\n<tr>\n<td>smarta-saw-con-1</td>\n<td>&lt;NFS folder&gt;/itsma-smarta-saw-con-1/smarta-saw-con-1</td>\n</tr>\n<tr>\n<td>smarta-saw-con-2</td>\n<td>&lt;NFS folder&gt;/itsma-smarta-saw-con-2/smarta-saw-con-2</td>\n</tr>\n<tr>\n<td>smarta-saw-con-3</td>\n<td>&lt;NFS folder&gt;/itsma-smarta-saw-con-3/smarta-saw-con-3</td>\n</tr>\n<tr>\n<td>smarta-saw-con-4</td>\n<td>&lt;NFS folder&gt;/itsma-smarta-saw-con-4/smarta-saw-con-4</td>\n</tr>\n<tr>\n<td>smarta-saw-con-5</td>\n<td>&lt;NFS folder&gt;/itsma-smarta-saw-con-5/smarta-saw-con-5</td>\n</tr>\n<tr>\n<td>smarta-sawarc-con-0</td>\n<td>&lt;NFS folder&gt;/itsma-smarta-sawarc-con-0/smarta-sawarc-con-0</td>\n</tr>\n<tr>\n<td>smarta-sawarc-con-1</td>\n<td>&lt;NFS folder&gt;/itsma-smarta-sawarc-con-1/smarta-sawarc-con-1</td>\n</tr>\n<tr>\n<td>smarta-sawmeta-con-0</td>\n<td>&lt;NFS folder&gt;/itsma-smarta-sawmeta-con-0/smarta-sawmeta-con-0</td>\n</tr>\n<tr>\n<td>smarta-sawmeta-con-1</td>\n<td>&lt;NFS folder&gt;/itsma-smarta-sawmeta-con-1/smarta-sawmeta-con-1</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>On NFS server, run the <code>rm -rf &lt;DATA DIRECTORY&gt;</code> command to remove the data directory. Alternatively, you can run the <code>mv &lt;DATA DIRECTORY NAME&gt; &lt;NEW NAME&gt;</code> command to rename the directory.</li>\n<li>\n<p>On a control plane node, run the <code>kubectl scale sts &lt;StatefulSet name&gt; --replicas=&lt;N&gt; -n &lt;namespace&gt;</code> command to restart the pod. In this command, &lt;N&gt; is the number you got in step <i>a</i>. You can run the <code>kubectl get pods --all-namespaces | grep &lt;POD NAME&gt;</code> command multiple times to check whether the pod starts successfully and gets ready. The result may look as follows.</p>\n<table>\n<tbody>\n<tr>\n<th>NAMESPACE</th>\n<th>NAME</th>\n<th>READY</th>\n<th>STATUS</th>\n<th>RESTARTS</th>\n<th>AGE</th>\n</tr>\n<tr>\n<td>itsma1</td>\n<td>&lt;POD_NAME&gt;</td>\n<td>1/1</td>\n<td>Running</td>\n<td>0</td>\n<td>10m</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>Perform a full reindex. See <a href=\"/doc/423/26.1/fullreindex\" title=\"SMAX:25.1/FullReindex\">Perform a full reindex for Smart Analytics</a> for detailed instructions.</li>\n</ol>\n</li>\n</ol>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}