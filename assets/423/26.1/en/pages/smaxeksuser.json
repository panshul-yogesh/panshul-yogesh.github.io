{
  "title": "Create AWS user policy and key pair",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><table>\n<tbody>\n<tr>\n<th>Role</th>\n<th>Location</th>\n</tr>\n<tr>\n<td>Cloud administrator</td>\n<td>AWS Management Console</td>\n</tr>\n</tbody>\n</table>\n<h2 class=\"mw-headline\">Create an AWS user policy</h2>\n<p>SMA provisions the EKS cluster and other infrastructure by using CloudFormation. You need to prepare your user account with the right permissions to launch CloudFormation templates and provision resources on AWS. To do this, create a user policy using the provided json file and then attach this policy to your user account by following these steps:</p>\n<div class=\"Admonition_Note\"><span class=\"autonumber\">Note  </span>You need to have the required permissions to attach a user policy. Contact your AWS administrators to add permissions for your account or ask the administrators to attach the created user policy to your account.</div>\n<h3>Step 1: Prepare IAM policy</h3>\n<ol>\n<li>Log in to the AWS Management Console with your AWS account.</li>\n<li>Navigate to <b>All services</b> &gt; <b>Security, Identity, &amp; Compliance</b> &gt; <b>IAM</b>. The IAM Management Console opens.</li>\n<li>Click <b>Policies</b> and follow these steps to create a required policy:\n\t<ol start=\"1\">\n<li>Click <b>Create policy</b> and click the <b>JSON</b> tab.</li>\n<li>Clear the existing codes on the <b>JSON</b> tab and copy the following content into it:\n\t\t<pre>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"1\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"ec2:*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"2\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cloudformation:CreateUploadBucket\",\n                \"cloudformation:DescribeStackResources\",\n                \"cloudformation:GetTemplateSummary\",\n                \"cloudformation:DescribeStacks\",\n                \"cloudformation:DescribeStackEvents\",\n                \"cloudformation:CreateStack\",\n                \"cloudformation:GetTemplate\",\n                \"cloudformation:DeleteStack\",\n                \"cloudformation:ListStacks\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"3\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"elasticfilesystem:CreateFileSystem\",\n                \"elasticfilesystem:DeleteFileSystem\",\n                \"elasticfilesystem:DescribeBackupPolicy\",\n                \"elasticfilesystem:DescribeFileSystems\",\n                \"elasticfilesystem:ListTagsForResource\",\n                \"elasticfilesystem:CreateMountTarget\",\n                \"elasticfilesystem:DescribeMountTargets\",\n                \"elasticfilesystem:DeleteMountTarget\",\n                \"elasticfilesystem:backup\",\n                \"elasticfilesystem:restore\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"41\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:CreateInstanceProfile\",\n                \"iam:DeleteInstanceProfile\",\n                \"iam:GetRole\",\n                \"iam:RemoveRoleFromInstanceProfile\",\n                \"iam:ListRoles\",\n                \"iam:DeleteRole\",\n                \"iam:CreateRole\",\n                \"iam:AttachRolePolicy\",\n                \"iam:PutRolePolicy\",\n                \"iam:AddRoleToInstanceProfile\",\n                \"iam:ListAttachedRolePolicies\",\n                \"iam:CreatePolicy\",\n                \"iam:DeletePolicy\",\n                \"iam:DetachRolePolicy\",\n                \"iam:DeleteRolePolicy\",\n                \"iam:ListServerCertificates\",\n                \"iam:ListSAMLProviders\",\n                \"iam:ListOpenIDConnectProviders\",\n                \"iam:GetOpenIDConnectProvider\",\n                \"iam:CreateOpenIDConnectProvider\",\n                \"iam:TagOpenIDConnectProvider\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"42\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:PassRole\"\n            ],\n            \"Resource\": [\n                \"arn:aws:iam::*:role/EksSvcRole-*\",\n                \"arn:aws:iam::*:role/*NodeInstanceRole-*\",\n                \"arn:aws:iam::*:role/BastionRole-*\",\n                \"arn:aws:iam::*:role/service-role/*\"\n            ]\n        },\n        {\n            \"Sid\": \"5\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:CreateBucket\",\n                \"s3:PutObject\",\n                \"s3:GetObject\",\n                \"s3:ListAllMyBuckets\",\n                \"s3:ListBucket\",\n                \"s3:ListBucketVersions\",\n                \"s3:DeleteObject\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"6\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"sns:ListTopics\",\n                \"sns:ListSubscriptions\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"7\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"rds:CreateDBCluster\",\n                \"rds:CreateDBInstance\",\n                \"rds:CreateDBSubnetGroup\",\n                \"rds:CreateDBParameterGroup\",\n                \"rds:CreateDBClusterSnapshot\",\n                \"rds:CreateDBSnapshot\",\n                \"rds:DeleteDBSnapshot\",\n                \"rds:DeleteDBCluster\",\n                \"rds:DeleteDBInstance\",\n                \"rds:DeleteDBSubnetGroup\",\n                \"rds:DescribeDBClusters\",\n                \"rds:DescribeDBInstances\",\n                \"rds:DescribeDBSecurityGroups\",\n                \"rds:DescribeDBSnapshots\",\n                \"rds:DescribeDBSubnetGroups\",\n                \"rds:StartDBCluster\",\n                \"rds:StartDBInstance\",\n                \"rds:StopDBCluster\",\n                \"rds:StopDBInstance\",\n                \"rds:AddTagsToResource\",\n                \"rds:DescribeDBClusterSnapshots\",\n                \"rds:ListTagsForResource\",\n                \"rds:CopyDBSnapshot\",\n                \"rds:CopyDBClusterSnapshot\",\n                \"rds:RestoreDBInstanceFromDBSnapshot\",\n                \"rds:RestoreDBClusterFromSnapshot\",\n                \"rds:RestoreDBInstanceToPointInTime\",\n                \"rds:DescribeGlobalClusters\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"8\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"eks:AssociateIdentityProviderConfig\",\n                \"eks:DisassociateIdentityProviderConfig\",\n                \"eks:ListIdentityProviderConfigs\",\n                \"eks:CreateCluster\",\n                \"eks:DeleteCluster\",\n                \"eks:CreateNodegroup\",\n                \"eks:DeleteNodegroup\",\n                \"eks:DescribeNodegroup\",\n                \"eks:DescribeCluster\",\n                \"eks:ListClusters\",\n                \"eks:ListNodegroups\",\n                \"eks:ListTagsForResource\",\n                \"eks:ListUpdates\",\n                \"eks:TagResource\",\n                \"eks:UntagResource\",\n                \"eks:UpdateClusterVersion\",\n                \"eks:UpdateNodegroupVersion\",\n                \"elasticloadbalancing:DescribeLoadBalancers\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"9\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"acm:RequestCertificate\",\n                \"acm:ImportCertificate\",\n                \"acm:DeleteCertificate\",\n                \"acm:DescribeCertificate\",\n                \"acm:ExportCertificate\",\n                \"acm:ListCertificates\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"10\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"autoscaling:DescribeAutoScalingGroups\",\n                \"autoscaling:DescribeLaunchConfigurations\",\n                \"autoscaling:UpdateAutoScalingGroup\",\n                \"autoscaling:DeleteAutoScalingGroup\",\n                \"autoscaling:CreateAutoScalingGroup\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"11\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"route53:GetHostedZoneCount\",\n                \"route53:ListHostedZones\",\n                \"route53:ListHostedZonesByName\",\n                \"route53:GetHostedZone\",\n                \"route53:ListResourceRecordSets\",\n                \"route53:ChangeResourceRecordSets\",\n                \"route53:GetChange\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"12\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ecr:CreateRepository\",\n                \"ecr:DescribeRepositories\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"13\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"aws-marketplace:ViewSubscriptions\",\n                \"aws-marketplace:Subscribe\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"14\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"backup:*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"15\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"kms:DescribeKey\",\n                \"kms:CreateGrant\",\n                \"kms:GenerateDataKey\",\n                \"kms:Decrypt\",\n                \"kms:RetireGrant\",\n                \"kms:ListKeys\",\n                \"kms:ListAliases\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"16\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"config:DescribeConfigurationRecorders\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}</pre>\n</li>\n<li>Click <b>Review policy</b> and give a name to this policy. For example, <em>sma-aws-policy</em>.</li>\n<li>Click <b>Create policy</b>. Wait until a message appears, indicating you have created the policy.</li>\n</ol>\n</li>\n</ol>\n<h3>Step 2: Attach the policy to a user or role.</h3>\n<p>AWS provides multiple ways to attach the policy to a user, here are two possible methods below. </p>\n<h4>Method 1:</h4>\n<p>If you want a specific IAM user in your account to be the operator. In this scenario, each user can have their own password to access the AWS Management Console. </p>\n<p>Click <b>Users</b> and follow these steps to attach the policy to your user account:</p>\n<ol>\n<li>Click the chosen user account from the user list.</li>\n<li>Click <b>Add permissions</b> &gt; <b>Attach existing policies directly</b>.</li>\n<li>Select the user policy created in the previous step and click <b>Next: Review</b>.</li>\n<li>Click <b>Add permissions</b> and wait till a message appears, indicating you have attached the policy. If you don't have the required permissions to attach the user policy, contact your AWS administrators.</li>\n</ol>\n<div class=\"Admonition_Important\"><span class=\"autonumber\">Important</span> Once you log in to the AWS Management Console, you can select a region at the upper-right corner. You must place all the created resources in the same region to prevent performance issues, including VPC, EKS cluster, EFS, RDS, and bastion. Some regions don't support the availability of all the required resources. We recommend that you read instructions at <a class=\"external text\" href=\"https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/\" rel=\"nofollow\" target=\"1\">Geographical distribution of AWS</a> before you select a region.</div>\n<h4>Method 2:</h4>\n<p>If you want a federated user to be the operator. </p>\n<p>In this scenario, your company has its own corporate directory to provide single-sign-on 'SSO' access to the AWS Management Console for your users.</p>\n<ol>\n<li>Create a role for the federated users and attach the prepared policy to it. See <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-idp_saml.html\">Creating a role for federation</a>.</li>\n<li>Switch to the role. See <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-console.html\">switching roles</a>.</li>\n</ol>\n<p>If the above methods do not suit your needs, you can refer to the <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction_access-management.html\">AWS official guide</a> for more options or contact AWS support for assistance.</p>\n<h2 class=\"mw-headline\" id=\"Download_the_Cloud_Deployment_package\">Create a key pair on AWS</h2>\n<p>Before proceeding, you also need to allocate an FQDN for the suite ALB (for example, via AWS route 53 services by following the <a href=\"https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resource-record-sets-creating.html\">AWS document</a>) and create a key pair on AWS (see the <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html#having-ec2-create-your-key-pair\">AWS document</a>) if you don't have one in the selected region.</p>\n<h2 class=\"mw-headline\" id=\"Related_topics\">External references</h2>\n<p>For more information on AWS user permissions, see <a class=\"external text\" href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction.html?icmpid=docs_iam_console\" rel=\"nofollow\" target=\"1\">AWS IAM</a>.</p>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}