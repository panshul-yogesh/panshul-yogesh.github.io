{
  "title": "\"Failed to pull image\" error when you try to upgrade OMT",
  "content": "<div class=\"mw-parser-output\"><span class=\"snippet-start\" data-sname=\"423-25.4-423-25.3-UpgradeFailedToPullImage||N\"></span><p class=\"mw-empty-elt\">\n</p><p>When you try to upgrade OMT, the upgrade fails and some pods enter an abnormal state. If you run the <code>kubectl describe pod &lt;pod_name&gt; -n &lt;namespace&gt;</code> command to query a pod that's in an abnormal state, you see errors that resemble the following:</p>\n<pre><code>Failed to pull image \"localhost:5000/hpeswitom/golang:1.15.3-esgz\": rpc error: code = Unknown desc = failed to pull and unpack image \"localhost:5000/hpeswitom/golang:1.15.3-esgz\": failed to resolve reference \"localhost:5000/hpeswitom/golang:1.15.3-esgz\": failed to do request: Head \"https://localhost:5000/v2/hpeswitom/golang/manifests/1.15.3-esgz\": x509: certificate signed by unknown authority</code></pre>\n<h2>Cause</h2>\n<p>This issue occurs because your deployment uses a private registry CA certificate that has no authority. During installation, OMT didn’t add this private registry CA certificate to every node. Therefore, when you try to upgrade OMT, you can't pull images from a private registry when there is no image cache on the current node.</p>\n<h2>Solution</h2>\n<ol>\n<li>Run the following command to copy the private registry CA certificate to the OpenSSL directory:\n\t<pre><code>cp &lt;private_ca_certificate&gt; /etc/pki/ca-trust/source/anchors/</code></pre>\n<p> <br/>\n\tFor example: \n</p>\n<pre><code>cp /path/to/CA/certificate /etc/pki/ca-trust/source/anchors/\n</code></pre>\n</li>\n<li>Load the private registry CA certificate:\n\t<pre><code>update-ca-trust extract</code></pre>\n</li>\n<li>Run the following command to restart the Kubernetes services, which will import the private registry CA certificate:\n\t<pre><code>${CDF_HOME}/bin/kube-restart.sh</code></pre>\n</li>\n<li>Repeat steps 1-3 on each node in the cluster.</li>\n</ol>\n<p><br/>\n</p>\n<p class=\"mw-empty-elt\"></p><span class=\"snippet-end\" data-sname=\"423-25.4-423-25.3-UpgradeFailedToPullImage||N\"></span><p><br/>\n </p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}