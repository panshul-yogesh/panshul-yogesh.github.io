{
  "title": "Development guide for Web Components widgets",
  "content": "<div class=\"mw-parser-output\"><p class=\"mw-empty-elt\"></p><div class=\"mw-parser-output\"><p class=\"mw-empty-elt\">\n</p><p>Web Components is an open standard used by most web applications to develop reusable or extensible components. Service Portal leverages Web Components as an extension feature.</p>\n<p>Since Web Components is a standard component model for modern Web, it is possible to implement any web function, whether simple or complex, in an encapsulated and single-responsibility code block that can be used on any web page.</p>\n<h2>Prerequisites for Web Components development</h2>\n<ul>\n<li>Basic understanding the Web Components concept and usage</li>\n<li>Experience on Web development including HTML/CSS/JavaScript or TypeScript</li>\n<li>Experience on common JavaScript build tools like Webpack or Rollup</li>\n</ul>\n<h2>Tools</h2>\n<p>Web components usually are manifested as custom elements which are defined in a JavaScript code block. You can write it in pure JavaScript, but there are many third-party libraries that aim to help building custom elements faster and simpler.</p>\n<p>Some Web Components development libraries:</p>\n<ul>\n<li><a href=\"https://lit.dev/\" title=\"Lit\">Lit</a>: Lit is a simple library from Google for building fast, lightweight web components.</li>\n<li><a href=\"https://stenciljs.com/\" title=\"Stencil\">Stencil</a>: Generate small, blazing fast, and 100% standards based Web Components that run in every browser.</li>\n<li><a href=\"https://www.fast.design/docs/fast-element\" title=\"FAST Element\">FAST Element</a>: The fast-element library is a lightweight means to easily build performant, memory-efficient, standards-compliant Web Components. There's also a web design system built on fast-element which coming from Microsoft.</li>\n</ul>\n<p>Also, some widely used web application frameworks like Angular, Vue and React can produce Web Components from their own components. If you want to take advantage of the features provided by the framework, you can start with some of them:</p>\n<ul>\n<li><a href=\"https://angular.io/guide/elements\" title=\"Angular component to custom elements\">Angular component to custom elements</a></li>\n<li><a href=\"https://vuejs.org/guide/extras/web-components.html#building-custom-elements-with-vue\" title=\"Building custom elements with Vue\">Building custom elements with Vue</a></li>\n<li><a href=\"https://reactjs.org/docs/web-components.html#using-react-in-your-web-components\" title=\"Using React in your Web Components\">Using React in your Web Components</a></li>\n</ul>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">\n<ul>\n<li>When you choose a library for the custom widget placed in Shadow DOM, be sure to evaluate the possible impact on Service Portal, or encapsulate the custom widget in iframe. For example, Service Portal has a dependency on <a href=\"https://lodash.com/\" title=\"Lodash \">Lodash </a>4.x, if your widget import Lodash in a different major version it will bring conflict and may impact Service Portal, so you must change the dependency or put the widget in iframe encapsulation.</li>\n<li>Not all the features in a web framework are available in its generated web components. For example, Angular routing feature is disabled when developing a custom element because routing is usually an application-level function and could not be adopted inside a component-level product.</li>\n</ul>\n</div>\n</div>\n<h2>Development</h2>\n<p>Service Portal always supports the latest major browsers, so you can always use the latest version of JavaScript to create the custom widget components. You also need to refer to the documentations of the library which you use to develop the custom widget component.</p>\n<p>For security reasons, Service Portal has strict restrictions on what kind of behaviours are allowed for custom widgets. For example, before you open a URL from Service Portal, the link is validated. So in the <a href=\"/doc/423/26.1/htmlcustomwidget#Create_your_HTML_file\" title=\"HTML widget use case\">HTML widget use case</a>, a call-back function of ESMHoneycomb named <code>open</code> is applied to verify if the link is trusted by the system. Be cautious if you insists to bypass these security restrictions in your own web components and HTML documents. </p>\n<p>Here are some principles you need to follow when developing Web Components:</p>\n<ul>\n<li>Define the custom element for synchronous execution. The custom element should be defined when a script file is loaded into a browser for Service Portal to bootstrap. Asynchronous-defined custom elements could lead to a timeout exception in Service Portal UI.</li>\n<li>Custom widgets and Service Portal are run in the same origin. Custom widgets and Service Portal also share the same global objects, such as <code>localStorage</code> and <code>sessionStorage</code>.</li>\n<li>Custom widgets and Service Portal share the same cookies. All the Rest API network requests to Service Management will be authorized as the Service Portal logged-in user.</li>\n<li>Custom widgets in Shadow DOM and Service Portal are in the same browsing contents. Don't manipulate global objects or DOM out of your widget components. For example, don't query data from Service Portal DOM elements because it isn't guaranteed that the data structure compatibility will remain in future versions.</li>\n<li>Service Portal wraps your custom widget in Shadow DOM or iframe. It's not required to attach Shadow DOM in your own Web Components.</li>\n<li>For a better user experience, you also need to consider the Accessibility (A11y), Localization and responsive layout of the contents during the development of the widget.</li>\n</ul>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">Don't define any attributes for your custom element. This is because your custom element will be attached to Service Portal in terms of <code>&lt;custom-element&gt;&lt;/custom-element&gt;</code>. if there is any attribute defined for the custom element, for example, <code>&lt;custom-element text='12345'&gt;&lt;/custom-element&gt;</code>, then the <code>text</code> attribute in this example can't be handled by Service Portal.</div>\n</div>\n<h2>Production</h2>\n<p>When building Web Components, you can use tools like Webpack or Rollup to generate the code. You also need to refer to the documentations of the library which you use to develop the custom widget components for production.</p>\n<p>Web Components are defined and delivered as JavaScript code. To reduce the number of network requests and to avoid loading order problems between multiple files, Service Portal only accepts one singular JavaScript file to inject Web Components. So you need to organize all your content in one JavaScript file. The static resources that the components depend on, such as images and videos, should be served from your own web server. Ensure that the widget audience can access these resources.</p>\n<p>When you choose to use iframe as the encapsulation type of Web Components, the CSS contents are allowed to be separated in an additional CSS file, which is optional. But the CSS file is not able to be used in Shadow DOM components due to the Shadow DOM specification.</p>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">For production environment, it is highly recommended that you bundle and minify the source code to reduce network requests and bandwidth. It is also recommended that you uglify the source code and remove the source map for security reasons.</div>\n</div>\n<h2>Use CustomEvent</h2>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent\" title=\"Custom Event \">Custom Event </a>is a standardized browser API which is useful for communication between the web components and the host application. Inside the custom widget web components, you can listen to specific types of CustomEvent and propagate the required event to trigger an action.</p>\n<p>Service Portal uses the standard CustomEvent interface to exchange events. Some events accept an object payload for data exchange. According to the CustomEvent specification, payload data should be placed in the <code>detail</code> property of the second object parameter when you construct the event:</p>\n<pre>    new CustomEvent('event-type', {\n        detail: {\n            payload: 'is here',\n        },\n    });</pre>\n<div class=\"admonition\">\n<div class=\"admonition-icon admonition-note-icon\"></div>\n<div class=\"admonition-content admonition-note-content\">\n<ul>\n<li>To propagate an event from Shadow DOM, you must set the <code>composed: true</code> option when you dispatch the event.</li>\n<li>For the event exchange boundary, your custom element of the custom widget should be used as the target to dispatch events (outbound) or listen to events (inbound). Don't use another event target or global object.</li>\n</ul>\n</div>\n</div>\n<h4>Supported outbound events from the custom widget:</h4>\n<table>\n<thead>\n<tr>\n<th scope=\"col\">Event Type</th>\n<th scope=\"col\">Payload</th>\n<th scope=\"col\">Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>visible</td>\n<td>data: {<br/>\n\t\t\t    visible: boolean<br/>\n\t\t\t}</td>\n<td>\n<p>Show or hide the widget component in DOM.</p>\n<p><strong>Note: </strong>The widget component still exists in the browser context and is not destroyed.</p>\n</td>\n</tr>\n<tr>\n<td>destroy</td>\n<td>null</td>\n<td>\n<p>Completely remove and destruct the widget component from DOM. A <code>disconnectcallback</code> will be triggered.</p>\n<p><strong>Note: </strong>This type is useful for some closable and one-time notification banner widget.</p>\n</td>\n</tr>\n</tbody>\n</table>\n<p><span style=\"color: rgb(0, 115, 231); font-family: Roboto, sans-serif; font-size: 24px;\">Use cases</span></p>\n<p>Here are some use case examples:</p>\n<h3>Embed a custom header with dropdown navigation</h3>\n<p>When you need to place a custom dropdown menu in the header bar that allows the user to navigate through the defined pages, you may refer to this example to create a simple Web Components.</p>\n<p>If you are a beginner for Web Components development or if you don't want to use the third-party libraries, this example also shows how to embed this function by a pure JavaScript source file without dependencies. You can always use the latest ECMAScript feature if your target users are using the major browsers with latest version.</p>\n<h4>Create a custom element</h4>\n<p>Firstly, create a custom element for your Web Components. To do this, you can create a class that extends from the HTMLElement public interface:</p>\n<pre>class CustomHeader extends HTMLElement {\n  constructor() {\n    super();\n  }\n}</pre>\n<h4>Design the widget</h4>\n<p>Now we can add all logical codes for the custom element inside this class. In this example, the standard <code>connectedCallback</code> function is used to render some HTML contents for the widget.</p>\n<p>This Header widget is simply designed with a logo image and a dropdown menu. The height of the header is set to 50 pixels. </p>\n<pre>class CustomHeader extends HTMLElement {\n  constructor() {\n    super();\n  }\n\n  connectedCallback() {\n    const ctn = document.createElement(\"div\");\n    ctn.style = \"height: 50px; width: 100%;box-sizing:border-box;\";\n\n    ctn.innerHTML = `\n      &lt;style&gt;\n        .header-wrapper {\n          width: 100%;\n          height: 100%;\n          background-color: #eee;\n          display: flex;\n          flex-direction: row;\n        }\n        .logo {\n          height: 30px;\n          width: 30px;\n          margin: 10px;\n        }\n        .header-menu &gt; ul, .header-menu &gt; li {\n          list-style: none;\n          padding-left: 0;\n          margin-top: 0;\n          margin-bottom: 0;\n        }\n        .header-menu {\n          margin-inline-start: 100px;\n          padding: 10px 20px;\n          line-height: 30px;\n          font-size: 20px;\n          font-weight: 700;\n          color: gray;\n          position: relative;\n          cursor: pointer;\n        }\n        .nav-submenu {\n          display: none;\n          position: absolute;\n          width: 220px;\n          background-color: inherit;\n          top: 50px;\n          left: 0;\n        }\n        .nav-submenu-item {\n          height: 40px;\n          padding-left: 20px;\n        }\n        .nav-submenu-item:hover {\n          background-color: rgb(118, 193, 255);\n        }\n\n        .nav-submenu-item &gt; a {\n          text-decoration: none;\n          line-height: 40px;\n          font-size: 16px;\n          color: #363636;\n        }\n        .header-menu:hover {\n          background-color: azure;\n        }\n        .header-menu:hover &gt; .nav-submenu {\n          display: block;\n        }\n      &lt;/style&gt;\n      &lt;div class=\"header-wrapper\"&gt;\n        &lt;img class=\"logo\" src=\"data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAA9CAYAAAAeYmHpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAAWdEVYdENyZWF0aW9uIFRpbWUAMTEvMjkvMTf0t1RCAAAApElEQVRoge3awQ3CMAxAURtlgW4EU9ERuhVMREdwV0iQ2iD+f2cf/CVfIiWrKnrluvcP/7Db7AVmMJrCaAqjKYymQEa3XPf77CWu1iLi1Ttc25In7vK10TcB8ryNpjCawmgKoymMpjCawmgKoymMpjCawmgKoymMpjCawmgKoymMpkBGZzw///Bx/TEy3M7a4kq1Le+ReeR5G01hNIXRFEZTIKMP8TARR8A0VeEAAAAASUVORK5CYII=\" /&gt;\n        &lt;div class=\"header-menu\"&gt;Menu\n          &lt;ul class=\"nav-submenu\"&gt;\n            &lt;li class=\"nav-submenu-item\"&gt;\n              &lt;a href=\"https://developer.mozilla.org/en-US/\"&gt;Web Design&lt;/a&gt;\n            &lt;/li&gt;\n            &lt;li class=\"nav-submenu-item\"&gt;\n              &lt;a href=\"https://developer.mozilla.org/en-US/\"&gt;Web Development&lt;/a&gt;\n            &lt;/li&gt;\n          &lt;/ul&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      `;\n\n    this.appendChild(ctn);\n  }\n}</pre>\n<h4>Name the custom element</h4>\n<p>In the last line, you need to define this class as a custom element with customElements.define API and name the custom element.</p>\n<p>In this example, the custom element is named as custom-header:</p>\n<pre>customElements.define(\"custom-header\", CustomHeader);</pre>\n<h4>Configure the widget and upload the source file</h4>\n<p>Save above contents to a JavaScript file. Then, configure the widget in Service Portal display theme settings and upload the source file.</p>\n<p>This custom header widget will be displayed as below:</p>\n<div id=\"_com_1\" language=\"JavaScript\" onmouseout=\"msoCommentHide('_com_1')\" onmouseover=\"msoCommentShow('_anchor_1','_com_1')\"><a class=\"image\" href=\"/file/images/5/50/widget_menu.png\" title=\"/file/images/5/50/widget_menu.png\"> <img alt=\"widget_menu\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/5/50/widget_menu.png\" height=\"283\" hspace=\"0\" src=\"../../../images/widget_menu_fe3040bc.png\" style=\"width: 800px; height: 283px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/> </a></div>\n<h3>Create components with Stencil</h3>\n<p>You may also use <a href=\"https://stenciljs.com/docs/getting-started\" title=\"Stencil\">Stencil</a> to generate your Web Components. The following example shows some tips on how to embed Web Components generated by Stencil.</p>\n<h4>Define Web Components</h4>\n<p>When you define your Web Components with Stencil, note that the <code>tag</code> name needs to be same with the CustomElement name in Service Portal widget configurations.<br/>\nIn the following example, the <code>tag</code> name is set as <code>bi-report</code>.</p>\n<p>Also note that you need to set the <code>shadow</code> option as <code>false</code> to disable using ShadowDOM inside the component. Because Service Portal will wrap the components in ShadowDOM or iframe according to the widget configurations.</p>\n<p><strong>Code example:</strong></p>\n<pre>@Component({\n  tag: 'bi-report',\n  styleUrl: 'bi-report.css',\n  shadow: false,\n})\nexport class MyReportComponent {\n  ...\n}</pre>\n<p><strong>CustomElement name configuration in Service Portal:</strong></p>\n<p><strong><a class=\"image\" href=\"/file/images/6/6b/Add_custom_widgets_ElementName.png\" title=\"/file/images/6/6b/Add_custom_widgets_ElementName.png\"> <img alt=\"Add_custom_widgets_ElementName\" border=\"0\" file=\"/mediawiki/images/6/6b/Add_custom_widgets_ElementName.png\" height=\"75\" hspace=\"0\" src=\"../../../images/Add_custom_widgets_ElementName_fb788e18.png\" style=\"width:252px;height:75px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\" width=\"252\"/> </a> </strong></p>\n<p><b>Widget configurations for encapsulation:</b></p>\n<div><a class=\"image\" href=\"/file/images/b/b5/Add_custom_widgets_encapsulation.png\" title=\"/file/images/b/b5/Add_custom_widgets_encapsulation.png\"> <img alt=\"Add_custom_widgets_encapsulation\" border=\"0\" file=\"/mediawiki/images/b/b5/Add_custom_widgets_encapsulation.png\" height=\"69\" hspace=\"0\" src=\"../../../images/Add_custom_widgets_encapsulation_3da35e0b.png\" style=\"width:260px;height:69px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\" width=\"260\"/> </a></div>\n<h4>Design the widget</h4>\n<p>In this example, we use Stencil to define a Full page widget, which is functionally same with the HTML use case: <a href=\"/doc/423/26.1/htmlcustomwidget#Embed_web_pages_%E2%80%94_Power_BI_report\" title=\"Embed web pages — Power BI report\">Embed web pages — Power BI report</a>.</p>\n<pre>  render() {\n    return (\n      &lt;div&gt;\n        &lt;h4&gt;\n          Open in Power BI:\n          &lt;a href=\"https://app.powerbi.com/view?r=eyJrIjoiZWUxNT.......\"&gt;\n            Customer Profitability Sample PBIX\n          &lt;/a&gt;\n        &lt;/h4&gt;\n        &lt;iframe title=\"Customer Profitability Sample PBIX\"\n          width=\"100%\" height=\"636\" src=\"https://app.powerbi.com/reportEmbed?reportId=xxxxxxxx-xxxx-xxxx-xxxx&amp;autoAuth=true&amp;ctid=xxxxxxxx-xxxx-xxxx-xxxx&amp;config=eyJjb....\"&gt;&lt;/iframe&gt;\n      &lt;/div&gt;\n    );\n  }</pre>\n<h4>Generate the source file</h4>\n<p>Because the Stencil builder don't have a bundled option, the final component will be generated in separate JavaScript files. So, we need to further bundle and minify these files for production.<br/>\nTo do this, you can run a <code>npm run build:prod</code> command to get a bundled JavaScript file under the <code>dist</code> folder. For the given example, it will be the <code>bi-report.bundle.js</code> file.</p>\n<h4 id=\"Preview_the_embedded_page\">Preview the embedded widget</h4>\n<p>Now you can configure this component and upload the source file to Service Portal for preview:</p>\n<div><a class=\"image\" href=\"/file/images/8/86/Add_custom_widgets_BIStencil.png\" title=\"/file/images/8/86/Add_custom_widgets_BIStencil.png\"> <img alt=\"Add_custom_widgets_BIStencil\" border=\"0\" file=\"/mediawiki/images/8/86/Add_custom_widgets_BIStencil.png\" height=\"423\" hspace=\"0\" src=\"../../../images/Add_custom_widgets_BIStencil_72bfc25e.png\" style=\"width: 800px; height: 423px; margin: 0px; border: 0px solid black;\" vspace=\"0\" width=\"800\"/> </a></div>\n<p class=\"mw-empty-elt\"></p></div>\n<p class=\"mw-empty-elt\"></p></div>",
  "modifiedon": "2025-10-24 08:51:12"
}