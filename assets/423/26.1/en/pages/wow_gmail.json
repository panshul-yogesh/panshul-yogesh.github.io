{
  "title": "OPB based Gmail Integration",
  "content": "<div class=\"mw-parser-output\">\n<h2 id=\"Introduction\"><a id=\"Introduction\" name=\"Introduction\" title=\"Introduction\"></a>Introduction</h2>\n<p>Service Management provides an email integration that may be used to request appropriate knowledge articles, create requests, add comments, and accept solutions to existing requests. The email integration uses the On-Premises Bridge to connect to an external inbox to process incoming emails. This document describes how to configure Gmail as the external inbox to use with the Service Management email integration.</p>\n<p>This chapter will include:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Configuring the Gmail account</li><li style=\"margin-left: 28px; position: relative;\">Determining where to install the On-Premises Bridge (OPB)</li><li style=\"margin-left: 28px; position: relative;\">Downloading the OPB configuration file</li><li style=\"margin-left: 28px; position: relative;\">Downloading the OPB installation binary</li><li style=\"margin-left: 28px; position: relative;\">Installing the OPB</li><li style=\"margin-left: 28px; position: relative;\">Adding the Gmail addresses email integration credentials to the OPB</li><li style=\"margin-left: 28px; position: relative;\">Creating and configuring the email integration endpoint on Service Management</li><li style=\"margin-left: 28px; position: relative;\">Troubleshooting issues</li></ul>\n<h2 id=\"Configuring_the_Gmail_account\"><a id=\"Configuring_the_Gmail_account\" name=\"Configuring_the_Gmail_account\" title=\"Configuring the Gmail account\"></a>Configuring the Gmail account</h2>\n<p>The Service Management email integration uses <a href=\"https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol\" target=\"1\" title=\"IMAP\">IMAP</a> to communicate with the remote email server. By default, Gmail disables the ability to connect using IMAP, so IMAP must be enabled in the Gmail account settings. To enable IMAP, access the Gmail settings and select the Forwarding and POP/IMAP menu. Select the Enable IMAP Button and then save the settings.</p>\n<p><a class=\"image\" href=\"\"> <img alt=\"Gmail Image1.png\" src=\"../../../images/Gmail_Image1_3e95beee.png\"/> </a>  </p>\n<p>The IMAP protocol allows Service Management to move emails from the inbox to other folders once they have been processed. By default, emails successfully processed are moved into a folder named ‘Processed’, while emails that have an issue with being processed are moved into a folder named ‘Errors.’ These folders must be created in Gmail and will appear in the list of folders. Once the folders are created and IMAP is enabled, the configuration of the Gmail account is complete. ￼</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Gmail Image2.png\" src=\"../../../images/Gmail_Image2_96eda657.png\"/> </a></div>\n<h2 id=\"Determining_where_to_install_the_OPB\"><a id=\"Determining_where_to_install_the_OPB\" name=\"Determining_where_to_install_the_OPB\" title=\"Determining where to install the OPB\"></a>Determining where to install the OPB</h2>\n<p>The On-Premises Bridge must be installed on a machine that has access to both the Gmail server and the Service Management tenant at all times. We recommend against installing the agent on laptops or machines that are not actively maintained for consistent uptime. The firewall on the machine must allow the agent to connect to ports 993 and 465 (the default Gmail IMAP and SMTP ports). If there are connection issues, open a command window and try to telnet into the ports. If this is not possible, the integration will not be possible from this machine. The primary cause of the ports not appearing open is a firewall between the OPB machine and the Internet.</p>\n<p><a class=\"image\" href=\"\"> <img alt=\"Gmail Image3.png\" src=\"../../../images/Gmail_Image3_681bb3bb.png\"/> </a> <a class=\"image\" href=\"\"> <img alt=\"Gmail Image4.png\" src=\"../../../images/Gmail_Image4_578e4663.png\"/> </a></p>\n<h2 id=\"￼￼_Downloading_the_OPB_configuration_file\"><a id=\"Downloading_the_OPB_configuration_file\" name=\"Downloading_the_OPB_configuration_file\" title=\"Downloading the OPB configuration file\"></a>Downloading the OPB configuration file</h2>\n<p>There are two steps to installing the On-Premises Bridge. First, download the OPB connection file. Second, download the installation binary (covered in the next section). To download the OPB connection file, open the Service Management UI and then navigate to <strong>Admin-&gt; integration-&gt;Agents</strong>. Click on the ‘Add agent’ button to launch the new agent form. Enter a name for the agent and then click on the ‘Download Connection File’ button. Once clicked, a file with the information on how to connect to this specific tenant will be downloaded. The connection file is unique per tenant and has information including the agent name, tenant number, and farm location. After downloading the file, it will need to be copied to the machine where the OPB will be installed. The configuration file is named <strong>server-connection.conf</strong>.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"OT_Email_integration1\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/d/d5/OT_Email_integration1.png\" hspace=\"0\" src=\"../../../images/OT_Email_integration1_ab261364.png\" style=\"width: 800px; height: 301px; margin: 0px; border: 0px solid black;\" vspace=\"0\"/> </a></div>\n<h2 id=\"Downloading_the_OPB_installation_binary\"><a id=\"Downloading_the_OPB_installation_binary\" name=\"Downloading_the_OPB_installation_binary\" title=\"Downloading the OPB installation binary\"></a>Downloading the OPB installation binary</h2>\n<p>The On-Premises Bridge agent installation is available for download from the Service Management UI on the <strong>Admin -&gt; Integration Management -&gt; Agents</strong> page. Then click on the ‘Download agent’ button. The agent is ~300mb in size and may require several minutes to download. The file is named <strong>opb-installation.exe</strong>. </p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Email_integration2\" border=\"0\" file=\"/mediawiki/images/8/85/Email_integration2.png\" hspace=\"0\" src=\"../../../images/Email_integration2_5c820818.png\" style=\"width: 800px; height: 261px;\" vspace=\"0\"/> </a></div>\n<h2 id=\"Installing_the_OPB\"><a id=\"Installing_the_OPB\" name=\"Installing_the_OPB\" title=\"Installing the OPB\"></a>Installing the OPB</h2>\n<p>Copy the installation binary downloaded previously to the machine that it will be installed on and double-click to launch and click <strong>ok</strong> to proceed.</p>\n<p>The username and password in the ‘Setup authentication’ form is the account used to login to Service Management. The username combined with the OPB configuration file tells the agent how to connect to the Service Management tenant. Enter the authentication information and click next.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Snipaste_2023-04-18_16-21-10\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/d/df/Snipaste_2023-04-18_16-21-10.png\" hspace=\"0\" src=\"../../../images/Snipaste_2023-04-18_16-21-10_50522973.png\" style=\"width: 800px; height: 565px; margin: 0px; border: 0px solid black;\" vspace=\"0\"/> </a></div>\n<p>Click the install button to initiate the installation.</p>\n<p>After the installation portion has completed you will need to complete the configuration of the agent by copying the ‘<strong>server-connection.conf</strong>’ file downloaded in the previous step to the conf folder of the OPB (by default located in the <code>C:\\Program Files\\Micro Focus\\On-Premises Bridge Agent\\product\\conf</code> directory).</p>\n<p>Import the Service Management certificate into the On-Premises Bridge's trusted certificates. This must be done to successfully connect.</p>\n<p>For details, see <a href=\"/doc/423/26.1/opbinstall#How_to_import_the_suite_CA_certificate_to_the_OPB_trusted_keystore\" title=\"How to import the suite CA certificate to the OPB trusted keystore\">How to import the suite CA certificate to the OPB trusted keystore</a></p>\n<p>Once the certificate is imported and the ‘<strong>server-connection.conf</strong>’ has been copied, start the On-Premises Bridge service (this service is not started by default after the installation).</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Gmail Image10.png\" src=\"../../../images/Gmail_Image10_690cd574.png\"/> </a></div>\n<p>Once started, confirm that the agent has been configured correctly by bringing up the Service Management Integration page and clicking on the agent just created. Confirm that the status is ‘Success’. If it did not connect successfully, try restarting the agent. If restarting does not correct the issue, consult the controller log located in the <code><em>C:\\Program Files\\Micro Focus\\On-Premises Bridge Agent\\product\\log\\controller</em></code> directory for more information on connection issues.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Email_integration5\" border=\"0\" file=\"/mediawiki/images/7/7a/Email_integration5.png\" hspace=\"0\" src=\"../../../images/Email_integration5_30cd2936.png\" style=\"width: 800px; height: 293px;\" vspace=\"0\"/> </a></div>\n<h2 id=\"Adding_the_email_integration_credentials_to_the_OPB\"><a id=\"Adding_the_email_integration_credentials_to_the_OPB\" name=\"Adding_the_email_integration_credentials_to_the_OPB\" title=\"Adding the email integration credentials to the OPB\"></a>Adding the email integration credentials to the OPB</h2>\n<p>After installing the agent, you must add the email integration credentials to the OPB so that the agent can connect to the Gmail account. This is done using the ‘Endpoint credentials manager’ of the OPB, available in the start menu.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Email_integration6\" border=\"0\" file=\"/mediawiki/images/a/a7/Email_integration6.png\" hspace=\"0\" src=\"../../../images/Email_integration6_4a051332.png\" style=\"width: 400px; height: 664px;\" vspace=\"0\"/> </a></div>\n<p>When the credentials manager opens, click the ‘New’ button and select the 'OPB email integration domain' option from the list and click OK. </p>\n<div><a class=\"image\" href=\"\"> <img alt=\"EndPoint_cre_manger_upd\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/6/64/EndPoint_cre_manger_upd.png\" hspace=\"0\" src=\"../../../images/EndPoint_cre_manger_upd_77880a27.png\" style=\"width: 800px; height: 499px; margin: 0px; border: 0px solid black;\" vspace=\"0\"/> </a></div>\n<p>Add a name which will appear in Service Management UI when you add the email integration endpoint. Then add the email address and password used to login to the Gmail account (Gmail configured in an earlier step).</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Email_integration8_new\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/9/90/Email_integration8_new.png\" hspace=\"0\" src=\"../../../images/Email_integration8_new_6159b8fd.png\" style=\"width: 800px; height: 480px; margin: 0px; border: 0px solid black;\" vspace=\"0\"/> </a></div>\n<h2 id=\"Creating_and_configuring_the_email_integration_endpoint\"><a id=\"Creating_and_configuring_the_email_integration_endpoint\" name=\"Creating_and_configuring_the_email_integration_endpoint\" title=\"Creating and configuring the email integration endpoint\"></a>Creating and configuring the email integration endpoint</h2>\n<p>Once the credentials have been added to the OPB, you need to add the email integration endpoint through the Service Management UI. Navigate to the <strong>Admin -&gt; Integration -&gt; Endpoints</strong> page. Click ‘Add’ and select ‘email integration’ as the endpoint type and provide a name. The ‘Running on agent’ dropdown should contain the ‘email integration agent’ added earlier. Select it and then click ‘Add’. </p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Email_integration9_new\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/0/02/Email_integration9_new.png\" hspace=\"0\" src=\"../../../images/Email_integration9_new_88dd62a5.png\" style=\"width: 800px; height: 256px; margin: 0px; border: 0px solid black;\" vspace=\"0\"/> </a></div>\n<p>Once added, click the ‘Configure’ button to add the connection details for the Gmail server. The Gmail IMAP server address is <strong>imap.gmail.com</strong> and the smtp server is <strong>smtp.gmail.com</strong>. The recommended protocol to use is IMAPS. The Credentials dropdown should show the Gmail credentials added to the OPB in an earlier step.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Gmail Image16.png\" src=\"../../../images/Gmail_Image16_fdb0bdfe.png\"/> </a></div>\n<p>Any proxy configuration is performed in the ‘Advanced’ connection configuration section of the form. There is no specific customization needed when using Gmail, as it uses the default ports. If using a different email server with non-default ports, the values on this form may need modification.</p>\n<p>Only authorized email addresses can create requests in Service Management using the email integration. If the domain of the sending email address is not in the authorized domain list, the email will not be accepted. The same is true for email accounts that do not belong to a valid user in Service Management. Even when the domain is added to the authorized domain, the email address must be associated to a valid user for a request to be created. You must add any domains that will be sending emails to the authorized domains.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Snipaste_2023-04-17_17-41-14\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/7/7a/Snipaste_2023-04-17_17-41-14.png\" hspace=\"0\" src=\"../../../images/Snipaste_2023-04-17_17-41-14_52f28b9f.png\" style=\"width: 800px; height: 422px; margin: 0px; border: 0px solid black;\" vspace=\"0\"/> </a></div>\n<div><a class=\"image\" href=\"\"> <img alt=\"Email_integration12\" border=\"0\" file=\"/mediawiki/images/0/05/Email_integration12.png\" hspace=\"0\" src=\"../../../images/Email_integration12_6c5a189d.png\" style=\"width: 800px; height: 351px;\" vspace=\"0\"/> </a></div>\n<p>The actions Service Management will take when emails arrive in the Gmail inbox is defined in the configuration section. If the ‘New email action’ is set to ‘Create Request’, then a new request will be created.</p>\n<p>The inbox polling time is by default one minute but can be increased to any desired frequency. By default, the two Gmail folders created earlier are assumed to be named ‘Processed’ and ‘Errors’. If different folder names are desired, they may be defined here.</p>\n<p>It is possible to set a default offering on this form for all requests submitted through the email integration. If this dropdown is left blank, then no offering will be applied. However, the default can be assigned by selecting a value from the list. </p>\n<p>Enable the ability for users to create requests and other actions using email in the feature settings configuration. If contacts need the ability to add requests, an agent must be assigned in the Email integration agent selection. The agent will appear as the Requested By value in the requests.  </p>\n<div><a class=\"image\" href=\"\"> <img alt=\"202305Email_integration15\" border=\"0\" file=\"https://staging.docs.microfocus.com/mediawiki/images/6/60/202305Email_integration15.png\" hspace=\"0\" src=\"../../../images/202305Email_integration15_c78c62d8.png\" style=\"width: 800px; height: 416px; margin: 0px; border: 0px solid black;\" vspace=\"0\"/> </a></div>\n<p>The integration should now be functioning and can be confirmed by looking at the endpoint status.</p>\n<div><a class=\"image\" href=\"\"> <img alt=\"Email_integration14\" border=\"0\" file=\"/mediawiki/images/a/ac/Email_integration14.png\" hspace=\"0\" src=\"../../../images/Email_integration14_ef038575.png\" style=\"width: 800px; height: 175px;\" vspace=\"0\"/> </a></div>\n<p>The most common issues causing the task to fail:</p>\n<ul style=\"padding-left: 0px;\"><li style=\"margin-left: 28px; position: relative;\">Incorrect login and password for the Gmail account.</li><li style=\"margin-left: 28px; position: relative;\">The IMAP settings are not configured on the email account.</li><li style=\"margin-left: 28px; position: relative;\">The less secure app setting is not enabled.</li><li style=\"margin-left: 28px; position: relative;\">The On-Premises Bridge agent is not running.</li></ul>\n<h2 id=\"Troubleshooting\"><a id=\"Troubleshooting\" name=\"Troubleshooting\" title=\"Troubleshooting\"></a>Troubleshooting</h2>\n<p>The OPB logs are in the <code><em>C:\\Program Files\\Micro Focus\\On-Premises Bridge Agent\\product\\log</em></code> directory. This directory should contain a controller folder and an email-integration-domain folder. To make sure that the agent is running, look in the controller folder for the <strong>controller.log</strong> file. Look through the log for any errors -- most likely they will be related to a login and password not working.</p>\n<p>If the agent is running, look in the email integration folder for the <strong>email-integration-domain.log.x.x</strong> file. Look for the most recent file for any errors. There may be errors indicating that the Gmail account login or password is incorrect. There may also be errors indicating that the inbox cannot be found, which may indicate that the firewall is blocking a port.</p>\n<p>If the integration still doesn’t work, contact the Service Management Support team and create a ticket. Be sure that the OPB log and configuration files are included in the ticket.</p>\n</div>",
  "modifiedon": "2025-12-04 19:11:43"
}