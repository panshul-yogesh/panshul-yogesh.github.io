{
  "title": "Listener",
  "content": "<div class=\"mw-parser-output\">\n<p>Listeners provide a mechanism to trigger integration scenarios from external systems. For each listener-enabled scenario, the Integration Studio exposes a webhook URL for external systems to call, and constantly listens for requests sent to the webhook URL. Once a request is received at the URL, the Integration Studio will authenticate the user data contained in the request, and if the authentication and various validations pass, execute the scenario.</p>\n<h2><a id=\"Set_up_the_listener\" name=\"Set_up_the_listener\" title=\"Set up the listener\"></a>Set up the listener</h2>\n<h3><a id=\"What_external_systems_can_use_listeners\" name=\"What_external_systems_can_use_listeners\" title=\"What external systems can use listeners\"></a>What external systems can use listeners</h3>\n<p>To use listeners, the external system must have a mechanism (usually called webhook or callback) to push messages to a specified URL when certain events occur. The messages the external system sends must satisfy the following conditions:</p>\n<ul>\n<li>The messages must be sent with the HTTP POST method.</li>\n<li>The HTTP request must contain a <strong>content-type</strong> header with one of the following values:\n\t<ul>\n<li><strong>application/json:</strong> For sending data in JSON format.</li>\n<li><strong>application/x-www-form-urlencoded:</strong> For sending sending form data such as key-value pairs.</li>\n<li><strong>text/plain</strong>:<strong> </strong>For sending plain text such as text files.</li>\n</ul>\n</li>\n</ul>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>The maximum payload size that can be accepted by the listener is 100 MB.</div></div></div>\n<h3><a id=\"Configure_the_listener\" name=\"Configure_the_listener\" title=\"Configure the listener\"></a>Configure the listener</h3>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>You can enable the listener for a scenario only when you create the scenario, and cannot convert a normal scenario to a listener-based scenario.</div></div></div>\n<p>Configure a listener by adding a listener-based scenario. To do this, complete the following steps:</p>\n<ol>\n<li>Click <strong>Administration</strong> &gt; <strong>Utilities</strong> &gt; <strong>Integration</strong> &gt; <strong>Integration Studio</strong>.</li>\n<li>In the left pane, select the integration where you want to add the listener-based scenario.</li>\n<li>Click <strong>Add scenario</strong>, enter a name, select a template if available, select the scenario mode, select <strong>Enable Listener</strong>, and then click <strong>Save</strong>. </li>\n<li>In the <strong>Listener </strong>section of the scenario page, from the <strong>Authentication type</strong> list, choose one of the following methods based on external system's webhook authentication method: \n\t<ul>\n<li><strong>Basic Auth</strong>: Choose this option if the external system's webhook uses basic authentication method. In this method, the external system includes the Service Management integration user's credentials in the Authorization header of each message sent to the webhook URL. You must configure both the user credentials and the webhook URL separately in the webhook settings.</li>\n<li><strong>URL <span id=\"cke_bm_136787C\" style=\"display: none;\"> </span>Token: </strong>Choose this option<strong> </strong>if the external system uses a token-based authentication method. In this case, the webhook URL is a concatenation of the base webhook URL and the encrypted user credentials. You must configure only the URL in the <strong>Webhook URL</strong> field.\n\t\t<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>If the webhook uses an authentication method other than basic authentication, Integration Studio will still authenticate the user using the credentials embedded in the webhook URL. Any credentials or tokens sent in the header or payload will be ignored for authentication purposes.</div></div></div>\n</li>\n</ul>\n</li>\n<li>\n<p>Generate the information required by the external system's webhook:</p>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>Make sure the integration user has the <strong>OPB Remote Agent</strong> role or a custom role with the <strong>On-Premise Bridge/Integration Administrator</strong> permission.</div></div></div>\n<ol>\n<li>\n<p>If you choose the <strong>Basic Auth</strong> as the authentication type, complete the following steps to generate the token:</p>\n<ol>\n<li>Click the <strong>Generate </strong>icon( <a class=\"image\" href=\"\"> <img alt=\"GenerateIcon.png\" border=\"0\" file=\"/mediawiki/images/e/e4/GenerateIcon.png\" hspace=\"0\" src=\"../../../images/GenerateIcon_4b8c62f9.png\" style=\"width:26px;height:28px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a> ) next to the <strong>API token</strong> field. This generates both the Webhook URL and the API token.</li>\n<li>Enter the following information and click <strong>Generate</strong>.\n\t\t\t<ul>\n<li><strong>User principle name</strong>: This refers to Service Management integration user. Make sure this user has the <strong>OPB Remote Agent</strong> role or a custom role with the <strong>On-Premise Bridge/Integration Administrator</strong> permission.</li>\n<li><strong>Password</strong>: The integration user's password.</li>\n<li><strong>Expiration (Days)</strong>:<strong> </strong>This refers to the duration for which a token remains valid. It can range from <strong>1 to 365 days.</strong> Choose an expiration duration that suits your workflow. \n\t\t\t\t<div class=\"admonition\"><div class=\"admonition-icon admonition-important-icon\"></div><div class=\"admonition-content admonition-important-content\"><div>You must regenerate any existing tokens if they do not have an expiry. Tokens without expiry may increase the risk of unauthorized access. For instructions, see the section on <em>Regenerate an expired token</em><strong>.</strong></div></div></div>\n</li>\n</ul>\n</li>\n<li>Click the <strong>Copy </strong>icon ( <a class=\"image\" href=\"\"> <img alt=\"CopyIcon2.png\" border=\"0\" file=\"/mediawiki/images/0/03/CopyIcon2.png\" hspace=\"0\" src=\"../../../images/CopyIcon2_8ed53497.png\" style=\"width:27px;height:27px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a> ) next to the Webhook URL field to copy the URL to the clipboard and paste the URL to a text editor.</li>\n<li>Click the <strong>Copy</strong> ( <a class=\"image\" href=\"\"> <img alt=\"CopyIcon2.png\" border=\"0\" file=\"/mediawiki/images/0/03/CopyIcon2.png\" hspace=\"0\" src=\"../../../images/CopyIcon2_8ed53497.png\" style=\"width:27px;height:27px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a> ) icon next to the API token field to copy the token and paste the token to a text editor. You will need this token to populate the password field when setting up Basic Authentication for the webhook in the external system. </li>\n</ol>\n</li>\n<li>If you choose the <strong>URL Token</strong> as the authentication type, complete the following steps to generate the token:\n\t\t<ol>\n<li>Click the <strong>Generate </strong>icon<strong> </strong>( <a class=\"image\" href=\"\"> <img alt=\"GenerateIcon.png\" border=\"0\" file=\"/mediawiki/images/e/e4/GenerateIcon.png\" hspace=\"0\" src=\"../../../images/GenerateIcon_4b8c62f9.png\" style=\"width:26px;height:28px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a> ) next to the <strong>Webhook URL</strong> field.</li>\n<li>Enter the following information and click <strong>Generate</strong>. The Webhook URL field is automatically populated with the generated URL.</li>\n</ol>\n<ul style=\"margin-left: 40px;\">\n<li><strong>User principle name</strong>: This refers to Service Management integration user. Make sure this user has the <strong>OPB Remote Agent</strong> role or a custom role with the <strong>On-Premise Bridge/Integration Administrator</strong> permission.</li>\n<li><strong>Password</strong>: The integration user's password.</li>\n<li><strong>Expiration (Days)</strong>:<strong> </strong>This refers to the duration for which a token remains valid. It can range from <strong>1 to 365 days. </strong>Choose an expiration duration that suits your workflow.\n\t\t\t<div class=\"admonition\"><div class=\"admonition-icon admonition-important-icon\"></div><div class=\"admonition-content admonition-important-content\"><div>To ensure a secure deployment, we strogly recommend that you regenerate any existing tokens if they do not have an expiry. For instructions, see the section on <em>Regenerate an expired token</em><strong>.</strong></div></div></div>\n</li>\n</ul>\n<ol>\n<li>Click the <strong>Copy </strong>icon ( <a class=\"image\" href=\"\"> <img alt=\"CopyIcon2.png\" border=\"0\" file=\"/mediawiki/images/0/03/CopyIcon2.png\" hspace=\"0\" src=\"../../../images/CopyIcon2_8ed53497.png\" style=\"width:27px;height:27px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a> ) next to the <strong>API token</strong> field to copy the token. Save it in a file for later use - you will need it to fill in the password field when setting up Basic Authentication for the webhook in the external system.</li>\n</ol>\n</li>\n</ol>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>The webhook URL currently does not support custom domains. It uses the external access host name of the suite even if you have configured a custom domain for the tenant.</div></div></div>\n</li>\n<li>After configuring the rest of the scenario, click <strong>Save </strong>to apply your changes.</li>\n</ol>\n<h4><a id=\"Configure_token_expiration_reminder\" name=\"Configure_token_expiration_reminder\" title=\"Configure token expiration reminder\"></a>Configure token expiration reminder</h4>\n<p>Optionally, you can enable Integration Studio to automatically send token expiration reminder emails. Complete the following steps to enable the reminder:</p>\n<ol style=\"margin-left: 40px;\">\n<li>\n<p>Select the <strong>Enable email notification for token expiration</strong> check box.</p>\n</li>\n<li>\n<p>Enter the email addresses of email recipients separated by semicolons. The specified users will receive daily notification emails starting 7 days before the token expires.  The notification emails are based on the <strong>Listener token expiration notification for Integration Studio</strong> template. </p>\n</li>\n</ol>\n<p>To verify that email notifications are working correctly, click the <strong>Send Test Email</strong> icon ( <a class=\"image\" href=\"\"> <img alt=\"SendEmailIcon.png\" border=\"0\" file=\"/mediawiki/images/c/cd/SendEmailIcon.png\" hspace=\"0\" src=\"../../../images/SendEmailIcon_78e4621e.png\" style=\"width:27px;height:26px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a> ) to immediately send a test message to the specified users.</p>\n<h4><a id=\"Delete_a_token\" name=\"Delete_a_token\" title=\"Delete a token\"></a>Delete a token</h4>\n<p>To delete a token, click the <strong>Delete </strong>icon ( <a class=\"image\" href=\"\"> <img alt=\"DeleteToken.JPG\" border=\"0\" file=\"/mediawiki/images/a/a0/DeleteToken.JPG\" hspace=\"0\" src=\"../../../images/DeleteToken_1a5ec33b.jpeg\" style=\"width: 27px; height: 27px;\" vspace=\"0\"/> </a> ). Deleting a token will automatically deactivate its email notification.</p>\n<h4><a id=\"Regenerate_an_expired_token\" name=\"Regenerate_an_expired_token\" title=\"Regenerate an expired token\"></a>Regenerate an expired token</h4>\n<p>To regenerate an expired token, Click the <strong>Generate </strong>icon<strong> </strong>( <a class=\"image\" href=\"\"> <img alt=\"GenerateIcon.png\" border=\"0\" file=\"/mediawiki/images/e/e4/GenerateIcon.png\" hspace=\"0\" src=\"../../../images/GenerateIcon_4b8c62f9.png\" style=\"width:26px;height:28px;margin-top:0px;margin-bottom:0px;margin-left:0px;margin-right:0px;border:0px solid black;\" vspace=\"0\"/> </a> ). Make sure you update the following webhook configuration in the external system:</p>\n<ul>\n<li>\n<p>For <strong>URL Token listeners</strong>, update the <strong>webhook URL</strong>.</p>\n</li>\n<li>For <strong>Basic Auth listeners</strong>, update both the <strong>webhook URL</strong> and the <strong>API token</strong>.</li>\n</ul>\n<h3><a id=\"Verify_the_listener_configuration\" name=\"Verify_the_listener_configuration\" title=\"Verify the listener configuration\"></a>Verify the listener configuration</h3>\n<p>You can quickly verify that the listener works without configuring webhooks in the external system. You can do this by using the following curl commands:</p>\n<ul>\n<li>\n<p>For URL Token listeners:</p>\n<pre>curl --location --request POST '&lt;webhook URL&gt;' \\\n--header 'content-type: application/json'\n</pre>\n<p>Where <strong>&lt;webhook URL&gt;</strong> is the URL you copied on the listener configuration UI.</p>\n</li>\n<li>\n<p>For Basic Auth listeners:</p>\n<pre>curl --location --request POST '&lt;webhook URL&gt;' \\\n--header 'content-type: application/json' \\\n--header 'Authorization: Basic &lt;token&gt;'\n</pre>\n<p>Where <strong>&lt;webhook URL&gt;</strong> is the URL you copied on the listener configuration UI, and <strong>&lt;token&gt;</strong> is the base64-encoded <strong>&lt;UPN of integration user&gt;:&lt;API token copied from listener UI&gt;</strong>.</p>\n</li>\n</ul>\n<h2><a id=\"Configure_webhooks_in_external_systems_to_trigger_listener-based_scenarios\" name=\"Configure_webhooks_in_external_systems_to_trigger_listener-based_scenarios\" title=\"Configure webhooks in external systems to trigger listener-based scenarios\"></a>Configure webhooks in external systems to trigger listener-based scenarios</h2>\n<p>After you configure a listener, configure a webhook in the external system to trigger the scenario associated with the listener. Enter the information you copied during the listener configuration step to the webhook configuration UI.</p>\n<h3><a id=\"Webhook_with_URL_token_example_-_Jira_webhook_configuration\" name=\"Webhook_with_URL_token_example_-_Jira_webhook_configuration\" title=\"Webhook with URL token example - Jira webhook configuration\"></a>Webhook with URL token example - Jira webhook configuration</h3>\n<p>Suppose you are setting up an integration with Jira, and you need Jira to trigger an integration scenario \"Update Jira issue status\" when the status of any Jira issue that was created by another integration scenario \"Defect tracking\" changes to \"Done\". Suppose in the \"Defect tracking\" scenario, you set a label \"From Service Management\" in Jira when creating issues in Jira to identify issues originated from Service Management.</p>\n<p>To achieve this result, configure a webhook in Jira as follows: </p>\n<ol>\n<li>Go to Jira administration console &gt; <strong>System</strong> &gt; <strong>Webhooks</strong> (in the Advanced section).</li>\n<li>Click <strong>Create a Webhook</strong> in the right upper corner.</li>\n<li>Enter the details for the new webhook.\n\t<ol>\n<li>In the URL field, enter the webhook URL you copied when configuring the listener for the \"Update Jira issue status\" scenario.</li>\n<li>\n<p>In the JQL query field, enter this query:</p>\n<pre>label = \"From SMAX\"</pre>\n</li>\n<li>In the Issue related events section, select <strong>updated</strong> under Issue.</li>\n</ol>\n</li>\n<li>Click <strong>Create</strong>.</li>\n</ol>\n<p>Next, you need to configure your Jira workflow to add a post function for the transition from \"In Progress\" to \"Done\" to trigger the webhook.  Also, remember to update the transition's default \"Fire event\" post function to fire an \"Issue updated\" event instead of a generic event. For details, see the <a href=\"https://developer.atlassian.com/server/jira/platform/webhooks/\" title=\"Jira webhook documentation\">Jira webhook documentation</a>.</p>\n<h3><a id=\"Webhook_with_basic_authentication_example_-_Octane_webhook_configuration\" name=\"Webhook_with_basic_authentication_example_-_Octane_webhook_configuration\" title=\"Webhook with basic authentication example - Octane webhook configuration\"></a>Webhook with basic authentication example - Octane webhook configuration</h3>\n<p>Suppose you are setting up an integration with Octane, and you need Octane to trigger an integration scenario \"Update Octane issue status\" when the status of any Octane issue that was created by another integration scenario \"Defect tracking\" changes to \"Fixed\". Suppose in the \"Defect tracking\" scenario, you set a tag \"From Service Management\" in Octane when creating issues in Octane to identify issues originated from Octane.</p>\n<p>To achieve this result, first configure a credential.</p>\n<ol>\n<li>In <b>Settings (the gear icon)</b><b> </b><b>&gt;</b> <b>Spaces</b>, select the space or the workspace.</li>\n<li>\n<p>In the <b>Credentials</b> tab, click <b>+</b>.</p>\n</li>\n<li>\n<p>Enter the details on the Add Credentials form.</p>\n<ol>\n<li>\n<p>Enter a name for the credential.</p>\n</li>\n<li>\n<p>In the User Name field, enter the UPN of the Service Management integration user used to generate the API Token in the listener.</p>\n</li>\n<li>\n<p>In the Password field, paste the API token you copied when configuring the listener (with the Basic Auth authentication type) for the \"Update Octane issue status\" scenario.</p>\n</li>\n<li>\n<p>Click <strong>Add</strong>.</p>\n</li>\n</ol>\n</li>\n</ol>\n<p>Then configure a webhook in Octane as follows:</p>\n<ol>\n<li>In <b>Settings (the gear icon)</b><b> &gt;</b> <b>Spaces</b>, select the space or the workspace.</li>\n<li>Select the Entities tab.</li>\n<li>Select the Defect entity, and then click <strong>+</strong> in the Rules tab.</li>\n<li>Enter the details for the rule.\n\t<ol>\n<li>In the Action field, select <b>Trigger webhook</b>.</li>\n<li>Select <strong>Update</strong> for Submission mode.</li>\n<li>Leave the Communication method field with the default (Webhook).</li>\n<li>In the URL field, paste the webhook URL you copied when configuring the listener.</li>\n<li>In the Credentials field, select the credentials you created above.</li>\n<li>\n<p>Go to the Condition tab, and add the following conditions:</p>\n<pre>\"Phase\" is modified <b>AND</b> \"Phase\" = Fixed <strong>AND</strong> \"Tags\" contains \"From SMAX\"</pre>\n</li>\n</ol>\n</li>\n<li>\n<p>Click <strong>OK</strong>.</p>\n</li>\n</ol>\n<h2><a id=\"Use_payload_data_sent_by_the_external_system_in_scenario_rules\" name=\"Use_payload_data_sent_by_the_external_system_in_scenario_rules\" title=\"Use payload data sent by the external system in scenario rules\"></a>Use payload data sent by the external system in scenario rules</h2>\n<p>In a listener-based scenario, you can use the data in the payload of the messages sent to the listener's webhook URL in the scenario's rules. To do this, enter this in the Value field for the key where you want to use a property in the external system's payload data:</p>\n<pre>payload.data.&lt;path to the property&gt;</pre>\n<p>where the path to the property varies with the content-type of the message:</p>\n<ul>\n<li>For <strong>application/json</strong>, it is a series of keys separated by the period symbol (such as <strong>key1.key2.key3</strong>), depending on where the property is located in the JSON data structure. For example, to assign the value of the <strong>name </strong>property at the root of the JSON payload sent to the webhook URL to a key, enter this in the Value field for the key: <strong>payload.data.Name</strong>.</li>\n<li>For <strong>application/x-www-form-urlencoded</strong>, it is the name of the property.</li>\n<li>For <strong>text/plain</strong>, it is the fixed key <strong>text</strong>.</li>\n</ul>\n<div class=\"admonition\"><div class=\"admonition-icon admonition-note-icon\"></div><div class=\"admonition-content admonition-note-content\"><div>If the payload's data format does not match the message's  <strong>content-type</strong>, you can use <strong>payload.data.text</strong> to retrieve the entire payload as text.</div></div></div>\n<p>Refer to the vendor's developer documentation or view the listener-based scenario's execution logs to learn the structure of the payload data.</p>\n<h2><a id=\"Send_responses_with_payload_data_to_the_external_system_in_scenario_rules\" name=\"Send_responses_with_payload_data_to_the_external_system_in_scenario_rules\" title=\"Send responses with payload data to the external system in scenario rules\"></a>Send responses with payload data to the external system in scenario rules</h2>\n<p>When your listener-based scenario is created in the synchronous mode, you can create scenario rules to send responses to the external system with data in the payload of the response messages.</p>\n<p>To do this, define a <b>Send Response</b> action in scenario rules. For details, see <a href=\"/doc/423/25.3/commonactions#Send_Response\" title='\"Send Response\" in Build-in actions'>\"Send Response\" in Build-in actions</a>.</p>\n<h2><a id=\"Monitor_external_system-triggered_scenarios\" name=\"Monitor_external_system-triggered_scenarios\" title=\"Monitor external system-triggered scenarios\"></a>Monitor external system-triggered scenarios</h2>\n<p>As with any integration scenario, use the integration execution logs page (<b>Administration &gt; Utilities &gt; Integration &gt; Endpoints</b>) to view the scenario rules triggered by an external system's webhook. If an endpoint is associated with several scenarios, add a filter on the scenario name to display only execution logs for a specific listener-based scenario.</p>\n<h2><a id=\"Disable_the_listener\" name=\"Disable_the_listener\" title=\"Disable the listener\"></a>Disable the listener</h2>\n<p>To disable a listener, disable the listener-enabled scenario by clearing its Active checkbox.</p>\n</div>",
  "modifiedon": "2025-10-24 08:51:12"
}